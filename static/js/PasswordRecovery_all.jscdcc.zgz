
/* 
* Zimbra Collaboration Suite Web Client
* Copyright (C) 2004-2017 Synacor, Inc.
* https://www.zimbra.com/license
*/
if(AjxPackage.define("PasswordRecovery")){if(AjxPackage.define("ajax.core.AjxException")){AjxException=function(d,c,e,a){if(arguments.length==0){return
}this.msg=d;
this.code=c;
this.method=e;
this.detail=a
};
AjxException.prototype.toString=function(){return"AjxException"
};
AjxException.prototype.dump=function(){return"AjxException: msg="+this.msg+" code="+this.code+" method="+this.method+" detail="+this.detail
};
AjxException.INVALIDPARENT="AjxException.INVALIDPARENT";
AjxException.INVALID_OP="AjxException.INVALID_OP";
AjxException.INTERNAL_ERROR="AjxException.INTERNAL_ERROR";
AjxException.INVALID_PARAM="AjxException.INVALID_PARAM";
AjxException.UNIMPLEMENTED_METHOD="AjxException.UNIMPLEMENTED_METHOD";
AjxException.NETWORK_ERROR="AjxException.NETWORK_ERROR";
AjxException.OUT_OF_RPC_CACHE="AjxException.OUT_OF_RPC_CACHE";
AjxException.UNSUPPORTED="AjxException.UNSUPPORTED";
AjxException.UNKNOWN_ERROR="AjxException.UNKNOWN_ERROR";
AjxException.CANCELED="AjxException.CANCELED";
AjxException.defaultScriptErrorHandler=function(a){alert(a)
};
AjxException.setScriptErrorHandler=function(a){AjxException.scriptErrorHandler=a
};
AjxException.reportScriptError=function(a){if(AjxException.reportScriptErrors&&AjxException.scriptErrorHandler&&!(a instanceof AjxException)){AjxException.scriptErrorHandler(a)
}throw a
};
AjxException.reportScriptErrors=false;
AjxException.scriptErrorHandler=AjxException.defaultScriptErrorHandler
}if(AjxPackage.define("ajax.events.AjxEventMgr")){AjxEventMgr=function(){this._listeners=new Object()
};
AjxEventMgr.prototype.toString=function(){return"AjxEventMgr"
};
AjxEventMgr.prototype.addListener=function(c,d,a){var e=this._listeners[c];
if(e==null){e=this._listeners[c]=new AjxVector()
}if(!e.contains(d)){if(this._notifyingListeners){e=this._listeners[c]=e.clone()
}e.add(d,a);
return true
}return false
};
AjxEventMgr.prototype.notifyListeners=function(f,h){this._notifyingListeners=true;
var k=this._listeners[f];
if(k!=null){var d=k.getArray();
var g=k.size();
var j=null;
var l=null;
for(var e=0;
e<g;
e++){l=d[e];
if(!(l&&((l instanceof AjxListener)||(typeof l=="function")))){continue
}j=l.handleEvent?l.handleEvent(h):l(h);
if(j===false){break
}}}this._notifyingListeners=false;
return j
};
AjxEventMgr.prototype.isListenerRegistered=function(a){var c=this._listeners[a];
return(c!=null&&c.size()>0)
};
AjxEventMgr.prototype.removeListener=function(a,c){var d=this._listeners[a];
if(d!=null){if(this._notifyingListeners){d=this._listeners[a]=d.clone()
}d.remove(c);
return true
}return false
};
AjxEventMgr.prototype.removeAll=function(a){var c=this._listeners[a];
if(c!=null){if(this._notifyingListeners){c=this._listeners[a]=c.clone()
}c.removeAll();
return true
}return false
};
AjxEventMgr.prototype.clearAllEvents=function(){var c=this._listeners;
for(var a in c){this.removeAll(a)
}}
}if(AjxPackage.define("ajax.events.AjxListener")){AjxListener=function(c,d,a){AjxCallback.call(this,c,d,a)
};
AjxListener.prototype=new AjxCallback();
AjxListener.prototype.constructor=AjxListener;
AjxListener.prototype.isAjxListener=true;
AjxListener.prototype.toString=function(){return"AjxListener"
};
AjxListener.prototype.handleEvent=function(a){return this.run(a)
}
}if(AjxPackage.define("ajax.dwt.graphics.DwtPoint")){DwtPoint=function(a,c){this.x=a||0;
this.y=c||0
};
DwtPoint.tmp=new DwtPoint(0,0);
DwtPoint.prototype.toString=function(){return"DwtPoint"
};
DwtPoint.prototype.set=function(a,c){this.x=a;
this.y=c
}
}if(AjxPackage.define("ajax.dwt.graphics.DwtCssStyle")){DwtCssStyle=function(){};
DwtCssStyle.HOVER="hover";
DwtCssStyle.ACTIVE="active";
DwtCssStyle.SELECTED="selected";
DwtCssStyle.ALT_SELECTED="altSelected";
DwtCssStyle.DISABLED="disabled";
DwtCssStyle.FOCUSED="focused";
DwtCssStyle.ACTIONED="actioned";
DwtCssStyle.MATCHED="matched";
DwtCssStyle.DRAG_OVER="dragOver";
DwtCssStyle.DROPPABLE="droppable";
DwtCssStyle.NOT_DROPPABLE="notDroppable";
DwtCssStyle.DRAG_PROXY="dragProxy";
DwtCssStyle.LINUX="linux";
DwtCssStyle.getProperty=function(g,a){var f=g.ownerDocument;
if(f.defaultView&&f.defaultView.getComputedStyle){var e=f.defaultView.getComputedStyle(g,null);
if(e&&e.length>0){return e.getPropertyValue(a)
}}var d=a.split("-");
var c=d.shift()+AjxUtil.map(d,AjxStringUtil.capitalize).join("");
if(g.currentStyle){return g.currentStyle[c]
}else{if(g.style){return g.style[c]
}}};
DwtCssStyle.getComputedStyleObject=function(d){var c=d.ownerDocument;
if(c.defaultView&&c.defaultView.getComputedStyle){var a=c.defaultView.getComputedStyle(d,null);
if(!a&&d.style){d.style.display="";
a=c.defaultView.getComputedStyle(d,null)
}return a||{}
}else{if(d.currentStyle){return d.currentStyle
}else{if(d.style){return d.style
}}}};
DwtCssStyle.removeProperty=function(c,d){if(d instanceof Array){for(var a=d.length;
--a>=0;
){DwtCssStyle.removeProperty(c,d[a])
}}else{if(AjxEnv.isIE){c.style.removeAttribute(d,true)
}else{d=d.replace(/([A-Z])/g,"-$1");
c.style.removeProperty(d)
}}};
DwtCssStyle.addRule=function(d,a,e,c){if(d.addRule){c=c||(d.rules.length);
d.addRule(a,e,c)
}else{c=c||(d.cssRules.length);
d.insertRule(a+"{"+e+"}",c)
}return c
};
DwtCssStyle.removeRule=function(c,a){if(c.removeRule){c.removeRule(a)
}else{c.deleteRule(a)
}};
DwtCssStyle.__PIXEL_RE=/^(-?[0-9]+(?:\.[0-9]*)?)px$/;
DwtCssStyle.__DIMENSION_RE=/^(-?[0-9]+(?:\.[0-9]*)?)([a-z]*|%)$/;
DwtCssStyle.__NUMBER_RE=/^(-?[0-9]+(?:\.[0-9]*)?)+$/;
DwtCssStyle.__getRootFontSize=function(){var a=DwtCssStyle.getProperty(document.documentElement,"font-size");
if(!DwtCssStyle.__PIXEL_RE.test(a)){return -1
}return parseInt(a)
};
DwtCssStyle.asPixelCount=function(f){if(!f){return -1
}var e,d,c;
if(typeof f==="number"||DwtCssStyle.__NUMBER_RE.test(f)){e=Number(f);
d="px"
}else{if((c=DwtCssStyle.__DIMENSION_RE.exec(f))){e=Number(c[1]);
d=c[2]
}else{return -1
}}switch(d){case"rem":var a=DwtCssStyle.__getRootFontSize();
return a!==-1?e*a:-1;
case"mm":e/=10;
case"cm":e/=2.54;
case"in":e*=6;
case"pc":e*=12;
case"pt":e/=0.75;
case"px":return e;
case"ch":case"em":case"ex":return -1;
default:return -1
}}
}if(AjxPackage.define("ajax.util.AjxUtil")){AjxUtil=function(){};
AjxUtil.FLOAT_RE=/^[+\-]?((\d+(\.\d*)?)|((\d*\.)?\d+))([eE][+\-]?\d+)?$/;
AjxUtil.NOTFLOAT_RE=/[^\d\.]/;
AjxUtil.NOTINT_RE=/[^0-9]+/;
AjxUtil.LIFETIME_FIELD=/^([0-9])+([dhms]|ms)?$/;
AjxUtil.INT_RE=/^\-?(0|[1-9]\d*)$/;
AjxUtil.isSpecified=function(a){return((a!==void 0)&&(a!==null))
};
AjxUtil.isUndefined=function(a){return(a===void 0)
};
AjxUtil.isNull=function(a){return(a===null)
};
AjxUtil.isBoolean=function(a){return(typeof(a)==="boolean")
};
AjxUtil.isString=function(a){return(typeof(a)==="string")
};
AjxUtil.isNumber=function(a){return(typeof(a)==="number")
};
AjxUtil.isObject=function(a){return((typeof(a)==="object")&&(a!==null))
};
AjxUtil.isArray=function(a){return AjxUtil.isInstance(a,Array)
};
AjxUtil.isArrayLike=function(a){return typeof a!=="string"&&typeof a.length==="number"
};
AjxUtil.isFunction=function(a){return(typeof(a)==="function")
};
AjxUtil.isDate=function(a){return AjxUtil.isInstance(a,Date)
};
AjxUtil.isLifeTime=function(a){return AjxUtil.LIFETIME_FIELD.test(a)
};
AjxUtil.isNumeric=function(a){return(!isNaN(parseFloat(a))&&AjxUtil.FLOAT_RE.test(a)&&!AjxUtil.NOTFLOAT_RE.test(a))
};
AjxUtil.isInt=function(a){return AjxUtil.INT_RE.test(a)
};
AjxUtil.isPositiveInt=function(a){return AjxUtil.isInt(a)&&parseInt(a,10)>0
};
AjxUtil.isLong=AjxUtil.isInt;
AjxUtil.isNonNegativeLong=function(a){return AjxUtil.isLong(a)&&parseInt(a,10)>=0
};
AjxUtil.isEmpty=function(a){return(AjxUtil.isNull(a)||AjxUtil.isUndefined(a)||(a==="")||(AjxUtil.isArray(a)&&(a.length==0)))
};
AjxUtil.IPv4_ADDRESS_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?$/;
AjxUtil.IPv4_ADDRESS_WITH_PORT_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?:\d{1,5}$/;
AjxUtil.IPv6_ADDRESS_RE=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|(?:%[-\w.~]+)?$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})(?:%[-\w.~]+)?$/i;
AjxUtil.IPv6_ADDRESS_WITH_PORT_RE=new RegExp(AjxUtil.IPv6_ADDRESS_RE.source.replace("^","^\\[").replace("$","\\]:\\d{1,5}$"),"i");
AjxUtil.SUBNET_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?\/\d{1,2}$/;
AjxUtil.DOMAIN_NAME_SHORT_RE=/^[A-Za-z0-9\-]{2,}$/;
AjxUtil.DOMAIN_NAME_FULL_RE=/^[A-Za-z0-9\-]{1,}(\.[A-Za-z0-9\-]{2,}){1,}$/;
AjxUtil.HOST_NAME_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{1,})*(\.[A-Za-z0-9\-]{2,})*$/;
AjxUtil.HOST_NAME_WITH_PORT_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})*:([0-9])+$/;
AjxUtil.EMAIL_SHORT_RE=/^[^@\s]+$/;
AjxUtil.EMAIL_FULL_RE=/^[^@\s]+@[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})+$/;
AjxUtil.FULL_URL_RE=/^[A-Za-z0-9]{2,}:\/\/[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)*(:([0-9])+)?(\/[\w\.\|\^\*\[\]\{\}\(\)\-<>~,'#_;@:!%]+)*(\/)?(\?[\w\.\|\^\*\+\[\]\{\}\(\)\-<>~,'#_;@:!%&=]*)?$/;
AjxUtil.IP_FULL_URL_RE=/^[A-Za-z0-9]{2,}:\/\/\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?(:([0-9])+)?(\/[\w\.\|\^\*\[\]\{\}\(\)\-<>~,'#_;@:!%]+)*(\/)?(\?[\w\.\|\^\*\+\[\]\{\}\(\)\-<>~,'#_;@:!%&=]*)?$/;
AjxUtil.SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)*(:([0-9])+)?$/;
AjxUtil.IP_SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?(:([0-9])+)?$/;
AjxUtil.isHostName=function(a){return AjxUtil.HOST_NAME_RE.test(a)
};
AjxUtil.isDomainName=function(c,a){return a?AjxUtil.DOMAIN_NAME_SHORT_RE.test(c):AjxUtil.DOMAIN_NAME_FULL_RE.test(c)
};
AjxUtil.isEmailAddress=function(c,a){return a?AjxUtil.EMAIL_SHORT_RE.test(c):AjxUtil.EMAIL_FULL_RE.test(c)
};
AjxUtil.isValidEmailNonReg=function(a){return((a.indexOf("@")>0)&&(a.lastIndexOf("@")==a.indexOf("@"))&&(a.indexOf(".@")<0))
};
AjxUtil.isHash=function(a){var c=a&&a.toString?a.toString():Object.prototype.toString.call(a);
return AjxUtil.isObject(a)&&c==="[object Object]"
};
AjxUtil.SIZE_GIGABYTES="GB";
AjxUtil.SIZE_MEGABYTES="MB";
AjxUtil.SIZE_KILOBYTES="KB";
AjxUtil.SIZE_BYTES="B";
AjxUtil.formatSize=function(f,e,g){if(e==null){e=true
}if(g==null){g=20
}var c=AjxMsg.sizeBytes;
var d=AjxMsg.SIZE_BYTES;
if(f>=1073741824){c=AjxMsg.sizeGigaBytes;
d=AjxUtil.SIZE_GIGABYTES
}else{if(f>=1048576){c=AjxMsg.sizeMegaBytes;
d=AjxUtil.SIZE_MEGABYTES
}else{if(f>1023){c=AjxMsg.sizeKiloBytes;
d=AjxUtil.SIZE_KILOBYTES
}}}var a=AjxUtil.formatSizeForUnits(f,d,e,g);
return AjxMessageFormat.format(AjxMsg.formatSizeAndUnits,[a,c])
};
AjxUtil.formatSizeForUnits=function(f,d,c,h){if(d==null){d=AjxUtil.SIZE_BYTES
}if(c==null){c=true
}if(h==null){h=20
}switch(d){case AjxUtil.SIZE_GIGABYTES:f/=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:f/=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:f/=1024;
break
}var a=I18nMsg.numberSeparatorDecimal!=""?I18nMsg.numberSeparatorDecimal:".";
var g=I18nMsg.formatNumber.replace(/\..*$/,"");
g=g.replace(/,/,"");
if(!c&&h){g=g+=a;
for(var e=0;
e<h;
e++){g+="#"
}}return AjxNumberFormat.format(g,f)
};
AjxUtil.parseSize=function(c,e){if(typeof c!=_STRING_){c=c.toString()
}var f=parseFloat(c.replace(/^\s*/,""));
var d=/[GMK]?B$/i;
var a=d.exec(c);
if(a){e=a[0].toUpperCase()
}switch(e){case AjxUtil.SIZE_GIGABYTES:f*=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:f*=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:f*=1024;
break
}return f
};
AjxUtil.isInstance=function(a,c){return !!(a&&a.constructor&&(a.constructor===c))
};
AjxUtil.assert=function(a,c){if(!a&&AjxUtil.onassert){AjxUtil.onassert(c)
}};
AjxUtil.onassert=function(a){var k=new Object();
k.message=a;
var l=new Array();
if(AjxEnv.isIE){var d=arguments.callee.caller;
var f=0;
while(d&&f++<20){l[l.length]=d;
d=d.caller
}}else{try{var d=arguments.callee.caller;
while(d){l[l.length]=d;
if(l.length>2){break
}d=d.caller
}}catch(j){}}k.stack=l;
var h="";
var c=170;
for(var f=1;
f<l.length;
f++){if(f>1){h+="\n"
}if(f<11){var g=l[f].toString();
if(g.length>c){g=g.substr(0,c)+"...";
g=g.replace(/\n/g,"")
}h+=f+": "+g
}else{h+="("+(l.length-11)+" frames follow)";
break
}}alert("assertion:\n\n"+a+"\n\n---- Call Stack ---\n"+h);
throw k
};
AjxUtil.ELEMENT_NODE=1;
AjxUtil.TEXT_NODE=3;
AjxUtil.DOCUMENT_NODE=9;
AjxUtil.getInnerText=function(a){if(AjxEnv.isIE){return a.innerText
}function c(f){if(f){if(f.nodeType==3){return f.data
}if(f.nodeType==1){if(/^br$/i.test(f.tagName)){return"\r\n"
}var e="";
for(var d=f.firstChild;
d;
d=d.nextSibling){e+=c(d)
}return e
}}return""
}return c(a)
};
AjxUtil.createProxy=function(d,h){var f;
var c=function(){};
c.prototype=d;
if(d instanceof Array){f=new Array();
var e=d.length;
for(var a=0;
a<e;
a++){f[a]=d[a]
}}else{f=new c
}if(h){for(var g in d){if(typeof d[g]=="object"&&d[g]!==null){f[g]=AjxUtil.createProxy(d[g],h-1)
}}}f._object_=d;
return f
};
AjxUtil.unProxy=function(c){var a=c&&c._object_;
if(a){for(var d in c){if(c.hasOwnProperty(d)&&d!="_object_"){a[d]=c[d]
}}return a
}return null
};
AjxUtil.collapseList=function(d){var c=[];
for(var a=0;
a<d.length;
a++){if(d[a]){c.push(d[a])
}}return c
};
AjxUtil.arrayAsHash=function(h,e){h=AjxUtil.toArray(h);
var g={};
var d=typeof e=="function"&&e;
var f=e||true;
for(var c=0;
c<h.length;
c++){var a=h[c];
g[a]=d?d(a,g,c,h):f
}return g
};
AjxUtil.arrayAdd=function(d,c,a){d=d||[];
if(a==null||a<0||a>=d.length){d.push(c)
}else{d.splice(a,0,c)
}};
AjxUtil.arrayRemove=function(d,c){if(d){for(var a=0;
a<d.length;
a++){if(d[a]==c){d.splice(a,1);
return true
}}}return false
};
AjxUtil.indexOf=function(f,c,a){if(f){for(var d=0;
d<f.length;
d++){var e=f[d];
if((a&&e===c)||(!a&&e==c)){return d
}}}return -1
};
AjxUtil.arrayContains=function(d,c,a){return AjxUtil.indexOf(d,c,a)!=-1
};
AjxUtil.keys=function(c,a){var d=[];
for(var e in c){if(a&&!a(e,c)){continue
}d.push(e)
}return d
};
AjxUtil.values=function(d,c){var a=[];
for(var e in d){if(c&&!c(e,d)){continue
}a.push(d[e])
}return a
};
AjxUtil.valueHash=function(g,d){var e=Object.prototype.hasOwnProperty.bind(g);
var f={};
for(var c in g){var a=g[c];
if(!e(c)||(d&&!d(c,g))){continue
}f[a]=c
}return f
};
AjxUtil.backMap=AjxUtil.valueHash;
AjxUtil.foreach=function(f,e){if(!e||!f){return
}if(AjxUtil.isArrayLike(f)){var g=f;
for(var c=0;
c<g.length;
c++){e(g[c],c)
}}else{var d=Object.prototype.hasOwnProperty.bind(f);
for(var a in f){if(d(a)){e(f[a],a)
}}}};
AjxUtil.map=function(e,d){if(!e){return[]
}var a=new Array(e.length);
for(var c=0;
c<e.length;
c++){a[c]=d?d(e[c],c):e[c]
}return a
};
AjxUtil.uniq=function(d){if(!d){return[]
}var a={};
for(var c=0;
c<d.length;
c++){a[d[c]]=true
}return AjxUtil.keys(a)
};
AjxUtil.dedup=function(f,c){if(!f){return[]
}if(!c){c=function(g){return g
}
}var a={};
for(var e=0;
e<f.length;
e++){var d=c(f[e]);
if(d!==undefined&&a[d]){f.splice(e,1);
e-=1
}a[d]=true
}};
AjxUtil.concat=function(c){var d=[];
for(var a=0;
a<arguments.length;
a++){d.push.apply(d,arguments[a])
}return d
};
AjxUtil.union=function(a){var c=[];
return AjxUtil.uniq(c.concat.apply(c,arguments))
};
AjxUtil.intersection=function(c){var e=AjxUtil.concat.apply(this,arguments);
var a=AjxUtil.arrayAsHash(e,AjxUtil.__intersection_count);
for(var d in a){if(a[d]==1){delete a[d]
}}return AjxUtil.keys(a)
};
AjxUtil.__intersection_count=function(c,d,a,e){return d[c]!=null?d[c]+1:1
};
AjxUtil.complement=function(e,c){var d=AjxUtil.arrayAsHash(e);
var a=AjxUtil.arrayAsHash(c);
for(var f in a){if(f in d){delete a[f]
}}return AjxUtil.keys(a)
};
AjxUtil.filter=function(f,d,c){var a=[];
if(f==null){return a
}var e=Array.prototype.filter;
if(e&&f.filter===e){return f.filter(d,c)
}AjxUtil.foreach(f,function(h,g){if(d.call(c,h,g)){a.push(h)
}});
return a
};
AjxUtil.getFirstElement=function(f,e,d,c){for(var g=f.firstChild;
g;
g=g.nextSibling){if(g.nodeType!=AjxUtil.ELEMENT_NODE){continue
}if(e&&g.nodeName!=e){continue
}if(d){var a=g.getAttributeNode(d);
if(a.nodeName!=d){continue
}if(c&&a.nodeValue!=c){continue
}}return g
}return null
};
AjxUtil.formatUrl=function(g){g=g||{};
var d=[];
var e=0;
if(!g.relative){var f=g.protocol||location.protocol;
if(f.indexOf(":")==-1){f=f+":"
}d[e++]=f;
d[e++]="//";
d[e++]=g.host||location.hostname;
var c=Number(g.port||location.port);
if(c&&((f==ZmSetting.PROTO_HTTP&&c!=ZmSetting.HTTP_DEFAULT_PORT)||(f==ZmSetting.PROTO_HTTPS&&c!=ZmSetting.HTTPS_DEFAULT_PORT))){d[e++]=":";
d[e++]=c
}}d[e++]=g.path||location.pathname;
var a="";
if(g.qsArgs){a=AjxStringUtil.queryStringSet(g.qsArgs,g.qsReset)
}else{a=g.qsReset?"":location.search
}d[e++]=a;
return d.join("")
};
AjxUtil.byNumber=function(d,c){return Number(d)-Number(c)
};
AjxUtil.byStringProp=function(e,d,c){return d[e].localeCompare(c[e])
};
AjxUtil.arraySize=function(c){var d=0;
for(var f in c){if(c.hasOwnProperty(f)){d++
}}return d
};
AjxUtil.mergeArrays=function(j,f,a){if(!a){a=AjxUtil.__mergeArrays_orderfunc
}var k=[];
var e=j.length;
for(var c=0;
c<e;
c++){k.push(j[c])
}var g=[];
var d=f.length;
for(var c=0;
c<d;
c++){g.push(f[c])
}var h=[];
while(k.length>0&&g.length>0){if(a(k[0],h[h.length-1])==0){k.shift();
continue
}if(a(g[0],h[h.length-1])==0){g.shift();
continue
}if(a(k[0],g[0])<0){h.push(k.shift())
}else{if(a(k[0],g[0])==0){h.push(k.shift());
g.shift()
}else{h.push(g.shift())
}}}while(k.length>0){if(a(k[0],h[h.length-1])==0){k.shift();
continue
}h.push(k.shift())
}while(g.length>0){if(a(g[0],h[h.length-1])==0){g.shift();
continue
}h.push(g.shift())
}return h
};
AjxUtil.__mergeArrays_orderfunc=function(c,a){if(c>a){return 1
}if(c<a){return -1
}if(c==a){return 0
}};
AjxUtil.arraySubtract=function(j,f,a){if(!a){a=function(l,i){if(l>i){return 1
}if(l<i){return -1
}if(l==i){return 0
}}
}var k=[];
var e=j.length;
for(var c=0;
c<e;
c++){k.push(j[c])
}var g=[];
var d=f.length;
for(var c=0;
c<d;
c++){g.push(f[c])
}g.sort(a);
k.sort(a);
var h=[];
while(k.length>0&&g.length>0){if(a(k[0],g[0])==0){k.shift();
g.shift();
continue
}if(a(k[0],g[0])<0){h.push(k.shift());
continue
}if(a(k[0],g[0])>0){g.shift();
continue
}}while(k.length>0){h.push(k.shift())
}return h
};
AjxUtil.arraySubstract=AjxUtil.arraySubtract;
AjxUtil.getHashKeys=function(d){var c=[];
for(var a in d){c.push(a)
}c.sort();
return c
};
AjxUtil.arrayCompare=function(c,a){if((!c||!a)&&(c!=a)){return false
}if(c.length!=a.length){return false
}for(var d=0;
d<c.length;
d++){if(c[d]!=a[d]){return false
}}return true
};
AjxUtil.hashCompare=function(h,g){var d=AjxUtil.getHashKeys(h);
var c=AjxUtil.getHashKeys(g);
if(!AjxUtil.arrayCompare(d,c)){return false
}for(var f=0,a=d.length;
f<a;
f++){var e=d[f];
if(h[e]!=g[e]){return false
}}return true
};
AjxUtil.hashCopy=function(e,d,a){d=d&&AjxUtil.arrayAsHash(d);
a=a&&AjxUtil.arrayAsHash(a);
var f={};
for(var c in e){if((!d||!d[c])&&(!a||a[c])){f[c]=e[c]
}}return f
};
AjxUtil.hashUpdate=function(g,f,c,e,a){e=e&&AjxUtil.arrayAsHash(e);
a=a&&AjxUtil.arrayAsHash(a);
for(var d in f){if((c||!(d in g))&&(!e||!e[d])&&(!a||a[d])){g[d]=f[d]
}}};
AjxUtil.isArray1=function(a){return !!(a&&(a.length!=null)&&a.splice&&a.slice)
};
AjxUtil.toArray=function(a){if(!a){return[]
}else{if(AjxUtil.isArray1(a)){return a
}else{if(AjxUtil.isArrayLike(a)){return Array.prototype.slice.call(a)
}else{if(a.isAjxVector){return a.getArray()
}else{return[a]
}}}}};
AjxUtil.get=function(a){for(var c=1;
a&&c<arguments.length;
c++){a=a[arguments[c]]
}return a
};
AjxUtil.convertToEntities=function(g){var a="";
var f=0;
if(!g||!(f=g.length)){return g
}for(var e=0;
e<f;
e++){var c=g.charCodeAt(e);
if((c>127)||(c==34)){var d=c.toString(10);
while(d.length<4){d="0"+d
}a+="&#"+d+";"
}else{a+=g.charAt(e)
}}return a
};
AjxUtil.getClassAttr=function(c){var a=[];
if(c&&c.length>0){c=AjxUtil.uniq(c);
return["class='",c.join(" "),"'"].join("")
}return""
};
AjxUtil.dataURItoBlob=function(g){if(!(g&&typeof window.atob==="function"&&typeof window.Blob==="function")){return
}var k=g.split(",");
if(k.length===2){if(k[0].indexOf("base64")===-1){return
}try{var f=window.atob(k[1])
}catch(j){return
}if(!f){return
}var d=k[0].split(":");
if(!d[1]){return
}d=d[1].split(";")[0];
if(d){var a=f.length,l=new ArrayBuffer(a),c=new Uint8Array(l);
for(var h=0;
h<a;
h++){c[h]=f.charCodeAt(h)
}return new Blob([l],{type:d})
}}};
AjxUtil.reduce=function(d,c,a){return Array.prototype.reduce.call(d,c,a)
};
AjxUtil.getBrightness=function(c){var e,d,a;
if(c&&c.length===7&&c.indexOf("#")===0){c=c.substr(1)
}else{return null
}e=parseInt(c.substr(0,2),16);
d=parseInt(c.substr(2,2),16);
a=parseInt(c.substr(4,2),16);
return Math.sqrt(e*e*0.299+d*d*0.587+a*a*0.114)
};
AjxUtil.getForegroundColor=function(a){var c=AjxUtil.getBrightness(a);
return(c!=null&&c<130)?"white":"black"
};
AjxUtil.htmlEncode=function(a){if(AjxUtil.isArray(a)){a=a.map(function(c){return AjxStringUtil.htmlEncode(c)
})
}else{if(AjxUtil.isString(a)){a=AjxStringUtil.htmlEncode(a)
}}return a
};
AjxUtil.htmlDecode=function(a){if(AjxUtil.isArray(a)){a=a.map(function(c){return AjxStringUtil.htmlDecode(c)
})
}else{if(AjxUtil.isString(a)){a=AjxStringUtil.htmlDecode(a)
}}return a
}
}if(AjxPackage.define("ajax.util.AjxText")){AjxFormat=function(a){if(arguments.length==0){return
}this._pattern=a;
this._segments=[]
};
AjxFormat.prototype.toString=function(){var c=[];
c.push('pattern="',this._pattern,'"');
if(this._segments.length>0){c.push(", segments={ ");
for(var a=0;
a<this._segments.length;
a++){if(a>0){c.push(", ")
}c.push(String(this._segments[a]))
}c.push(" }")
}return c.join("")
};
AjxFormat.initialize=function(){AjxDateFormat.initialize();
AjxNumberFormat.initialize()
};
AjxFormat.prototype.format=function(a){var d=[];
for(var c=0;
c<this._segments.length;
c++){d.push(this._segments[c].format(a))
}return d.join("")
};
AjxFormat.prototype.parse=function(e){var c=this._createParseObject();
var a=0;
for(var d=0;
d<this._segments.length;
d++){var f=this._segments[d];
a=f.parse(c,e,a)
}if(a<e.length){throw new AjxFormat.ParsingException(this,null,"input too long")
}return c
};
AjxFormat.prototype.getSegments=function(){return this._segments
};
AjxFormat.prototype.toPattern=function(){return this._pattern
};
AjxFormat.prototype.clone=function(){return new this.constructor(this._pattern)
};
AjxFormat.prototype._createParseObject=function(a){throw new AjxFormat.ParsingException(this,null,"not implemented")
};
AjxFormat._zeroPad=function(f,g,d,h){f=typeof f=="string"?f:String(f);
if(f.length>=g){return f
}d=d||"0";
var c=[];
for(var e=f.length;
e<g;
e++){c.push(d)
}c[h?"unshift":"push"](f);
return c.join("")
};
AjxFormat.FormatException=function(c,a){this._format=c;
this._message=a
};
AjxFormat.FormatException.prototype.toString=function(){return this._message
};
AjxFormat.FormattingException=function(d,c,a){AjxFormat.FormatException.call(this,d,a);
this._segment=c
};
AjxFormat.FormattingException.prototype=new AjxFormat.FormatException;
AjxFormat.FormattingException.prototype.constructor=AjxFormat.FormattingException;
AjxFormat.ParsingException=function(d,c,a){AjxFormat.FormatException.call(this,d,a);
this._segment=c
};
AjxFormat.ParsingException.prototype=new AjxFormat.FormatException;
AjxFormat.ParsingException.prototype.constructor=AjxFormat.ParsingException;
AjxFormat.Segment=function(c,a){if(arguments.length==0){return
}this._parent=c;
this._s=a
};
AjxFormat.Segment.prototype.toString=function(){return'segment: "'+this._s+'"'
};
AjxFormat.Segment.prototype.format=function(a){return this._s
};
AjxFormat.Segment.prototype.parse=function(d,c,a){throw new AjxFormat.ParsingException(this._parent,this,"not implemented")
};
AjxFormat.Segment.prototype.getFormat=function(){return this._parent
};
AjxFormat.Segment.prototype.toSubPattern=function(){return this._s
};
AjxFormat.Segment.prototype._getFixedLength=function(){var a;
if(this._index+1<this._parent._segments.length){var c=this._parent._segments[this._index+1];
if(!(c instanceof AjxFormat.TextSegment)){a=this._s.length
}}return a
};
AjxFormat.Segment._parseLiteral=function(e,d,a){if(d.length-a<e.length){throw new AjxFormat.ParsingException(this._parent,this,"input too short")
}for(var c=0;
c<e.length;
c++){if(e.charAt(c)!=d.charAt(a+c)){throw new AjxFormat.ParsingException(this._parent,this,"input doesn't match")
}}return a+e.length
};
AjxFormat.Segment._parseLiterals=function(c,h,m,a,p,j){for(var g=0;
g<a.length;
g++){try{var n=a[g];
var d=AjxFormat.Segment._parseLiteral(n,p,j);
if(h){var l=c||window;
if(typeof h=="function"){h.call(l,g+m)
}else{l[h]=g+m
}}return d
}catch(k){}}return -1
};
AjxFormat.Segment._parseInt=function(c,e,p,q,g,a,m){var h=a||q.length-g;
var l=g;
for(var d=0;
d<h;
d++){if(!q.charAt(g++).match(/\d/)){g--;
break
}}var k=g;
if(l==k){throw new AjxFormat.ParsingException(this._parent,this,"number not present")
}if(a&&k-l!=a){throw new AjxFormat.ParsingException(this._parent,this,"number too short")
}var n=parseInt(q.substring(l,k),m||10);
if(e){var j=c||window;
if(typeof e=="function"){e.call(j,n+p)
}else{j[e]=n+p
}}return k
};
AjxDateFormat=function(h){if(arguments.length==0){return
}AjxFormat.call(this,h);
if(h==null){return
}if(typeof h=="number"){switch(h){case AjxDateFormat.SHORT:h=I18nMsg.formatDateShort;
break;
case AjxDateFormat.MEDIUM:h=I18nMsg.formatDateMedium;
break;
case AjxDateFormat.LONG:h=I18nMsg.formatDateLong;
break;
case AjxDateFormat.FULL:h=I18nMsg.formatDateFull;
break;
case AjxDateFormat.NUMBER:h=I18nMsg.formatDateNumber;
break
}}for(var e=0;
e<h.length;
e++){var k=h.charAt(e);
if(k=="'"){var d=e+1;
for(e++;
e<h.length;
e++){var k=h.charAt(e);
if(k=="'"){if(e+1<h.length&&h.charAt(e+1)=="'"){h=h.substr(0,e)+h.substr(e+1)
}else{break
}}}var a=e;
var g=new AjxFormat.TextSegment(this,h.substring(d,a));
this._segments.push(g);
continue
}var d=e;
while(e<h.length){k=h.charAt(e);
if(AjxDateFormat._META_CHARS.indexOf(k)!=-1||k=="'"){break
}e++
}var a=e;
if(d!=a){var g=new AjxFormat.TextSegment(this,h.substring(d,a));
this._segments.push(g);
e--;
continue
}var d=e;
while(++e<h.length){if(h.charAt(e)!=k){break
}}var a=e--;
var f=a-d;
var j=h.substr(d,f);
var g=null;
switch(k){case"G":g=new AjxDateFormat.EraSegment(this,j);
break;
case"y":g=new AjxDateFormat.YearSegment(this,j);
break;
case"M":g=new AjxDateFormat.MonthSegment(this,j);
break;
case"w":g=new AjxDateFormat.WeekSegment(this,j);
break;
case"W":g=new AjxDateFormat.WeekSegment(this,j);
break;
case"D":g=new AjxDateFormat.DaySegment(this,j);
break;
case"d":g=new AjxDateFormat.DaySegment(this,j);
break;
case"F":g=new AjxDateFormat.WeekdaySegment(this,j);
break;
case"E":g=new AjxDateFormat.WeekdaySegment(this,j);
break;
case"a":g=new AjxDateFormat.AmPmSegment(this,j);
break;
case"H":g=new AjxDateFormat.HourSegment(this,j);
break;
case"k":g=new AjxDateFormat.HourSegment(this,j);
break;
case"K":g=new AjxDateFormat.HourSegment(this,j);
break;
case"h":g=new AjxDateFormat.HourSegment(this,j);
break;
case"m":g=new AjxDateFormat.MinuteSegment(this,j);
break;
case"s":g=new AjxDateFormat.SecondSegment(this,j);
break;
case"S":g=new AjxDateFormat.SecondSegment(this,j);
break;
case"z":g=new AjxDateFormat.TimezoneSegment(this,j);
break;
case"Z":g=new AjxDateFormat.TimezoneSegment(this,j);
break
}if(g!=null){g._index=this._segments.length;
this._segments.push(g)
}}};
AjxDateFormat.prototype=new AjxFormat;
AjxDateFormat.prototype.constructor=AjxDateFormat;
AjxDateFormat.prototype.toString=function(){return"[AjxDateFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxDateFormat.SHORT=0;
AjxDateFormat.MEDIUM=1;
AjxDateFormat.LONG=2;
AjxDateFormat.FULL=3;
AjxDateFormat.DEFAULT=AjxDateFormat.MEDIUM;
AjxDateFormat._META_CHARS="GyMwWDdFEaHkKhmsSzZ";
AjxDateFormat.NUMBER=4;
AjxDateFormat.getDateInstance=function(a){a=a!=null?a:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._DATE_FORMATTERS[a]){AjxDateFormat._DATE_FORMATTERS[a]=new AjxDateFormat(AjxDateFormat._dateFormats[a])
}return AjxDateFormat._DATE_FORMATTERS[a]
};
AjxDateFormat.getTimeInstance=function(a){a=a!=null?a:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._TIME_FORMATTERS[a]){AjxDateFormat._TIME_FORMATTERS[a]=new AjxDateFormat(AjxDateFormat._timeFormats[a])
}return AjxDateFormat._TIME_FORMATTERS[a]
};
AjxDateFormat.getDateTimeInstance=function(a,c){a=a!=null?a:AjxDateFormat.DEFAULT;
c=c!=null?c:AjxDateFormat.DEFAULT;
var e=a*10+c;
if(!AjxDateFormat._DATETIME_FORMATTERS[e]){var f=I18nMsg.formatDateTime;
var g=[AjxDateFormat._dateFormats[a],AjxDateFormat._timeFormats[c]];
var d=AjxMessageFormat.format(f,g);
AjxDateFormat._DATETIME_FORMATTERS[e]=new AjxDateFormat(d)
}return AjxDateFormat._DATETIME_FORMATTERS[e]
};
AjxDateFormat.format=function(c,a){return new AjxDateFormat(c).format(a)
};
AjxDateFormat.parse=function(c,a){return new AjxDateFormat(c).parse(a)
};
AjxDateFormat.initialize=function(){AjxDateFormat._dateFormats=[I18nMsg.formatDateShort,I18nMsg.formatDateMedium,I18nMsg.formatDateLong,I18nMsg.formatDateFull,I18nMsg.formatDateNumber];
AjxDateFormat._timeFormats=[I18nMsg.formatTimeShort,I18nMsg.formatTimeMedium,I18nMsg.formatTimeLong,I18nMsg.formatTimeFull];
AjxDateFormat._timeParsers=[];
for(var c=1,a;
a=I18nMsg["parseTime"+c];
c++){AjxDateFormat._timeParsers.push(new RegExp(a,"i"))
}AjxDateFormat._DATE_FORMATTERS={};
AjxDateFormat._TIME_FORMATTERS={};
AjxDateFormat._DATETIME_FORMATTERS={};
AjxDateFormat.MonthSegment.initialize();
AjxDateFormat.WeekdaySegment.initialize()
};
AjxDateFormat.parseTime=function(h){for(var g=0;
g<AjxDateFormat._timeParsers.length;
g++){var a=AjxDateFormat._timeParsers[g].exec(h);
if(a){var d=parseInt(a[1],10)||0;
var f=parseInt(a[2],10)||0;
var e=a[3];
if(e){var c=I18nMsg.parseTimePMChars;
if(d==12){d=0
}if(c.indexOf(e)!=-1){d+=12
}}if(d<24&&f<60){date=new Date();
date.setHours(d);
date.setMinutes(f);
date.setSeconds(0);
return date
}}}};
AjxDateFormat.prototype.parse=function(f){var d=null;
try{d=AjxFormat.prototype.parse.call(this,f);
var c=new Date(0,0,2,0,0,0,0);
if(d.year!=null){c.setFullYear(d.year)
}if(d.month!=null){c.setMonth(d.month)
}c.setDate(1);
if(d.dayofmonth!=null){c.setDate(d.dayofmonth)
}else{if(d.dayofyear!=null){c.setMonth(0,d.dayofyear)
}}if(d.hours!=null){c.setHours(d.hours)
}if(d.minutes!=null){c.setMinutes(d.minutes)
}if(d.seconds!=null){c.setSeconds(d.seconds)
}if(d.milliseconds!=null){c.setMilliseconds(d.milliseconds)
}if(d.ampm!=null){var a=c.getHours();
if(a==12&&d.ampm==0){a=0
}else{if(a!=12&&d.ampm==1){a+=12
}}c.setHours(a)
}if(d.timezone!=null){c.setMinutes(c.getMinutes()-d.timezone)
}if(isNaN(c.getTime())){return null
}d=c
}catch(g){}return d
};
AjxDateFormat.prototype._createParseObject=function(){return{year:null,month:null,dayofmonth:null,dayofyear:null,hours:null,minutes:null,seconds:null,milliseconds:null,ampm:null,era:null,timezone:null}
};
AjxFormat.TextSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxFormat.TextSegment.prototype=new AjxFormat.Segment;
AjxFormat.TextSegment.prototype.constructor=AjxFormat.TextSegment;
AjxFormat.TextSegment.prototype.toString=function(){return'text: "'+this._s+'"'
};
AjxFormat.TextSegment.prototype.parse=function(d,c,a){return AjxFormat.Segment._parseLiteral(this._s,c,a)
};
AjxDateFormat.DateSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxDateFormat.DateSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.DateSegment.prototype.constructor=AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment=function(c,a){if(arguments.length==0){return
}AjxDateFormat.DateSegment.call(this,c,a)
};
AjxDateFormat.EraSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment.prototype.constructor=AjxDateFormat.EraSegment;
AjxDateFormat.EraSegment.prototype.toString=function(){return'dateEra: "'+this._s+'"'
};
AjxDateFormat.EraSegment.prototype.format=function(a){return I18nMsg.eraAD
};
AjxDateFormat.YearSegment=function(c,a){if(arguments.length==0){return
}AjxDateFormat.DateSegment.call(this,c,a)
};
AjxDateFormat.YearSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.YearSegment.prototype.constructor=AjxDateFormat.YearSegment;
AjxDateFormat.YearSegment.prototype.toString=function(){return'dateYear: "'+this._s+'"'
};
AjxDateFormat.YearSegment.prototype.format=function(a){var c=String(a.getFullYear());
return this._s.length<4?c.substr(c.length-2):AjxFormat._zeroPad(c,this._s.length)
};
AjxDateFormat.YearSegment.prototype.parse=function(d,j,f){var a=this._getFixedLength();
var c=AjxFormat.Segment._parseInt(d,"year",0,j,f,a);
if(c-f==2){if(!AjxDateFormat._2digitStartYear){AjxDateFormat._2digitStartYear=parseInt(AjxMsg.dateParsing2DigitStartYear)
}var h=AjxDateFormat._2digitStartYear;
var i=parseInt(j.substr(f,2),10);
var e=(Math.floor(h/100)+(i<(h%100)?1:0))*100;
var g=e+i;
d.year=g
}return c
};
AjxDateFormat.MonthSegment=function(c,a){if(arguments.length==0){return
}AjxDateFormat.DateSegment.call(this,c,a)
};
AjxDateFormat.MonthSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.MonthSegment.prototype.constructor=AjxDateFormat.MonthSegment;
AjxDateFormat.MonthSegment.prototype.toString=function(){return'dateMonth: "'+this._s+'"'
};
AjxDateFormat.MonthSegment.initialize=function(){AjxDateFormat.MonthSegment.MONTHS={};
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT]=[AjxMsg.monthJanShort,AjxMsg.monthFebShort,AjxMsg.monthMarShort,AjxMsg.monthAprShort,AjxMsg.monthMayShort,AjxMsg.monthJunShort,AjxMsg.monthJulShort,AjxMsg.monthAugShort,AjxMsg.monthSepShort,AjxMsg.monthOctShort,AjxMsg.monthNovShort,AjxMsg.monthDecShort];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM]=[I18nMsg.monthJanMedium,I18nMsg.monthFebMedium,I18nMsg.monthMarMedium,I18nMsg.monthAprMedium,I18nMsg.monthMayMedium,I18nMsg.monthJunMedium,I18nMsg.monthJulMedium,I18nMsg.monthAugMedium,I18nMsg.monthSepMedium,I18nMsg.monthOctMedium,I18nMsg.monthNovMedium,I18nMsg.monthDecMedium];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG]=[I18nMsg.monthJanLong,I18nMsg.monthFebLong,I18nMsg.monthMarLong,I18nMsg.monthAprLong,I18nMsg.monthMayLong,I18nMsg.monthJunLong,I18nMsg.monthJulLong,I18nMsg.monthAugLong,I18nMsg.monthSepLong,I18nMsg.monthOctLong,I18nMsg.monthNovLong,I18nMsg.monthDecLong]
};
AjxDateFormat.MonthSegment.prototype.format=function(a){var c=a.getMonth();
switch(this._s.length){case 1:return String(c+1);
case 2:return AjxFormat._zeroPad(c+1,2);
case 3:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM][c];
case 5:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT][c]
}return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG][c]
};
AjxDateFormat.MonthSegment.prototype.parse=function(d,f,c){var a;
switch(this._s.length){case 3:a=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM];
case 4:a=a||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG];
case 5:a=a||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT];
var e=AjxFormat.Segment._parseLiterals(d,"month",0,a,f,c);
if(e==-1){throw new AjxFormat.ParsingException(this._parent,this,"no match")
}return e
}var g=this._getFixedLength();
return AjxFormat.Segment._parseInt(d,"month",-1,f,c,g)
};
AjxDateFormat.WeekSegment=function(c,a){if(arguments.length==0){return
}AjxDateFormat.DateSegment.call(this,c,a)
};
AjxDateFormat.WeekSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekSegment.prototype.constructor=AjxDateFormat.WeekSegment;
AjxDateFormat.WeekSegment.prototype.toString=function(){return'weekMonth: "'+this._s+'"'
};
AjxDateFormat.WeekSegment.prototype.format=function(c){var e=c.getYear();
var g=c.getMonth();
var a=c.getDate();
var h=/w/.test(this._s);
var f=new Date(e,h?0:g,1);
var d=0;
while(true){d++;
if(f.getMonth()>g||(f.getMonth()==g&&f.getDate()>=a)){break
}f.setDate(f.getDate()+7)
}return AjxFormat._zeroPad(d,this._s.length)
};
AjxDateFormat.WeekSegment.prototype.parse=function(c,d,a){var e=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,d,a,e)
};
AjxDateFormat.DaySegment=function(c,a){if(arguments.length==0){return
}AjxDateFormat.DateSegment.call(this,c,a)
};
AjxDateFormat.DaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.DaySegment.prototype.constructor=AjxDateFormat.DaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){return'dateDay: "'+this._s+'"'
};
AjxDateFormat.DaySegment.prototype.format=function(c){var f=c.getMonth();
var a=c.getDate();
if(/D/.test(this._s)&&f>0){var d=c.getYear();
do{var e=new Date(d,f,1);
e.setDate(0);
a+=e.getDate();
f--
}while(f>0)
}return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.DaySegment.prototype.parse=function(c,f,a){var g=this._getFixedLength();
var e=function(h){if(h>AjxDateUtil.MAX_DAYS_PER_MONTH){throw new AjxFormat.ParsingException(this._parent,this,"number too long")
}else{c.dayofmonth=h
}};
var d=/D/.test(this._s)?"dayofyear":e;
return AjxFormat.Segment._parseInt(c,d,0,f,a,g)
};
AjxDateFormat.WeekdaySegment=function(c,a){if(arguments.length==0){return
}AjxDateFormat.DateSegment.call(this,c,a)
};
AjxDateFormat.WeekdaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekdaySegment.prototype.constructor=AjxDateFormat.WeekdaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){return'dateDay: "'+this._s+'"'
};
AjxDateFormat.WeekdaySegment.initialize=function(){AjxDateFormat.WeekdaySegment.WEEKDAYS={};
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT]=[AjxMsg.weekdaySunShort,AjxMsg.weekdayMonShort,AjxMsg.weekdayTueShort,AjxMsg.weekdayWedShort,AjxMsg.weekdayThuShort,AjxMsg.weekdayFriShort,AjxMsg.weekdaySatShort];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM]=[I18nMsg.weekdaySunMedium,I18nMsg.weekdayMonMedium,I18nMsg.weekdayTueMedium,I18nMsg.weekdayWedMedium,I18nMsg.weekdayThuMedium,I18nMsg.weekdayFriMedium,I18nMsg.weekdaySatMedium];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG]=[I18nMsg.weekdaySunLong,I18nMsg.weekdayMonLong,I18nMsg.weekdayTueLong,I18nMsg.weekdayWedLong,I18nMsg.weekdayThuLong,I18nMsg.weekdayFriLong,I18nMsg.weekdaySatLong]
};
AjxDateFormat.WeekdaySegment.prototype.format=function(a){var d=a.getDay();
if(/E/.test(this._s)){var c;
switch(this._s.length){case 4:c=AjxDateFormat.LONG;
break;
case 5:c=AjxDateFormat.SHORT;
break;
default:c=AjxDateFormat.MEDIUM
}return AjxDateFormat.WeekdaySegment.WEEKDAYS[c][d]
}return AjxFormat._zeroPad(d,this._s.length)
};
AjxDateFormat.WeekdaySegment.prototype.parse=function(d,f,c){var a;
switch(this._s.length){case 3:a=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM];
case 4:a=a||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG];
case 5:a=a||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT];
var e=AjxFormat.Segment._parseLiterals(null,null,0,a,f,c);
if(e==-1){throw new AjxFormat.ParsingException(this._parent,this,"no match")
}return e
}var g=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,f,c,g)
};
AjxDateFormat.TimeSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxDateFormat.TimeSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.TimeSegment.prototype.constructor=AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxDateFormat.HourSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment.prototype.constructor=AjxDateFormat.HourSegment;
AjxDateFormat.HourSegment.prototype.toString=function(){return'timeHour: "'+this._s+'"'
};
AjxDateFormat.HourSegment.prototype.format=function(c){var a=c.getHours();
if(a>12&&/[hK]/.test(this._s)){a-=12
}else{if(a==0&&/[h]/.test(this._s)){a=12
}else{if(a===12&&/K/.test(this._s)){a=0
}else{if(a===0&&/k/.test(this._s)){a=24
}}}}return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.HourSegment.prototype.parse=function(c,d,a){var e=this._getFixedLength();
return AjxFormat.Segment._parseInt(c,"hours",0,d,a,e)
};
AjxDateFormat.MinuteSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxDateFormat.MinuteSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.MinuteSegment.prototype.constructor=AjxDateFormat.MinuteSegment;
AjxDateFormat.MinuteSegment.prototype.toString=function(){return'timeMinute: "'+this._s+'"'
};
AjxDateFormat.MinuteSegment.prototype.format=function(a){var c=a.getMinutes();
return AjxFormat._zeroPad(c,this._s.length)
};
AjxDateFormat.MinuteSegment.prototype.parse=function(c,d,a){var e=this._getFixedLength();
return AjxFormat.Segment._parseInt(c,"minutes",0,d,a,e)
};
AjxDateFormat.SecondSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxDateFormat.SecondSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.SecondSegment.prototype.constructor=AjxDateFormat.SecondSegment;
AjxDateFormat.SecondSegment.prototype.toString=function(){return'timeSecond: "'+this._s+'"'
};
AjxDateFormat.SecondSegment.prototype.format=function(a){var c=/s/.test(this._s)?a.getSeconds():a.getMilliseconds();
return AjxFormat._zeroPad(c,this._s.length)
};
AjxDateFormat.SecondSegment.prototype.parse=function(d,f,c){var a=/s/.test(this._s);
var e=a?"seconds":"milliseconds";
var g=a?this._getFixedLength():0;
return AjxFormat.Segment._parseInt(d,e,0,f,c,g)
};
AjxDateFormat.AmPmSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxDateFormat.AmPmSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.AmPmSegment.prototype.constructor=AjxDateFormat.AmPmSegment;
AjxDateFormat.AmPmSegment.prototype.toString=function(){return'timeAmPm: "'+this._s+'"'
};
AjxDateFormat.AmPmSegment.prototype.format=function(c){var a=c.getHours();
return a<12?I18nMsg.periodAm:I18nMsg.periodPm
};
AjxDateFormat.AmPmSegment.prototype.parse=function(c,e,a){var f=[I18nMsg.periodAm.toLowerCase(),I18nMsg.periodPm.toLowerCase(),I18nMsg.periodAm.toUpperCase(),I18nMsg.periodPm.toUpperCase()];
var d=AjxFormat.Segment._parseLiterals(c,"ampm",0,f,e,a);
if(d==-1){throw new AjxFormat.ParsingException(this._parent,this,"no match")
}c.ampm=c.ampm%2;
return d
};
AjxDateFormat.TimezoneSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxDateFormat.TimezoneSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.TimezoneSegment.prototype.constructor=AjxDateFormat.TimezoneSegment;
AjxDateFormat.TimezoneSegment.prototype.toString=function(){return'timeTimezone: "'+this._s+'"'
};
AjxDateFormat.TimezoneSegment.prototype.format=function(c){var a=c.timezone||AjxTimezone.DEFAULT;
if(/Z/.test(this._s)){return AjxTimezone.getShortName(a)
}return this._s.length<4?AjxTimezone.getMediumName(a):AjxTimezone.getLongName(a)
};
AjxMessageFormat=function(h){if(arguments.length==0){return
}AjxFormat.call(this,h);
if(h==null){return
}for(var d=0;
d<h.length;
d++){var j=h.charAt(d);
if(j=="'"){if(d+1<h.length&&h.charAt(d+1)=="'"){var e=new AjxFormat.TextSegment(this,"'");
this._segments.push(e);
d++;
continue
}var k=d+1;
for(d++;
d<h.length;
d++){var j=h.charAt(d);
if(j=="'"){if(d+1<h.length&&h.charAt(d+1)=="'"){h=h.substr(0,d)+h.substr(d+1)
}else{break
}}}var g=d;
var e=new AjxFormat.TextSegment(this,h.substring(k,g));
this._segments.push(e);
continue
}var k=d;
while(d<h.length){j=h.charAt(d);
if(j=="{"||j=="'"){break
}d++
}var g=d;
if(k!=g){var e=new AjxFormat.TextSegment(this,h.substring(k,g));
this._segments.push(e);
d--;
continue
}var k=d+1;
var a=0;
while(++d<h.length){var j=h.charAt(d);
if(j=="{"){a++
}else{if(j=="}"){if(a==0){break
}a--
}}}var g=d;
var f=g-k;
var l=h.substr(k,f);
var e=new AjxMessageFormat.MessageSegment(this,l);
if(e!=null){this._segments.push(e)
}}};
AjxMessageFormat.prototype=new AjxFormat;
AjxMessageFormat.prototype.constructor=AjxMessageFormat;
AjxMessageFormat.prototype.toString=function(){return"[AjxMessageFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxMessageFormat.format=function(a,c){return new AjxMessageFormat(a).format(c)
};
AjxMessageFormat.prototype.format=function(a){if(!(a instanceof Array)){a=[a]
}return AjxFormat.prototype.format.call(this,a)
};
AjxMessageFormat.prototype.getFormats=function(){var a=[];
for(var c=0;
c<this._segments.length;
c++){var d=this._segments[c];
if(d instanceof AjxMessageFormat.MessageSegment){a.push(d.getSegmentFormat())
}}return a
};
AjxMessageFormat.prototype.getFormatsByArgumentIndex=function(){var a=[];
for(var c=0;
c<this._segments.length;
c++){var d=this._segments[c];
if(d instanceof AjxMessageFormat.MessageSegment){a[d.getIndex()]=d.getSegmentFormat()
}}return a
};
AjxMessageFormat.MessageSegment=function(e,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,e,a);
var d=AjxMessageFormat.MessageSegment._split(a,",");
this._index=Number(d[0]);
this._type=d[1]||"string";
this._style=d[2];
if(this._type=="list"){this._isList=true;
this._type=d[2]||"string";
this._style=d[3]
}switch(this._type){case"number":switch(this._style){case"integer":this._formatter=AjxNumberFormat.getIntegerInstance();
break;
case"currency":this._formatter=AjxNumberFormat.getCurrencyInstance();
break;
case"percent":this._formatter=AjxNumberFormat.getPercentInstance();
break;
default:this._formatter=this._style==null?AjxNumberFormat.getInstance():new AjxNumberFormat(this._style)
}break;
case"date":case"time":var c=this._type=="date"?AjxDateFormat.getDateInstance:AjxDateFormat.getTimeInstance;
switch(this._style){case"short":this._formatter=c(AjxDateFormat.SHORT);
break;
case"medium":this._formatter=c(AjxDateFormat.MEDIUM);
break;
case"long":this._formatter=c(AjxDateFormat.LONG);
break;
case"full":this._formatter=c(AjxDateFormat.FULL);
break;
default:this._formatter=this._style==null?c(AjxDateFormat.DEFAULT):new AjxDateFormat(this._style)
}break;
case"choice":this._formatter=new AjxChoiceFormat(this._style);
break
}if(this._isList){this._formatter=new AjxListFormat(this._formatter)
}};
AjxMessageFormat.MessageSegment.prototype=new AjxFormat.Segment;
AjxMessageFormat.MessageSegment.prototype.constructor=AjxMessageFormat.MessageSegment;
AjxMessageFormat.MessageSegment.prototype.toString=function(){var c=['message: "',this._s,'", index: ',this._index];
if(this._isList){c.push(", list: ",this._isList)
}if(this._type){c.push(", type: ",this._type)
}if(this._style){c.push(", style: ",this._style)
}if(this._formatter){c.push(", formatter: ",this._formatter.toString())
}return c.join("")
};
AjxMessageFormat.MessageSegment.prototype._isList=false;
AjxMessageFormat.MessageSegment.prototype.format=function(c){var a=c[this._index];
if(this._formatter instanceof AjxChoiceFormat){return this._formatter.format(c,this._index)
}return this._formatter?this._formatter.format(a):String(a)
};
AjxMessageFormat.MessageSegment.prototype.getIndex=function(){return this._index
};
AjxMessageFormat.MessageSegment.prototype.getType=function(){return this._type
};
AjxMessageFormat.MessageSegment.prototype.getStyle=function(){return this._style
};
AjxMessageFormat.MessageSegment.prototype.getSegmentFormat=function(){return this._formatter
};
AjxMessageFormat.MessageSegment._split=function(f,a){var g=[];
var e=0;
var d;
var h=0;
for(d=0;
d<f.length;
d++){var i=f.charAt(d);
if(i=="{"){h++
}else{if(i=="}"){h--
}else{if(i==a&&h==0){g.push(f.substring(e,d));
e=d+1
}}}}if(d>e){g.push(f.substring(e,d))
}return g
};
AjxNumberFormat=function(r,s){if(arguments.length==0){return
}AjxFormat.call(this,r);
if(!r){return
}var c=r.split(/;/);
var r=c[0];
var p=0;
var n=this.__parseStatic(r,p);
p=n.offset;
var g=n.text!="";
if(g){this._segments.push(new AjxFormat.TextSegment(this,n.text))
}var h=p;
while(p<r.length&&AjxNumberFormat._META_CHARS.indexOf(r.charAt(p))!=-1){p++
}var f=p;
var a=r.substring(h,f);
var t=a.indexOf("E");
var l=t!=-1?a.substring(t+1):null;
if(l){a=a.substring(0,t);
this._showExponent=true
}var m=a.indexOf(I18nMsg.numberSeparatorDecimal!=""?I18nMsg.numberSeparatorDecimal:".");
var u=m!=-1?a.substring(0,m):a;
if(u){var v=u.lastIndexOf(I18nMsg.numberSeparatorGrouping!=""?I18nMsg.numberSeparatorGrouping:",");
if(v!=-1){this._groupingOffset=u.length-v-1
}u=u.replace(/[^#0]/g,"");
var k=u.indexOf("0");
if(k!=-1){this._minIntDigits=u.length-k
}this._maxIntDigits=u.length
}var q=m!=-1?a.substring(m+1):null;
if(q){var k=q.lastIndexOf("0");
if(k!=-1){this._minFracDigits=k+1
}this._maxFracDigits=q.replace(/[^#0]/g,"").length
}this._segments.push(new AjxNumberFormat.NumberSegment(this,a));
var n=this.__parseStatic(r,p);
p=n.offset;
if(n.text!=""){this._segments.push(new AjxFormat.TextSegment(this,n.text))
}if(s){return
}if(c.length>1){var r=c[1];
this._negativeFormatter=new AjxNumberFormat(r,true)
}else{var o=new AjxNumberFormat("");
o._segments=o._segments.concat(this._segments);
var j=g?1:0;
var d=new AjxFormat.TextSegment(o,I18nMsg.numberSignMinus);
o._segments.splice(j,0,d);
this._negativeFormatter=o
}};
AjxNumberFormat.prototype=new AjxFormat;
AjxNumberFormat.prototype.constructor=AjxNumberFormat;
AjxNumberFormat.prototype.toString=function(){var a=["[AjxNumberFormat: ","formatter=",AjxFormat.prototype.toString.call(this)];
if(this._negativeFormatter){a.push(", negativeFormatter=",this._negativeFormatter.toString())
}a.push("]");
return a.join("")
};
AjxNumberFormat._NUMBER="number";
AjxNumberFormat._INTEGER="integer";
AjxNumberFormat._CURRENCY="currency";
AjxNumberFormat._PERCENT="percent";
AjxNumberFormat._META_CHARS="0#.,E";
AjxNumberFormat.prototype._groupingOffset=Number.MAX_VALUE;
AjxNumberFormat.prototype._minIntDigits=1;
AjxNumberFormat.prototype._isCurrency=false;
AjxNumberFormat.prototype._isPercent=false;
AjxNumberFormat.prototype._isPerMille=false;
AjxNumberFormat.prototype._showExponent=false;
AjxNumberFormat.getInstance=function(){if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]){AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]=new AjxNumberFormat(I18nMsg.formatNumber)
}return AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]
};
AjxNumberFormat.getNumberInstance=AjxNumberFormat.getInstance;
AjxNumberFormat.getCurrencyInstance=function(){if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]){AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]=new AjxNumberFormat(I18nMsg.formatNumberCurrency)
}return AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]
};
AjxNumberFormat.getIntegerInstance=function(){if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]){AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]=new AjxNumberFormat(I18nMsg.formatNumberInteger)
}return AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]
};
AjxNumberFormat.getPercentInstance=function(){if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]){AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]=new AjxNumberFormat(I18nMsg.formatNumberPercent)
}return AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]
};
AjxNumberFormat.format=function(c,a){return new AjxNumberFormat(c).format(a)
};
AjxNumberFormat.initialize=function(){AjxNumberFormat._FORMATTERS={}
};
AjxNumberFormat.prototype.format=function(a){if(a<0&&this._negativeFormatter){return this._negativeFormatter.format(a)
}return AjxFormat.prototype.format.call(this,a)
};
AjxNumberFormat.prototype.__parseStatic=function(e,d){var f=[];
while(d<e.length){var h=e.charAt(d++);
if(AjxNumberFormat._META_CHARS.indexOf(h)!=-1){d--;
break
}switch(h){case"'":var g=d;
while(d<e.length&&e.charAt(d++)!="'"){}var a=d;
h=a-g==0?"'":e.substring(g,a);
break;
case"%":h=I18nMsg.numberSignPercent;
this._isPercent=true;
break;
case"\u2030":h=I18nMsg.numberSignPerMill;
this._isPerMille=true;
break;
case"\u00a4":h=e.charAt(d)=="\u00a4"?I18nMsg.currencyCode:I18nMsg.currencySymbol;
this._isCurrency=true;
break
}f.push(h)
}return{text:f.join(""),offset:d}
};
AjxNumberFormat.NumberSegment=function(c,a){if(arguments.length==0){return
}AjxFormat.Segment.call(this,c,a)
};
AjxNumberFormat.NumberSegment.prototype=new AjxFormat.Segment;
AjxNumberFormat.NumberSegment.prototype.constructor=AjxNumberFormat.NumberSegment;
AjxNumberFormat.NumberSegment.prototype.toString=function(){return'number: "'+this._s+'"'
};
AjxNumberFormat.NumberSegment.prototype.format=function(c){if(isNaN(c)){return I18nMsg.numberNaN
}if(c===Number.NEGATIVE_INFINITY||c===Number.POSITIVE_INFINITY){return I18nMsg.numberInfinity
}if(typeof c!="number"){c=Number(c)
}c=Math.abs(c);
if(this._parent._isPercent){c*=100
}else{if(this._parent._isPerMille){c*=1000
}}var a=this._parent._showExponent?c.toExponential(this._parent._maxFracDigits).toUpperCase().replace(/E\+/,"E"):c.toFixed(this._parent._maxFracDigits||0);
a=this._normalize(a);
return a
};
AjxNumberFormat.NumberSegment.prototype._normalize=function(g){var e=g.split(/[\.Ee]/);
var h=e.shift();
if(h.length<this._parent._minIntDigits){h=AjxFormat._zeroPad(h,this._parent._minIntDigits,I18nMsg.numberZero)
}if(h.length>this._parent._groupingOffset){var d=[];
var f=h.length-this._parent._groupingOffset;
while(f>0){d.unshift(h.substr(f,this._parent._groupingOffset));
d.unshift(I18nMsg.numberSeparatorGrouping);
f-=this._parent._groupingOffset
}d.unshift(h.substring(0,f+this._parent._groupingOffset));
h=d.join("")
}var j="0";
var k;
if(g.match(/\./)){j=e.shift()
}else{if(g.match(/\e/)||g.match(/\E/)){k=e.shift()
}}j=j.replace(/0+$/,"");
if(j.length<this._parent._minFracDigits){j=AjxFormat._zeroPad(j,this._parent._minFracDigits,I18nMsg.numberZero,true)
}var d=[h];
if(j.length>0){var c=this._parent._isCurrency?I18nMsg.numberSeparatorMoneyDecimal:I18nMsg.numberSeparatorDecimal;
d.push(c,j)
}if(k){d.push("E",k.replace(/^\+/,""))
}return d.join("")
};
AjxChoiceFormat=function(g){if(arguments.length==0){return
}AjxFormat.call(this,g);
if(g==null){return
}var k=g.split("|");
if(arguments.length==1){this._limits=new Array(k.length);
this._lessThan=new Array(k.length);
this._formats=new Array(k.length);
var h=new RegExp("^([^#<\u2264]+)([#<\u2264])(.*)$");
for(var d=0;
d<k.length;
d++){var c=k[d];
var e=h.exec(c);
var a=e[1];
var f=e[2];
var j=e[3];
if(a=="\u221E"){this._limits[d]=Number.POSITIVE_INFINITY
}else{if(a=="-\u221E"){this._limits[d]=Number.NEGATIVE_INFINITY
}else{this._limits[d]=parseFloat(a)
}}this._lessThan[d]=f=="#"||f=="\u2264";
this._formats[d]=new AjxMessageFormat(j)
}}else{this._limits=arguments[0];
this._lessThan=new Array(arguments[0].length);
this._formats=arguments[1];
this._pattern=[];
for(var d=0;
d<this._formats.length;
d++){if(d>0){this._pattern.push("|")
}this._pattern.push(this._limits[d],"#",this._formats[d]);
this._lessThan[d]=false;
this._formats[d]=new AjxMessageFormat(this._formats[d])
}this._pattern=this._pattern.join("")
}};
AjxChoiceFormat.prototype=new AjxFormat;
AjxChoiceFormat.prototype.constructor=AjxChoiceFormat;
AjxChoiceFormat.prototype.toString=function(){return["[AjxChoiceFormat: ","limits={ ",this._limits.join(", ")," }, ","formats={ ",this._formats.join(", ")," }, ","lessThan={ ",this._lessThan.join(", ")," }]"].join("")
};
AjxChoiceFormat.prototype.getLimits=function(){return this._limits
};
AjxChoiceFormat.prototype.getFormats=function(){return this._formats
};
AjxChoiceFormat.prototype.format=function(c,f){var e=c instanceof Array?c[f]:c;
var k;
if(isNaN(e)||e<this._limits[0]){k=this._formats[0]
}else{for(var d=0;
d<this._limits.length-1;
d++){var j=this._limits[d];
var h=this._limits[d+1];
var l=e>=j;
var g=this._lessThan[d+1]?e<h:e<=h;
if(l&&g){k=this._formats[d];
break
}}if(!k){k=this._formats[this._formats.length-1]
}}return k.format(c)
};
AjxListFormat=function(c,e,d,a){AjxFormat.call(this,c?c.toPattern():"");
this._formatter=c;
this._separator=e||AjxMsg.listSeparator;
this._lastSeparator=d||AjxMsg.listSeparatorLast;
this._twoSeparator=a||AjxMsg.listSeparatorTwo
};
AjxListFormat.prototype=new AjxFormat;
AjxListFormat.prototype.constructor=AjxListFormat;
AjxListFormat.prototype.format=function(f){f=f instanceof Array?f:[f];
var e=[];
var a=f.length;
for(var c=0;
c<a;
c++){if(c>0){e.push((c<a-1)?this._separator:(a==2)?this._twoSeparator:this._lastSeparator)
}var d=f[c];
e.push(this._formatter?this._formatter.format(d):String(d))
}return e.join("")
};
AjxFormat.initialize()
}if(AjxPackage.define("ajax.util.AjxVector")){AjxVector=function(a){this._array=a||[]
};
AjxVector.prototype.isAjxVector=true;
AjxVector.prototype.toString=function(f,d){if(d!==true){return this._array.join(f)
}var e=new Array();
for(var g=0;
g<this._array.length;
g++){var c=this._array[g];
if(c!=undefined&&c!=null&&c!=""){e.push(c)
}}return e.join(f)
};
AjxVector.fromArray=function(c){var a=new AjxVector();
if(AjxUtil.isArray1(c)){a._array=c
}return a
};
AjxVector.prototype.size=function(){return this._array.length
};
AjxVector.prototype.add=function(d,a,c){if(c&&this.contains(d)){return
}AjxUtil.arrayAdd(this._array,d,a)
};
AjxVector.prototype.addList=function(d){if(!d){return
}if(d.length){this._array=this._array.concat(d)
}else{if(d.size&&d.size()){if(AjxEnv.isIE&&(!(d._array instanceof Array))){var c=[];
for(var a=0;
a<d._array.length;
a++){c.push(d._array[a])
}d._array=c
}this._array=this._array.concat(d._array)
}}};
AjxVector.prototype.remove=function(a){return AjxUtil.arrayRemove(this._array,a)
};
AjxVector.prototype.removeAt=function(c){if(c>=this._array.length||c<0){return null
}var d=this._array.splice(c,1);
var a=null;
if(d){a=d[0]
}return a
};
AjxVector.prototype.removeAll=function(){for(var a=0;
a<this._array.length;
a++){this._array[a]=null
}this._array.length=0
};
AjxVector.prototype.removeLast=function(){return this._array.length>0?this._array.pop():null
};
AjxVector.prototype.reverse=function(){this._array.reverse()
};
AjxVector.prototype.replace=function(d,c){var a=this._array[d];
this._array[d]=c;
return a
};
AjxVector.prototype.replaceObject=function(d,a){for(var c=0;
c<this._array.length;
c++){if(this._array[c]==d){this._array[c]=a;
return d
}}return null
};
AjxVector.prototype.indexOf=function(d,c){if(d==null){return -1
}d=c?c.call(d):d;
for(var a=0;
a<this._array.length;
a++){var f=this._array[a],e=c?c.call(f):f;
if(e===d){return a
}}return -1
};
AjxVector.prototype.indexOfLike=AjxVector.prototype.indexOf;
AjxVector.prototype.lastIndexOf=function(d,c){if(d==null){return -1
}d=c?c.call(d):d;
for(var a=this._array.length-1;
a>=0;
a--){var f=this._array[a],e=c?c.call(f):f;
if(f===d){return a
}}return -1
};
AjxVector.prototype.lastIndexOfLike=AjxVector.prototype.lastIndexOf;
AjxVector.prototype.lastIndexOfLike=function(e,d){var c=d.call(e);
for(var a=this._array.length-1;
a>=0;
a--){var f=d.call(this._array[a]);
if(f==c){return a
}}return -1
};
AjxVector.prototype.clone=function(){var a=new AjxVector();
a.addList(this);
return a
};
AjxVector.prototype.contains=function(a){return AjxUtil.arrayContains(this._array,a)
};
AjxVector.prototype.containsLike=function(e,d){var c=d.call(e);
for(var a=0;
a<this._array.length;
a++){var f=d.call(this._array[a]);
if(f==c){return true
}}return false
};
AjxVector.prototype.get=function(a){return a>=this._array.length||a<0?null:this._array[a]
};
AjxVector.prototype.getArray=function(){return this._array
};
AjxVector.prototype.getLast=function(){return this._array.length==0?null:this._array[this._array.length-1]
};
AjxVector.prototype.getNext=function(c){var a=this.indexOf(c);
if(a==-1){return null
}return this.get(++a)
};
AjxVector.prototype.getPrev=function(c){var a=this.indexOf(c);
if(a==-1){return null
}return this.get(--a)
};
AjxVector.prototype.sort=function(a){if(!a){a=AjxVector._defaultArrayComparator
}this._array.sort(a)
};
AjxVector.prototype.binarySearch=function(g,h){if(!h){h=AjxVector._defaultArrayComparator
}var d=0;
var a=this._array;
var e=a.length-1;
while(true){if(e<d){return -1
}var f=Math.floor((d+e)/2);
var c=h(g,a[f]);
if(c<0){e=f-1
}else{if(c>0){d=f+1
}else{return f
}}}};
AjxVector.prototype.merge=function(f,e){if(f<0){return
}var g=e instanceof AjxVector?e.getArray():e;
var a=this._array.length<(f+g.length)?this._array.length:f+g.length;
if(f<this._array.length){var d=0;
for(var c=f;
c<a;
c++){this._array[c]=g[d++]
}if(d<g.length){this._array=this._array.concat(g.slice(d))
}}else{this._array=this._array.concat(g)
}};
AjxVector._defaultArrayComparator=function(d,c){return d<c?-1:(d>c?1:0)
};
AjxVector.prototype.foreach=function(e,g){var a=this.size(),c=0,d;
if(typeof e=="function"){while(--a>=0){e.call(g,this.get(c),c++)
}}else{while(--a>=0){d=this.get(c++);
if(d!=null){d[e].call(d)
}}}};
AjxVector.prototype.map=function(g,h){var c=[],d=this.size(),e;
if(typeof g=="function"){while(--d>=0){c[d]=g.call(h,this.get(d),d)
}}else{if(g instanceof AjxCallback){while(--d>=0){c[d]=g.run(this.get(d),d)
}}else{while(--d>=0){e=this.get(d);
if(e!=null){if(typeof e[g]=="function"){c.unshift(e[g].call(e))
}else{c.unshift(e[g])
}}}}}return AjxVector.fromArray(c)
};
AjxVector.prototype.filter=function(c,a){return AjxVector.fromArray(AjxUtil.filter(this._array,c,a))
};
AjxVector.prototype.join=function(a){return this._array.join(a)
};
AjxVector.prototype.some=function(a,c){return this._array.some(a,c)
};
AjxVector.prototype.sub=function(h,j){var d=[],c=this.size(),e=0,g;
while(--c>=0){g=this.get(e++);
if(!h.call(j,g,e)){d.push(g)
}}return AjxVector.fromArray(d)
};
AjxVector.prototype.slice=function(c,a){return AjxVector.fromArray(this._array.slice(c,a))
}
}if(AjxPackage.define("ajax.util.AjxStringUtil")){AjxStringUtil=function(){};
AjxStringUtil.TRIM_RE=/^\s+|\s+$/g;
AjxStringUtil.COMPRESS_RE=/\s+/g;
AjxStringUtil.ELLIPSIS=" ... ";
AjxStringUtil.ELLIPSIS_NO_SPACE="...";
AjxStringUtil.LIST_SEP=", ";
AjxStringUtil.CRLF="\r\n";
AjxStringUtil.CRLF2="\r\n\r\n";
AjxStringUtil.CRLF_HTML="<br>";
AjxStringUtil.CRLF2_HTML="<div><br></div><div><br></div>";
AjxStringUtil.IMG_SRC_CID_REGEX=/<img([^>]*)\ssrc=["']cid:/gi;
AjxStringUtil.makeString=function(a){return a?String(a):""
};
AjxStringUtil.capitalize=function(a){return a&&a.length>0?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""
};
AjxStringUtil.capitalizeFirstLetter=function(a){return a&&a.length>0?a.charAt(0).toUpperCase()+a.substr(1):""
};
AjxStringUtil.capitalizeWords=function(a){return a?AjxUtil.map(a.split(/\s+/g),AjxStringUtil.capitalizeFirstLetter).join(" "):""
};
AjxStringUtil.toMixed=function(g,a,e){if(!g||(typeof g!="string")){return""
}a=a||/\s+/;
var d=g.split(a);
var f=[];
f.push(e?d[0].toLowerCase():d[0].substring(0,1).toUpperCase()+d[0].substring(1).toLowerCase());
for(var c=1;
c<d.length;
c++){f.push(d[c].substring(0,1).toUpperCase()+d[c].substring(1).toLowerCase())
}return f.join("")
};
AjxStringUtil.fromMixed=function(c,a){a=["$1",a||" ","$2"].join("");
return AjxStringUtil.trim(c.replace(/([a-z])([A-Z]+)/g,a))
};
AjxStringUtil.trim=function(f,a,e){if(!f){return""
}var d=AjxStringUtil.TRIM_RE;
var c=AjxStringUtil.COMPRESS_RE;
if(e){d=new RegExp("^"+e+"+|"+e+"+$","g");
c=new RegExp(e+"+","g")
}else{e=" "
}f=f.replace(d,"");
if(a){f=f.replace(c,e)
}return f
};
AjxStringUtil.repeat=function(e,a){var d="";
for(var c=0;
c<a;
c++){d+=e
}return d
};
AjxStringUtil.getUnitsFromSizeString=function(c){var d="px";
if(typeof(c)=="string"){var a=Number(parseInt(c,10)).toString();
if(c.length>a.length){d=c.substr(a.length,(c.length-a.length));
if(!(d=="em"||d=="ex"||d=="px"||d=="in"||d=="cm"==d=="mm"||d=="pt"||d=="pc"||d=="%")){d="px"
}}}return d
};
AjxStringUtil.split=function(m,f){if(!m){return[]
}var h=0;
f=f?f:",";
var o=new Object();
if(typeof f=="string"){o[f]=1
}else{for(h=0;
h<f.length;
h++){o[f[h]]=1
}}var a=false;
var e=0;
var d=0;
var n;
var k=[];
var g=0;
for(h=0;
h<m.length;
h++){var l=m.charAt(h);
if(l=='"'){a=!a
}else{if(l=="("){e++
}else{if(l==")"){e--
}else{if(o[l]){if(!a&&!e){n=m.substring(d,h);
k[g++]=n;
d=h+1
}}}}}}n=m.substring(d,m.length);
k[g++]=n;
return k
};
AjxStringUtil.SPACE_WORD_RE=new RegExp("\\s*\\S+","g");
AjxStringUtil.splitKeepLeadingWhitespace=function(c){var d=[],a;
while(a=AjxStringUtil.SPACE_WORD_RE.exec(c)){d.push(a[0])
}return d
};
AjxStringUtil.WRAP_LENGTH=80;
AjxStringUtil.HDR_WRAP_LENGTH=120;
AjxStringUtil.MAX_HTMLNODE_COUNT=250;
AjxStringUtil.HTML_QUOTE_COLOR="#1010FF";
AjxStringUtil.HTML_QUOTE_STYLE="color:#000;font-weight:normal;font-style:normal;text-decoration:none;font-family:Helvetica,Arial,sans-serif;font-size:12pt;";
AjxStringUtil.HTML_QUOTE_PREFIX_PRE='<blockquote style="border-left:2px solid '+AjxStringUtil.HTML_QUOTE_COLOR+";margin-left:5px;padding-left:5px;"+AjxStringUtil.HTML_QUOTE_STYLE+'">';
AjxStringUtil.HTML_QUOTE_PREFIX_POST="</blockquote>";
AjxStringUtil.HTML_QUOTE_NONPREFIX_PRE='<div style="'+AjxStringUtil.HTML_QUOTE_STYLE+'">';
AjxStringUtil.HTML_QUOTE_NONPREFIX_POST="</div><br/>";
AjxStringUtil.wordWrap=function(G){if(!(G&&G.text)){return""
}var q=G.text;
var r=G.before||"";
var c=G.after||"";
var d=G.isFlowed;
if(G.htmlMode){r=G.before||(G.prefix?AjxStringUtil.HTML_QUOTE_PREFIX_PRE:AjxStringUtil.HTML_QUOTE_NONPREFIX_PRE);
c=G.after||(G.prefix?AjxStringUtil.HTML_QUOTE_PREFIX_POST:AjxStringUtil.HTML_QUOTE_NONPREFIX_POST);
return[r,q,c].join("")
}var A=G.len||(G.isHeaders?AjxStringUtil.HDR_WRAP_LENGTH:AjxStringUtil.WRAP_LENGTH);
var H=G.prefix||"";
var g="\n";
var a=q.split(AjxStringUtil.SPLIT_RE);
var t=[];
for(var x=0,F=a.length;
x<F;
x++){var o=a[x];
var v=o.match(/^([\s>\|]+)/);
var y=v?v[1]:"";
if(y){o=o.substr(y.length)
}if(AjxStringUtil._NON_WHITESPACE.test(o)){var j=AjxStringUtil.splitKeepLeadingWhitespace(o);
if(j&&j[0]&&j[0].length){var u=AjxStringUtil.MSG_SEP_RE.test(o)||AjxStringUtil.COLON_RE.test(o)||AjxStringUtil.HDR_RE.test(o)||G.isHeaders||AjxStringUtil.SIG_RE.test(o);
var s=G.preserveReturns;
if(d){var v=o.match(/( +)$/);
if(v){j[j.length-1]+=v[1];
s=false
}else{s=true
}}for(var n=0,p=j.length;
n<p;
n++){t.push({w:j[n],prefix:y,mustStart:(n===0)&&u,mustEnd:(n===p-1)&&s})
}}}else{t.push({para:true,prefix:y})
}}var k="",f=0,j=[],h=null;
for(var z=0,B=t.length;
z<B;
z++){var C=t[z];
var n=C.w,y=C.prefix;
var e=!H?"":h?H:H+" ";
var D=(h===null)?0:h.length;
D=0;
var E=e+(h||"");
if(C.para){if(j.length){k+=E+j.join("").replace(/^ +/,"")+g
}if(z<t.length-1){h=y;
e=!H?"":h?H:H+" ";
E=e+(h||"");
k+=E+g
}j=[];
f=0;
h=null
}else{if((D+f+n.length<=A)&&(y===h||h===null)&&!C.mustStart){j.push(n);
f+=n.length;
h=y;
if(C.mustEnd&&t[z+1]){t[z+1].mustStart=true
}}else{if(j.length){k+=E+j.join("").replace(/^ +/,"")+g
}j=[n];
f=n.length;
h=y;
if(C.mustEnd&&t[z+1]){t[z+1].mustStart=true
}}}}if(j.length){var e=!H?"":j[0].prefix?H:H+" ";
var E=e+(h||"");
k+=E+j.join("").replace(/^ /,"")+g
}return[r,k,c].join("")
};
AjxStringUtil.quoteText=function(e){if(!(e&&e.text)){return""
}var j=e.text;
var i=e.before||"",a=e.after||"";
if(e.htmlMode||!e.pre){return[i,j,a].join("")
}var g=e.len||80;
var d=e.pre||"";
var h="\n";
j=AjxStringUtil.trim(j);
j=j.replace(/\n\r/g,h);
var n=j.split(h);
var m=[];
for(var c=0,f=n.length;
c<f;
c++){var k=AjxStringUtil.trim(n[c]);
m.push(d+k+h)
}return i+m.join("")+a
};
AjxStringUtil.SHIFT_CHAR={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};
AjxStringUtil.shiftChar=function(a,c){return c?AjxStringUtil.SHIFT_CHAR[a]||String.fromCharCode(a):String.fromCharCode(a)
};
AjxStringUtil.diffPoint=function(e,d){if(!(e&&d)){return 0
}var a=Math.min(e.length,d.length);
var c=0;
while(c<a&&(e.charAt(c)==d.charAt(c))){c++
}return c
};
AjxStringUtil.resolve=function(c,a){return AjxMessageFormat.format(c,a)
};
AjxStringUtil.urlEncode=function(c){if(!c){return""
}var a=window.encodeURL||window.encodeURI;
return a(c)
};
AjxStringUtil.urlComponentEncode=function(c){if(!c){return""
}var a=window.encodeURLComponent||window.encodeURIComponent;
return a(c)
};
AjxStringUtil.urlDecode=function(d){if(!d){return""
}var a=window.decodeURL||window.decodeURI;
try{return a(d)
}catch(c){return""
}};
AjxStringUtil.urlComponentDecode=function(f){if(!f){return""
}var c=window.decodeURLComponent||window.decodeURIComponent;
var a;
try{a=c(f)
}catch(d){a=unescape(f)
}return a||f
};
AjxStringUtil.ENCODE_MAP={">":"&gt;","<":"&lt;","&":"&amp;"};
AjxStringUtil.htmlEncode=function(c,a){if(!c){return""
}if(typeof(c)!="string"){c=c.toString?c.toString():""
}if(!AjxEnv.isSafari||AjxEnv.isSafariNightly){if(a){return c.replace(/[<>&]/g,function(d){return AjxStringUtil.ENCODE_MAP[d]
}).replace(/  /g," &nbsp;")
}else{return c.replace(/[<>&]/g,function(d){return AjxStringUtil.ENCODE_MAP[d]
})
}}else{if(a){return c.replace(/[&]/g,"&amp;").replace(/  /g," &nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}else{return c.replace(/[&]/g,"&amp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}}};
AjxStringUtil.encodeQuotes=function(a){return a.replace(/"/g,"&quot;").replace(/'/g,"&#39;")
};
AjxStringUtil.htmlDecode=function(c,a){if(a){c=c.replace(/&nbsp;/g," ")
}return c.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")
};
AjxStringUtil.__jsEscapeChar=function(d){var a=d.charCodeAt(0).toString(16);
if(a.length==1){return"\\u000"+a
}else{if(a.length==2){return"\\u00"+a
}else{if(a.length==3){return"\\u0"+a
}else{if(a.length==4){return"\\u"+a
}}}}DBG.println(AjxDebug.NONE,"unexpected condition in AjxStringUtil.__jsEscapeChar -- code point 0x"+a+" doesn't fit in 16 bits")
};
AjxStringUtil.jsEncode=function(a){return a.replace(/[^\u0020-\u007e]/g,AjxStringUtil.__jsEscapeChar)
};
AjxStringUtil.stripTags=function(c,a){if(typeof c!=="string"){return""
}if(a){c=c.replace(/(<(\w+)[^>]*>).*(<\/\2[^>]*>)/,"$1$3")
}return c.replace(/<\/?[^>]+>/gi,"")
};
AjxStringUtil.convertToHtml=function(j,d,c,h){c=c||"<blockquote>";
h=h||"</blockquote>";
if(!j){return""
}j=AjxStringUtil.htmlEncode(j);
if(d){var e=/^(>|&gt;|\|\s+)/;
var l=j.split(/\r?\n/);
var a=0;
for(var f=0;
f<l.length;
f++){var k=l[f];
if(k.length>0){var g=0;
while(k.match(e)){k=k.replace(e,"");
g++
}while(g>a){k=c+k;
a++
}while(g<a){l[f-1]=l[f-1]+h;
a--
}}l[f]=k
}while(a>0){l.push(h);
a--
}j=l.join("\n")
}j=j.replace(/  /mg," &nbsp;").replace(/^ /mg,"&nbsp;").replace(/\t/mg,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\r?\n/mg,"<br>");
return j
};
AjxStringUtil.SPACE_ENCODE_MAP={" ":"&nbsp;",">":"&gt;","<":"&lt;","&":"&amp;","\n":"<br>"};
AjxStringUtil.htmlEncodeSpace=function(a){if(!a){return""
}return a.replace(/[&]/g,"&amp;").replace(/ /g,"&nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
};
AjxStringUtil.htmlRubyEncode=function(a,c){if(a&&c){return["<ruby>","<rb>",AjxStringUtil.htmlEncode(a),"</rb> ","<rp>(</rp><rt>",AjxStringUtil.htmlEncode(c),"</rt><rp>)</rp>","</ruby>"].join("")
}return AjxStringUtil.htmlEncode(a||c||"")
};
AjxStringUtil.nl2br=function(a){if(!a){return""
}return a.replace(/^ /mg,"&nbsp;").replace(/\t/mg,"<span style='white-space:pre'>\t</span>").replace(/\n/g,"<br>")
};
AjxStringUtil.xmlEncode=function(a){if(a){a=""+a;
return a.replace(/&/g,"&amp;").replace(/</g,"&lt;")
}return""
};
AjxStringUtil.xmlDecode=function(a){return a?a.replace(/&amp;/g,"&").replace(/&lt;/g,"<"):""
};
AjxStringUtil.xmlAttrEncode=function(a){return a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&apos;"):""
};
AjxStringUtil.xmlAttrDecode=function(a){return a?a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&apos;/g,"'"):""
};
AjxStringUtil.__RE_META={" ":" ","\n":"\\n","\r":"\\r","\t":"\\t"};
AjxStringUtil.__reMetaEscape=function(c,a){return AjxStringUtil.__RE_META[a]||"\\"+a
};
AjxStringUtil.regExEscape=function(a){return a.replace(/(\W)/g,AjxStringUtil.__reMetaEscape)
};
AjxStringUtil._calcDIV=null;
AjxStringUtil.calcDIV=function(){if(AjxStringUtil._calcDIV==null){AjxStringUtil._calcDIV=document.createElement("div");
AjxStringUtil._calcDIV.style.zIndex=0;
AjxStringUtil._calcDIV.style.position=DwtControl.ABSOLUTE_STYLE;
AjxStringUtil._calcDIV.style.visibility="hidden";
document.body.appendChild(AjxStringUtil._calcDIV)
}return AjxStringUtil._calcDIV
};
AjxStringUtil.clip=function(a,g,f){var e=AjxStringUtil.calcDIV();
if(arguments.length==3){e.className=f
}e.innerHTML=a;
if(e.offsetWidth<=g){return a
}for(var d=a.length-1;
d>0;
d--){var c=a.substr(0,d);
e.innerHTML=c+AjxStringUtil.ELLIPSIS;
if(e.offsetWidth<=g){return c+AjxStringUtil.ELLIPSIS
}}return a
};
AjxStringUtil.clipByLength=function(d,c){var a=d.length;
return(a<=c)?d:[d.substr(0,c/2),"...",d.substring(a-((c/2)-3),a)].join("")
};
AjxStringUtil.wrap=function(g,h,i){var n=AjxStringUtil.calcDIV();
if(arguments.length==3){n.className=i
}var j="";
var f="";
var a=g.split("/n");
for(var e=0;
e<a.length;
e++){if(e!=0){j+=f+"<br>";
f=""
}htmlRows=a[e].split("<br>");
for(var l=0;
l<htmlRows.length;
l++){if(l!=0){j+=f+"<br>";
f=""
}words=htmlRows[l].split(" ");
var m=0;
while(m<words.length){n.innerHTML=f+" "+words[m];
var d=n.offsetWidth;
if(d>h){n.innerHTML=words[m];
d=d-n.offsetWidth;
if((d>=h)||(n.offsetWidth<=h)){j+=f+"<br>";
f=""
}else{var k=true;
var c=0;
while(k){c++;
n.innerHTML=f+" "+words[m].substring(0,c);
k=(n.offsetWidth<=h)
}c--;
j+=f+words[m].substring(0,c)+"<br>";
words[m]=words[m].substr(c);
f=""
}}else{f+=" "+words[m];
m++
}}}}j+=f;
return j
};
AjxStringUtil.MSG_SEP_RE=new RegExp("^\\s*--+\\s*("+AjxMsg.origMsg+"|"+AjxMsg.forwardedMessage+")\\s*--+","i");
AjxStringUtil.SIG_RE=/^(- ?-+)|(__+)\r?$/;
AjxStringUtil.SPLIT_RE=/\r\n|\r|\n/;
AjxStringUtil.HDR_RE=/^\s*\w+:/;
AjxStringUtil.COLON_RE=/\S+:$/;
AjxStringUtil._NO_LIST=0;
AjxStringUtil._ORDERED_LIST=1;
AjxStringUtil._UNORDERED_LIST=2;
AjxStringUtil._INDENT="    ";
AjxStringUtil._NON_WHITESPACE=/\S+/;
AjxStringUtil._LF=/\n/;
AjxStringUtil.convertHtml2Text=function(e,g,f){if(!e){return""
}if(g&&AjxUtil.isFunction(g._before)){e=g._before(e)
}if(typeof e=="string"){var h=document.createElement("SPAN");
h.innerHTML=e;
e=h
}var i=[];
var d=0;
var c={};
AjxStringUtil._traverse(e,i,d,AjxStringUtil._NO_LIST,0,0,c,g,f);
var a=i.join("");
if(g&&AjxUtil.isFunction(g._after)){a=g._after(a)
}return a
};
AjxStringUtil._traverse=function(a,p,m,k,h,f,g,l,n){var j=a.nodeName.toLowerCase();
var q=null;
if(l&&l[j]){q=l[j](a,g)
}if(q!=null){p[m++]=q
}else{if(j=="#text"){if(a.nodeValue.search(AjxStringUtil._NON_WHITESPACE)!=-1){if(g.lastNode=="ol"||g.lastNode=="ul"){p[m++]="\n"
}if(g.isPreformatted){p[m++]=AjxStringUtil.trim(a.nodeValue)+" "
}else{p[m++]=AjxStringUtil.trim(a.nodeValue.replace(AjxStringUtil._LF," "),true)+" "
}}}else{if(j=="p"){p[m++]=n?"\n":"\n\n"
}else{if(j==="a"){if(a.href){p[m++]="[ ";
p[m++]=a.href;
if(a.textContent){p[m++]=" | ";
p[m++]=a.textContent
}p[m++]=" ] ";
return m
}}else{if(k==AjxStringUtil._NO_LIST&&(j=="br"||j=="hr")){p[m++]="\n"
}else{if(j=="ol"||j=="ul"){p[m++]="\n";
if(a.parentNode.nodeName.toLowerCase()!="li"&&g.lastNode!="br"&&g.lastNode!="hr"){p[m++]="\n"
}k=(j=="ol")?AjxStringUtil._ORDERED_LIST:AjxStringUtil._UNORDERED_LIST;
h++;
f=0
}else{if(j=="li"){for(var d=0;
d<h;
d++){p[m++]=AjxStringUtil._INDENT
}if(k==AjxStringUtil._ORDERED_LIST){p[m++]=f+". "
}else{p[m++]="\u002A "
}}else{if(j=="tr"&&a.parentNode.firstChild!=a){p[m++]="\n"
}else{if(j=="td"&&a.parentNode.firstChild!=a){p[m++]="\t"
}else{if(j=="div"||j=="address"){if(m&&p[m-1]!=="\n"){p[m++]="\n"
}}else{if(j=="blockquote"){p[m++]="\n\n"
}else{if(j=="pre"){if(m&&p[m-1]!=="\n"){p[m++]="\n"
}g.isPreformatted=true
}else{if(j=="#comment"||j=="script"||j=="select"||j=="style"){return m
}}}}}}}}}}}}}var o=a.childNodes;
var e=o.length;
for(var d=0;
d<e;
d++){var c=o[d];
if(c.nodeType==1&&c.tagName.toLowerCase()=="li"){f++
}m=AjxStringUtil._traverse(c,p,m,k,h,f,g,l,n)
}if(l&&l["/"+j]){p[m++]=l["/"+j](a)
}if(j=="h1"||j=="h2"||j=="h3"||j=="h4"||j=="h5"||j=="h6"||j=="div"||j=="address"){if(m&&p[m-1]!=="\n"){p[m++]="\n"
}g.list=false
}else{if(j=="pre"){if(m&&p[m-1]!=="\n"){p[m++]="\n"
}g.isPreformatted=false
}else{if(j=="li"){if(!g.list){p[m++]="\n"
}g.list=false
}else{if(j=="ol"||j=="ul"){g.list=true
}else{if(j!="#text"){g.list=false
}}}}}g.lastNode=j;
return m
};
AjxStringUtil.queryStringSet=function(j,l){var k=l?"":location.search;
if(k.indexOf("?")==0){k=k.substr(1)
}var h=k.split("&");
var d={};
for(var e=0;
e<h.length;
e++){var g=h[e].split("=");
d[g[0]]=g[1]
}for(var a in j){d[a]=j[a]
}var c=[];
var e=0;
for(var a in d){if(a){c[e++]=[a,d[a]].join("=")
}}return"?"+c.join("&")
};
AjxStringUtil.queryStringRemove=function(a,d){a=a?a:"";
if(a.indexOf("?")==0){a=a.substr(1)
}var f=a.split("&");
var c=[];
for(var e=0;
e<f.length;
e++){if(f[e].indexOf(d)!=0){c.push(f[e])
}}return"?"+c.join("&")
};
AjxStringUtil.getAsString=function(a){return !a?"":(typeof(a)=="object")?a.toString():a
};
AjxStringUtil.isWhitespace=function(a){return(a.charCodeAt(0)<=32)
};
AjxStringUtil.isDigit=function(c){var a=c.charCodeAt(0);
return(a>=48&&a<=57)
};
AjxStringUtil.compareRight=function(f,d){var g=0;
var i=0;
var h=0;
var e;
var c;
for(;
(i<f.length||h<d.length);
i++,h++){e=f.charAt(i);
c=d.charAt(h);
if(!AjxStringUtil.isDigit(e)&&!AjxStringUtil.isDigit(c)){return g
}else{if(!AjxStringUtil.isDigit(e)){return -1
}else{if(!AjxStringUtil.isDigit(c)){return +1
}else{if(e<c){if(g==0){g=-1
}}else{if(e>c){if(g==0){g=+1
}}}}}}}};
AjxStringUtil.natCompare=function(j,i){var h=0,f=0;
var d=0,c=0;
var g,e;
while(h<j.length||f<i.length){d=c=0;
g=j.charAt(h);
e=i.charAt(f);
while(AjxStringUtil.isWhitespace(g)||g=="0"){d=(g=="0")?(d+1):0;
g=j.charAt(++h)
}while(AjxStringUtil.isWhitespace(e)||e=="0"){c=(e=="0")?(c+1):0;
e=i.charAt(++f)
}if(AjxStringUtil.isDigit(g)&&AjxStringUtil.isDigit(e)){var k=AjxStringUtil.compareRight(j.substring(h),i.substring(f));
if(k&&k!=0){return k
}}if(g==0&&e==0){return d-c
}if(g<e){return -1
}else{if(g>e){return +1
}}++h;
++f
}};
AjxStringUtil.clipFile=function(f,a){var c=f.lastIndexOf(".");
if(c<=0){c=f.length
}if(c<=a){return f
}var e=f.slice(0,c);
var d=f.slice(c);
return[e.slice(0,a/2),AjxMsg.ellipsis,e.slice(-Math.ceil(a/2)+AjxMsg.ellipsis.length),d].join("")
};
AjxStringUtil.URL_PARSE_RE=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)?((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?");
AjxStringUtil.parseURL=function(d){var f=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"];
var e=AjxStringUtil.URL_PARSE_RE.exec(d);
var c={};
for(var a=0;
a<f.length;
a++){c[f[a]]=(e[a]?e[a]:"")
}if(c.directoryPath.length>0){c.directoryPath=c.directoryPath.replace(/\/?$/,"/")
}return c
};
AjxStringUtil.parseMailtoLink=function(d){var c={};
if(!d){return c
}if(d.toLowerCase().indexOf("mailto:")===-1){c.to=d;
return c
}var a=d.match(/\bsubject=([^&]+)/i);
c.subject=a?decodeURIComponent(a[1]):null;
a=d.match(/\bto\:([^&]+)/);
if(!a){a=d.match(/\bmailto\:([^\?]+)/i)
}c.to=a?decodeURIComponent(a[1]):null;
a=d.match(/\bbody=([^&]+)/i);
c.body=a?decodeURIComponent(a[1]):null;
return c
};
AjxStringUtil.parseQueryString=function(f){var j=f||(""+window.location);
var k=j.indexOf("?");
var g=(k===-1)?j:j.substring(k+1);
g=g.replace(/#.*$/,"");
var e=g.split("&");
var a={},c,l,h;
for(var d=0;
d<e.length;
d++){c=e[d].split("=");
l=decodeURIComponent(c[0]),h=c[1]?decodeURIComponent(c[1]):true;
a[l]=h
}return a
};
AjxStringUtil.prettyPrint=function(e,d,a,c){AjxStringUtil._visited=new AjxVector();
var f=AjxStringUtil._prettyPrint(e,d,a,c);
AjxStringUtil._visited=null;
return f
};
AjxStringUtil._visited=null;
AjxStringUtil._prettyPrint=function(h,c,s,d){var m=0;
var e=false;
var n=false;
if(arguments.length>4){m=arguments[4];
e=arguments[5];
n=arguments[6]
}if(AjxUtil.isObject(h)){var q=h.toString?h.toString():"";
if(d&&q&&d[q]){return"["+q+"]"
}if(AjxStringUtil._visited.contains(h)){return"[visited object]"
}else{AjxStringUtil._visited.add(h)
}}var g=AjxStringUtil.repeat(" ",m);
var j="";
if(h===undefined){j+="[undefined]"
}else{if(h===null){j+="[null]"
}else{if(AjxUtil.isBoolean(h)){j+=h?"true":"false"
}else{if(AjxUtil.isString(h)){j+='"'+AjxStringUtil._escapeForHTML(h)+'"'
}else{if(AjxUtil.isNumber(h)){j+=h
}else{if(AjxUtil.isObject(h)){var f=AjxUtil.isArray(h)||AjxUtil.isArray1(h);
if(n){j+=f?"[Array]":h.toString()
}else{n=!c;
var k=new Array();
for(var o in h){if(h.hasOwnProperty(o)){k.push(o)
}}if(f){k.sort(function(u,i){return u-i
})
}else{k.sort()
}if(e){j+=f?"[":"{"
}var p=k.length;
for(var o=0;
o<p;
o++){var t=k[o];
var r=h[t];
var l=null;
if(r==window||r==document||(!AjxEnv.isIE&&r instanceof Node)){l=r.toString()
}if((typeof(r)=="function")){if(s){l="[function]"
}else{continue
}}if(o>0){j+=","
}j+="\n"+g;
var a;
if(f){a="// ["+t+"]:\n"+g
}else{a=t+": "
}if(d&&d[t]){j+=a+"["+t+"]"
}else{if(l!=null){j+=a+l
}else{j+=a+AjxStringUtil._prettyPrint(r,c,s,d,m+2,true,n)
}}}if(o>0){j+="\n"+AjxStringUtil.repeat(" ",m-1)
}if(e){j+=f?"]":"}"
}}}}}}}}return j
};
AjxStringUtil._escapeForHTML=function(c){if(typeof(c)!="string"){return c
}var a=c;
a=a.replace(/\&/g,"&amp;");
a=a.replace(/\</g,"&lt;");
a=a.replace(/\>/g,"&gt;");
a=a.replace(/\"/g,"&quot;");
a=a.replace(/\xA0/g,"&nbsp;");
return a
};
AjxStringUtil._testSpan=null;
AjxStringUtil._testSpanBold=null;
AjxStringUtil.WIDTH={};
AjxStringUtil.WIDTH_BOLD={};
AjxStringUtil.MAX_CACHE=1000;
AjxStringUtil._cacheSize=0;
AjxStringUtil.getWidth=function(f,e,j){if(!AjxStringUtil._testSpan){var d=AjxStringUtil._testSpan=document.createElement("SPAN");
var c=AjxStringUtil._testSpanBold=document.createElement("SPAN");
d.style.position=c.style.position=Dwt.ABSOLUTE_STYLE;
var k=DwtShell.getShell(window).getHtmlElement();
k.appendChild(d);
k.appendChild(c);
Dwt.setLocation(d,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
Dwt.setLocation(c,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
c.style.fontWeight="bold"
}if(AjxUtil.isString(j)){j=DwtCssStyle.asPixelCount(j)
}var g=""+(j||0);
var a=e?AjxStringUtil.WIDTH_BOLD:AjxStringUtil.WIDTH;
if(a[f]&&a[f][g]){return a[f][g]
}if(AjxStringUtil._cacheSize>=AjxStringUtil.MAX_CACHE){AjxStringUtil.WIDTH={};
AjxStringUtil.WIDTH_BOLD={};
AjxStringUtil._cacheSize=0
}var i=e?AjxStringUtil._testSpanBold:AjxStringUtil._testSpan;
i.innerHTML=f;
i.style.fontSize=j?(j+"px"):null;
if(!a[f]){a[f]={}
}var h=a[f][g]=Dwt.getSize(i).x;
AjxStringUtil._cacheSize++;
return h
};
AjxStringUtil.fitString=function(f,c){var d=AjxStringUtil.getWidth(f);
if(d<c){return f
}var a=AjxStringUtil.ELLIPSIS_NO_SPACE,e=AjxStringUtil.getWidth(a);
while(f.length>0){if(AjxStringUtil.getWidth(f)+e<c){return f+a
}else{f=f.substring(0,f.length-1)
}}return""
};
AjxStringUtil.fixCrossDomainReference=function(c,e,d){var g=AjxStringUtil.parseURL(c);
if(g.authority==window.location.host){return c
}if((e&&c.indexOf(e)>=0)||!e){if(d){c=g.path
}else{var f=g.protocol+"://"+g.authority;
var a=window.location.protocol+"//"+window.location.host;
c=c.replace(f,a)
}}return c
};
AjxStringUtil._dummyDiv=document.createElement("DIV");
AjxStringUtil.htmlPlatformIndependent=function(c){var d=AjxStringUtil._dummyDiv;
d.innerHTML=c;
var a=d.innerHTML;
d.innerHTML="";
return a
};
AjxStringUtil.equalsHtmlPlatformIndependent=function(c,a){return AjxStringUtil.htmlPlatformIndependent(c)==AjxStringUtil.htmlPlatformIndependent(a)
};
AjxStringUtil.ORIG_UNKNOWN="UNKNOWN";
AjxStringUtil.ORIG_QUOTED="QUOTED";
AjxStringUtil.ORIG_SEP_STRONG="SEP_STRONG";
AjxStringUtil.ORIG_SEP_WEAK="SEP_WEAK";
AjxStringUtil.ORIG_WROTE_STRONG="WROTE_STRONG";
AjxStringUtil.ORIG_WROTE_WEAK="WROTE_WEAK";
AjxStringUtil.ORIG_HEADER="HEADER";
AjxStringUtil.ORIG_LINE="LINE";
AjxStringUtil.ORIG_SIG_SEP="SIG_SEP";
AjxStringUtil.MSG_REGEXES=[{type:AjxStringUtil.ORIG_QUOTED,regex:/^\s*(>|\|)/},{type:AjxStringUtil.ORIG_SEP_STRONG,regex:new RegExp("^\\s*--+\\s*("+AjxMsg.origMsg+"|"+AjxMsg.forwardedMessage+"|"+AjxMsg.origAppt+")\\s*--+\\s*$","i")},{type:AjxStringUtil.ORIG_SEP_STRONG,regex:new RegExp("^"+AjxMsg.forwardedMessage1+"$","i")},{type:AjxStringUtil.ORIG_HEADER,regex:new RegExp("^\\s*("+[AjxMsg.from,AjxMsg.to,AjxMsg.subject,AjxMsg.date,AjxMsg.sent,AjxMsg.cc].join("|")+")")},{type:AjxStringUtil.ORIG_LINE,regex:/^\s*_{5,}\s*$/}];
AjxStringUtil.HTML_SEP_ID="zwchr";
AjxStringUtil.ORIG_EMAIL_RE=/[^@\s]+@[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})+/;
AjxStringUtil.ORIG_DATE_RE=/\d+\s*(\/|\-|, )20\d\d/;
AjxStringUtil.ORIG_INTRO_RE=new RegExp("^(-{2,}|"+AjxMsg.on+"\\s+)","i");
AjxStringUtil._writeToTestIframeDoc=function(c){var d;
if(!AjxStringUtil.__curIframeId){d=document.createElement("IFRAME");
AjxStringUtil.__curIframeId=d.id=Dwt.getNextId();
d.setAttribute("aria-hidden",true);
document.body.appendChild(d);
Dwt.setPosition(d,Dwt.ABSOLUTE_STYLE);
Dwt.setLocation(d,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}else{d=document.getElementById(AjxStringUtil.__curIframeId)
}var a=Dwt.getIframeDoc(d);
c=c&&c.replace(AjxStringUtil.IMG_SRC_CID_REGEX,'<img $1 pnsrc="cid:');
a.open();
a.write(c);
a.close();
return a.childNodes[0]
};
AjxStringUtil._removeTestIframeDoc=function(){if(AjxEnv.isFirefox){var a=document.getElementById(AjxStringUtil.__curIframeId);
if(a){a.parentNode.removeChild(a)
}AjxStringUtil.__curIframeId=null
}};
AjxStringUtil.getOriginalContent=function(p,o){if(!p){return""
}if(o){return AjxStringUtil._getOriginalHtmlContent(p)
}var r=[];
var a=p.split(AjxStringUtil.SPLIT_RE);
var e,n=[],g={},h,t,q=false;
for(var v=0;
v<a.length;
v++){var m=a[v];
var w=AjxStringUtil.trim(m);
if(!AjxStringUtil._NON_WHITESPACE.test(w)){n.push(m);
continue
}if((w.indexOf("| DO NOT REPLY")===0)&&(a[v+2].indexOf("bugzilla")!==-1)){q=true
}var d=AjxStringUtil._getLineType(w);
if(d===AjxStringUtil.ORIG_QUOTED){d=q?AjxStringUtil.ORIG_UNKNOWN:d
}else{q=false
}var z=a[v+1];
var h=false;
if(z&&(d===AjxStringUtil.ORIG_UNKNOWN)&&AjxStringUtil.ORIG_INTRO_RE.test(w)&&z.match(/\w+:$/)){w=[w,z].join(" ");
d=AjxStringUtil._getLineType(w);
h=true
}if(d===AjxStringUtil.ORIG_LINE){var u=v+1;
z=a[u];
while(!AjxStringUtil._NON_WHITESPACE.test(z)&&u<a.length){z=a[++u]
}var s=z&&AjxStringUtil._getLineType(z);
if(s===AjxStringUtil.ORIG_HEADER){d=AjxStringUtil.ORIG_HEADER
}else{d=AjxStringUtil.ORIG_UNKNOWN
}}if(e){if(e!==d){r.push({type:e,block:n});
t=(e===AjxStringUtil.ORIG_UNKNOWN)?n:t;
g[e]=g[e]?g[e]+1:1;
n=[];
e=d
}}else{e=d
}if(h&&(d===AjxStringUtil.ORIG_WROTE_WEAK||d===AjxStringUtil.ORIG_WROTE_STRONG)){n.push(m);
n.push(z);
v++;
h=false
}else{n.push(m)
}}if(n.length){r.push({type:e,block:n});
t=(e===AjxStringUtil.ORIG_UNKNOWN)?n:t;
g[e]=g[e]?g[e]+1:1
}var f=r[0],y=r[1];
if(f&&f.type===AjxStringUtil.ORIG_UNKNOWN&&y&&(y.type===AjxStringUtil.ORIG_HEADER||y.type===AjxStringUtil.ORIG_WROTE_STRONG)){var A=AjxStringUtil._getTextFromBlock(f.block);
if(A){var x=r[2];
if(x&&x.type===AjxStringUtil.ORIG_UNKNOWN){var c=AjxStringUtil._getTextFromBlock(x.block);
if(c&&c.indexOf(ZmItem.NOTES_SEPARATOR)!==-1){return A+c
}}return A
}}var A=AjxStringUtil._checkInlineWrote(g,r,false);
if(A){return A
}if(g[AjxStringUtil.ORIG_UNKNOWN]===1&&g[AjxStringUtil.ORIG_QUOTED]>0){var A=AjxStringUtil._getTextFromBlock(t);
if(A){return A
}}if(g[AjxStringUtil.ORIG_SEP_STRONG]>0){var k=[];
for(var v=0;
v<r.length;
v++){var l=r[v];
if(l.type===AjxStringUtil.ORIG_SEP_STRONG){break
}k=k.concat(l.block)
}var A=AjxStringUtil._getTextFromBlock(k);
if(A){return A
}}return p
};
AjxStringUtil._getLineType=function(f){var g=AjxStringUtil.ORIG_UNKNOWN;
for(var d=0;
d<AjxStringUtil.MSG_REGEXES.length;
d++){var e=AjxStringUtil.MSG_REGEXES[d];
var h=e.regex;
if(h.test(f.toLowerCase())){if(e.type==AjxStringUtil.ORIG_QUOTED&&/^\s*\|.*\|\s*$/.test(f)){continue
}g=e.type;
break
}}if(g===AjxStringUtil.ORIG_UNKNOWN){var c=f.match(/(\w+):$/);
var a=c&&c[1]&&c[1].toLowerCase();
if(a){var i=0;
i=i+(a===AjxMsg.wrote)?5:(a===AjxMsg.changed)?0:2;
if(AjxStringUtil.ORIG_EMAIL_RE.test(f)){i+=4
}if(AjxStringUtil.ORIG_DATE_RE.test(f)){i+=3
}var k=new RegExp("^(--|"+AjxMsg.on+")","i");
if(AjxStringUtil.ORIG_INTRO_RE.test(f)){i+=1
}if(i>=7){g=AjxStringUtil.ORIG_WROTE_STRONG
}else{if(i>=5){g=AjxStringUtil.ORIG_WROTE_WEAK
}}}}return g
};
AjxStringUtil._getTextFromBlock=function(c){if(!(c&&c.length)){return null
}var a=c.join("\n")+"\n";
a=a.replace(/\s+$/,"\n");
return(AjxStringUtil._NON_WHITESPACE.test(a))?a:null
};
AjxStringUtil.SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;
AjxStringUtil.IGNORE_NODE_LIST=["#comment","br","script","select","style"];
AjxStringUtil.IGNORE_NODE=AjxUtil.arrayAsHash(AjxStringUtil.IGNORE_NODE_LIST);
AjxStringUtil._getOriginalHtmlContent=function(m){var g=AjxStringUtil._writeToTestIframeDoc(m);
while(AjxStringUtil.SCRIPT_REGEX.test(m)){m=m.replace(AjxStringUtil.SCRIPT_REGEX,"")
}var n=false,u=[];
AjxStringUtil._flatten(g,u);
var h=u.length,t,q=[],f={},c,p,a,e,d,l;
for(t=0;
t<h;
t++){c=u[t];
if(c.nodeType===AjxUtil.ELEMENT_NODE){c.normalize()
}a=c.nodeName.toLowerCase();
e=AjxStringUtil._checkNode(u[t]);
if(e===AjxStringUtil.ORIG_UNKNOWN&&c.nodeName==="#text"&&(AjxStringUtil.ORIG_DATE_RE.test(c.nodeValue)||AjxStringUtil.ORIG_INTRO_RE.test(c.nodeValue))){var r=c.nodeValue;
for(var s=1;
s<10;
s++){var o=u[t+s];
if(o&&o.nodeName==="#text"){r+=o.nodeValue;
if(/:$/.test(r)){e=AjxStringUtil._getLineType(AjxStringUtil.trim(r));
if(e===AjxStringUtil.ORIG_WROTE_STRONG){t=t+s;
break
}}}}}if(e!==null){q.push({type:e,node:c,nodeName:a});
f[e]=f[e]?f[e]+1:1;
if(e===AjxStringUtil.ORIG_SEP_STRONG||e===AjxStringUtil.ORIG_WROTE_STRONG){l=c;
n=true;
break
}if(e===AjxStringUtil.ORIG_HEADER&&d===AjxStringUtil.ORIG_LINE){l=p;
n=true;
break
}p=c;
d=e
}}if(l){AjxStringUtil._prune(l,true)
}var k=n&&g.textContent?"<html>"+g.innerHTML+"</html>":m;
AjxStringUtil._removeTestIframeDoc();
return k
};
AjxStringUtil._flatten=function(d,e){var f=d&&d.nodeName.toLowerCase();
if(AjxStringUtil.IGNORE_NODE[f]){return
}e.push(d);
var c=d.childNodes||[];
for(var a=0;
a<c.length;
a++){this._flatten(c[a],e)
}};
AjxStringUtil._prune=function(c,a){var d=c&&c.parentNode;
while(d&&d.lastChild&&d.lastChild!==c){d.removeChild(d.lastChild)
}if(a&&d&&d.lastChild===c){d.removeChild(d.lastChild)
}var e=d&&d.nodeName.toLowerCase();
if(d&&e!=="body"&&e!=="html"){AjxStringUtil._prune(d,false)
}};
AjxStringUtil._checkNode=function(c){if(!c){return null
}var f=c.nodeName.toLowerCase();
var a=null;
if(f==="#text"){var d=AjxStringUtil.trim(c.nodeValue);
if(AjxStringUtil._NON_WHITESPACE.test(d)){a=AjxStringUtil._getLineType(d)
}}else{if(f==="hr"){if(c.id===AjxStringUtil.HTML_SEP_ID||(c.size==="2"&&c.width==="100%"&&c.align==="center")){a=AjxStringUtil.ORIG_SEP_STRONG
}else{a=AjxStringUtil.ORIG_LINE
}}else{if(f==="pre"){a=AjxStringUtil._checkNodeContent(c)
}else{if(f==="div"){if(c.className==="OutlookMessageHeader"||c.className==="gmail_quote"){a=AjxStringUtil.ORIG_SEP_STRONG
}else{if(c.style.borderTop){var e=DwtCssStyle.getComputedStyleObject(c);
if(e&&e.borderTopWidth&&parseInt(e.borderTopWidth)===1&&e.borderTopColor){a=AjxStringUtil.ORIG_SEP_STRONG
}}}a=a||AjxStringUtil._checkNodeContent(c)
}else{if(f==="span"){a=a||AjxStringUtil._checkNodeContent(c)
}else{if(f==="img"){a=AjxStringUtil.ORIG_UNKNOWN
}else{if(f==="blockquote"){a=AjxStringUtil.ORIG_QUOTED
}}}}}}}return a
};
AjxStringUtil._checkNodeContent=function(d){var c=d.textContent||"";
if(!AjxStringUtil._NON_WHITESPACE.test(c)||c.length>200){return null
}var a=AjxStringUtil._getLineType(c);
return(a===AjxStringUtil.ORIG_SEP_STRONG||a===AjxStringUtil.ORIG_WROTE_STRONG)?a:null
};
AjxStringUtil.checkForCleanHtml=function(d,f,g){var h=AjxStringUtil._writeToTestIframeDoc(d);
var c={allowedTags:AjxUtil.arrayAsHash(f),untrustedAttrs:g||[]};
AjxStringUtil._traverseCleanHtml(h,c);
var a="<html>"+h.innerHTML+"</html>";
var e=Math.max(h.scrollWidth,h.lastChild.scrollWidth);
AjxStringUtil._removeTestIframeDoc();
return{html:a,width:e,useIframe:c.fail}
};
AjxStringUtil._traverseCleanHtml=function(e,m){var c=true;
var o=e.nodeName.toLowerCase();
if(o==="style"&&e.innerHTML==="p { margin: 0; }"){e.doDelete=true
}else{if(o==="title"&&!e.innerHTML){}else{if(m.allowedTags[o]){if(e.style){var d=e.style&&e.style.cssText;
if(d!==""){d=d.toLowerCase();
if(!AjxStringUtil._checkStyle(d)){c=false
}e.style.cssText=AjxStringUtil._fixStyle(d)
}}if(e.removeAttribute&&e.attributes&&e.attributes.length){for(var g=0;
g<m.untrustedAttrs.length;
g++){if(e.hasAttribute(m.untrustedAttrs[g])){c=false
}}for(var g=0,p=e.attributes,f=p.length;
g<f;
g++){var k=p.item(g);
if(!k){continue
}var n=k.nodeName&&k.nodeName.toLowerCase();
if(n&&n.indexOf("on")===0){e.removeAttribute(n);
continue
}var h=k.nodeValue&&String(k.nodeValue);
if(h){h=h.toLowerCase();
if(o==="table"&&(n==="cellpadding"||n==="cellspacing"||n==="border")&&h!=="0"){c=false
}}}}}else{c=false
}}}for(var g=0,j=e.childNodes.length;
g<j;
g++){var a=e.childNodes[g];
AjxStringUtil._traverseCleanHtml(a,m)
}for(var g=e.childNodes.length-1;
g>=0;
g--){var a=e.childNodes[g];
if(a.doDelete){e.removeChild(a)
}}if(!c){m.fail=true
}};
AjxStringUtil._checkStyle=function(a){if(a.match(/\bposition\s*:\s*absolute[^;]*;?/)){return false
}if(a.match(/\bfont-[^;]*;?/)){return false
}return true
};
AjxStringUtil._fixStyle=function(a){a=a.replace(/\bmargin-?(top|left|right|bottom)?\s*:[^;]*-\d+[^;]*;?/gi,"");
a=a.replace(/\bpadding-?(top|left|right|bottom)?\s*:[^;]*-\d+[^;]*;?/gi,"");
a=a.replace(/\bposition\s*:\s*(absolute|fixed)[^;]*;?/,"");
return a
};
AjxStringUtil._checkInlineWrote=function(h,f){if(h[AjxStringUtil.ORIG_WROTE_STRONG]>0){var l,d=false,a={};
for(var g=0;
g<f.length;
g++){var m=f[g],j=m.type;
if(j===AjxStringUtil.ORIG_WROTE_STRONG){d=true
}else{if(j===AjxStringUtil.ORIG_UNKNOWN&&!d){if(l){return null
}else{l=m.block
}}else{if(d){a[j]=true
}}}}var k=(a[AjxStringUtil.ORIG_UNKNOWN]&&a[AjxStringUtil.ORIG_QUOTED]);
var c=(h[AjxStringUtil.ORIG_UNKNOWN]===2&&f[f.length-1].type===AjxStringUtil.ORIG_UNKNOWN);
if(l&&(!k||c)){var e=AjxStringUtil._getTextFromBlock(l);
if(e){return e
}}}};
AjxStringUtil.trimHtml=function(e){if(!e){return""
}var d=e;
d=d.replace(AjxStringUtil.DOC_TAG_REGEX,"");
d=d.replace(/<div><br ?\/?><\/div>/gi,"<br>");
var c=0;
while(d.length!==c&&(/^<br ?\/?>/i.test(d)||/<br ?\/?>$/i.test(d))){c=d.length;
d=d.replace(/^<br ?\/?>/i,"").replace(/<br ?\/?>$/i,"")
}var a=d&&d.match(/((<br ?\/?>)+)((<\/\w+>)+)$/i);
if(a&&a.length){var f=new RegExp(a[1]+a[3]+"$","i");
d=d.replace(f,a[3])
}d=d.replace(/(<div><\/div>)+/gi,"");
return AjxStringUtil.trim(d)
};
AjxStringUtil.DOC_TAG_REGEX=/<\/?(html|head|body)>/gi;
AjxStringUtil.defangHtmlContent=function(f){var k=AjxStringUtil._writeToTestIframeDoc(f);
var j=k.getElementsByTagName("img");
if(j&&j.length){var a;
var h;
var d;
for(var e=0;
e<j.length;
e++){a=j[e];
h=a.getAttribute("dfsrc");
if(h&&(h!=="#")){a.setAttribute("src",h)
}else{d=a.getAttribute("pnsrc");
if(d&&(d!=="#")){a.setAttribute("src",d)
}}a.removeAttribute("dfsrc")
}}var g="";
var c=k.childNodes;
for(var e=0;
e<c.length;
e++){if(c[e].tagName&&(c[e].tagName.toLowerCase()==="body")){g=c[e].innerHTML;
break
}}AjxStringUtil._removeTestIframeDoc();
return g
}
}if(AjxPackage.define("ajax.util.AjxTimedAction")){AjxTimedAction=function(d,c,a){AjxCallback.call(this,d,c,a);
this._tid=-1;
this._id=-1;
this._runResult=null
};
AjxTimedAction.prototype=new AjxCallback();
AjxTimedAction.prototype.constructor=AjxTimedAction;
AjxTimedAction.MAX_TIMEOUT=20*24*60*60*1000;
AjxTimedAction.prototype.toString=function(){return"AjxTimedAction"
};
AjxTimedAction.prototype.getRunResult=function(){return this._runResult
};
AjxTimedAction._pendingActions={};
AjxTimedAction._nextActionId=1;
AjxTimedAction.scheduleAction=function(d,c){if(!d){return
}if(d._tid&&d._tid!=-1){AjxTimedAction.cancelAction(d._id)
}c=c||0;
if(c>AjxTimedAction.MAX_TIMEOUT){if(window.DBG){}c=AjxTimedAction.MAX_TIMEOUT
}var e=d._id=AjxTimedAction._nextActionId++;
AjxTimedAction._pendingActions[e]=d;
var a="AjxTimedAction._exec("+e+")";
d._tid=window.setTimeout(a,c);
return d._id
};
AjxTimedAction.cancelAction=function(c){var a=AjxTimedAction._pendingActions[c];
if(a){window.clearTimeout(a._tid);
delete AjxTimedAction._pendingActions[c];
delete a._tid
}};
AjxTimedAction._exec=function(d){try{var c=AjxTimedAction._pendingActions[d];
if(c){delete AjxTimedAction._pendingActions[d];
delete c._tid;
c._runResult=c.run()
}}catch(a){AjxException.reportScriptError(a)
}}
}if(AjxPackage.define("ajax.dwt.core.Dwt")){Dwt=function(){};
Dwt.STATIC_STYLE="static";
Dwt.ABSOLUTE_STYLE="absolute";
Dwt.RELATIVE_STYLE="relative";
Dwt.FIXED_STYLE="fixed";
Dwt.NO_REPEAT="no-repeat";
Dwt.REPEAT="repeat";
Dwt.REPEAT_X="repeat-x";
Dwt.REPEAT_Y="repeat-y";
Dwt.DISPLAY_INLINE="inline";
Dwt.DISPLAY_BLOCK="block";
Dwt.DISPLAY_NONE="none";
Dwt.DISPLAY_TABLE_ROW="table-row";
Dwt.DISPLAY_TABLE_CELL="table-cell";
Dwt.CLIP=1;
Dwt.VISIBLE=2;
Dwt.SCROLL=3;
Dwt.FIXED_SCROLL=4;
Dwt.SCROLL_Y=5;
Dwt.SCROLL_X=6;
Dwt.Z_HIDDEN=100;
Dwt.Z_CURTAIN=200;
Dwt.Z_VIEW=300;
Dwt.Z_MENU=500;
Dwt.Z_VEIL=600;
Dwt.Z_DIALOG=700;
Dwt.Z_DIALOG_MENU=750;
Dwt.Z_TOOLTIP=775;
Dwt.Z_DND=800;
Dwt.Z_BUSY=900;
Dwt.Z_TOAST=950;
Dwt.Z_SPLASH=1000;
Dwt.DEFAULT=-123456789;
Dwt.CLEAR=-20000;
Dwt.LOC_NOWHERE=-10000;
Dwt.DND_DROP_NONE=0;
Dwt.DND_DROP_COPY=1;
Dwt.DND_DROP_MOVE=2;
Dwt.SCROLLBAR_WIDTH=22;
Dwt.HTML="text/html";
Dwt.TEXT="text/plain";
Dwt.KEY_OBJECT="_object_";
Dwt.KEY_ID="_id_";
Dwt._Z_INC=1;
Dwt.__nextId={};
Dwt.getNextId=function(a){a=a||"DWT";
if(!Dwt.__nextId[a]){Dwt.__nextId[a]=1
}return a+Dwt.__nextId[a]++
};
Dwt.getId=function(a,c){return a?a.id||(a.id=Dwt.getNextId(c)):null
};
Dwt.associateElementWithObject=function(d,a,c){d[c||"dwtObj"]=a.__internalId=AjxCore.assignId(a)
};
Dwt.disassociateElementFromObject=function(d,a,c){if(d){d.removeAttribute(c||"dwtObj")
}if(a.__internalId){AjxCore.unassignId(a.__internalId)
}};
Dwt.getObjectFromElement=function(c,a){return AjxCore.objectWithId(c[a||"dwtObj"])
};
Dwt.getElement=function(a){return(typeof(a)=="string")?document.getElementById(a):a
};
Dwt.findAncestor=function(d,c){var a=Dwt.getAttr(d,c);
while(d&&(a==null||a=="")){d=d.parentNode;
a=Dwt.getAttr(d,c)
}return d
};
Dwt.isAncestor=function(c,a){if(c==a){return true
}var d=a;
while(d){d=d.parentNode;
if(d==c){return true
}}return false
};
Dwt.setHandler=function(d,c,a){if(!(d=Dwt.getElement(d))){return
}if(c==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){Dwt.clearHandler(d,c)
}d[c]=a;
if(c==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){d.addEventListener("DOMMouseScroll",a,true)
}};
Dwt.clearHandler=function(d,c){if(!(d=Dwt.getElement(d))){return
}if(c==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){if(d[c]){var a=d[c];
d.removeEventListener("DOMMouseScroll",a,true)
}}d[c]=null
};
Dwt.getBackgroundRepeat=function(a){if(!(a=Dwt.getElement(a))){return
}return DwtCssStyle.getProperty(a,"background-repeat")
};
Dwt.setBackgroundRepeat=function(c,a){if(!(c=Dwt.getElement(c))){return
}c.style.backgroundRepeat=a
};
Dwt.getBounds=function(f,d){if(!(f=Dwt.getElement(f))){return null
}var e=DwtPoint.tmp;
Dwt.getLocation(f,e);
var c=e.x;
var a=e.y;
Dwt.getSize(f,e);
if(!d){return new DwtRectangle(c,a,e.x,e.y)
}else{d.set(c,a,e.x,e.y);
return d
}};
Dwt.setBounds=function(e,c,f,d,a){if(!(e=Dwt.getElement(e))){return
}Dwt.setLocation(e,c,f);
Dwt.setSize(e,d,a)
};
Dwt.getCursor=function(a){if(!(a=Dwt.getElement(a))){return""
}return DwtCssStyle.getProperty(a,"cursor")
};
Dwt.setCursor=function(c,a){if(!(c=Dwt.getElement(c))){return
}c.style.cursor=a
};
Dwt.getLocation=function(c,a){if(!(c=Dwt.getElement(c))){return null
}a=a||new DwtPoint(0,0);
if(c.style.position==Dwt.ABSOLUTE_STYLE){a.set(parseInt(DwtCssStyle.getProperty(c,"left")),parseInt(DwtCssStyle.getProperty(c,"top")));
return a
}return Dwt.toWindow(c,0,0,null,null,a)
};
Dwt.setLocation=function(d,c,e){if(!(d=Dwt.getElement(d))){return
}var a=DwtCssStyle.getProperty(d,"position");
if(a!=Dwt.ABSOLUTE_STYLE&&a!=Dwt.RELATIVE_STYLE&&a!=Dwt.FIXED_STYLE){throw new DwtException("Static widgets may not be positioned",DwtException.INVALID_OP,"Dwt.setLocation")
}if(c=Dwt.__checkPxVal(c)){d.style.left=c
}if(e=Dwt.__checkPxVal(e)){d.style.top=e
}};
Dwt.getPosition=function(a){if(!(a=Dwt.getElement(a))){return
}return a.style.position
};
Dwt.setPosition=function(c,a){if(!(c=Dwt.getElement(c))){return
}c.style.position=a
};
Dwt.getScrollStyle=function(d){if(!(d=Dwt.getElement(d))){return""
}var e=DwtCssStyle.getProperty(d,"overflow");
if(e=="hidden"){return Dwt.CLIP
}if(e=="auto"){return Dwt.SCROLL
}if(e=="scroll"){return Dwt.FIXED_SCROLL
}if(e==""){var c=DwtCssStyle.getProperty(d,"overflowX");
var a=DwtCssStyle.getProperty(d,"overflowY");
if(c=="scroll"){return Dwt.SCROLL_X
}if(a=="scroll"){return Dwt.SCROLL_Y
}}return Dwt.VISIBLE
};
Dwt.setScrollStyle=function(c,a){if(!(c=Dwt.getElement(c))){return
}if(a==Dwt.CLIP){c.style.overflow="hidden"
}else{if(a==Dwt.SCROLL){c.style.overflow="auto"
}else{if(a==Dwt.FIXED_SCROLL){c.style.overflow="scroll"
}else{if(a==Dwt.SCROLL_Y){c.style.overflowX="hidden";
c.style.overflowY="auto"
}else{if(a==Dwt.SCROLL_X){c.style.overflowY="hidden";
c.style.overflowX="auto"
}else{c.style.overflow="visible"
}}}}}};
Dwt.getSize=function(e,a,c){if(!(e=Dwt.getElement(e))){return
}var d;
if(!a){d=new DwtPoint(0,0)
}else{d=a;
d.set(0,0)
}if(!e){return d
}if(c){if(e.style.width){d.x=parseInt(e.style.width)
}if(e.style.height){d.y=parseInt(e.style.height)
}return d
}d.x=e.offsetWidth;
if(d.x!=null){d.y=e.offsetHeight
}else{if(e.clip&&e.clip.width!=null){d.x=parseInt(e.clip.width);
d.y=parseInt(e.clip.height)
}else{if(e.style&&e.style.pixelWidth!=null){d.x=parseInt(e.style.pixelWidth);
d.y=parseInt(e.style.pixelHeight)
}}}return d
};
Dwt.getOuterSize=function(f,a){var e=Dwt.getSize(f,a);
if(e&&Dwt.getVisible(f)){var d=Dwt.getMargins(f);
var c=Dwt.getInsets(f);
e.x+=d.left+d.right+c.left+c.right;
e.y+=d.top+d.bottom+c.top+c.bottom
}return e
};
Dwt.setSize=function(d,c,a){if(!(d=Dwt.getElement(d))){return
}if(!d.style){return
}if(c==Dwt.CLEAR){d.style.width=null
}else{if(c=Dwt.__checkPxVal(c,true)){d.style.width=c
}}if(a==Dwt.CLEAR){d.style.height=null
}else{if(a=Dwt.__checkPxVal(a,true)){d.style.height=a
}}};
Dwt.getHtmlExtent=function(a){var c=AjxStringUtil.calcDIV();
c.innerHTML=a;
return Dwt.getSize(c)
};
Dwt.toDocumentFragment=function(d,g){var f=AjxStringUtil.calcDIV();
f.innerHTML=d;
var c=document.createDocumentFragment();
var a=g&&document.getElementById(g);
if(a){c.appendChild(a)
}else{for(var e=f.firstChild;
e;
e=f.firstChild){c.appendChild(e)
}}return c
};
Dwt.getAttr=function(d,a,c){if(!c){return d&&d.tagName?(d.getAttribute(a)||d[a]):null
}else{while(d){if(Dwt.getAttr(d,a)!=null){return d
}d=d.parentNode
}return null
}};
Dwt.getVisible=function(c){if(!(c=Dwt.getElement(c))){return
}var a=DwtCssStyle.getProperty(c,"display");
return(a!=Dwt.DISPLAY_NONE)
};
Dwt.setVisible=function(c,d){if(!(c=Dwt.getElement(c))){return
}if(d){if(c.nodeName.match(/tr/i)){c.style.display=Dwt.DISPLAY_TABLE_ROW
}else{if(c.nodeName.match(/td|th/i)){c.style.display=Dwt.DISPLAY_TABLE_CELL
}else{c.style.display=c.getAttribute("x-display")||Dwt.DISPLAY_BLOCK
}}}else{var a=DwtCssStyle.getComputedStyleObject(c).display;
if(a!="none"){c.setAttribute("x-display",a)
}c.style.display=Dwt.DISPLAY_NONE
}};
Dwt.getVisibility=function(c){if(!(c=Dwt.getElement(c))){return
}var a=DwtCssStyle.getProperty(c,"visibility");
return(a=="visible")
};
Dwt.setVisibility=function(a,c){if(!(a=Dwt.getElement(a))){return
}a.style.visibility=c?"visible":"hidden"
};
Dwt.__MSIE_OPACITY_RE=/alpha\(opacity=(\d+)\)/;
Dwt.getOpacity=function(a){if(!(a=Dwt.getElement(a))){return
}return Number(a.style.opacity||1)*100
};
Dwt.setOpacity=function(c,a){if(!(c=Dwt.getElement(c))){return
}c.style.opacity=a/100
};
Dwt.getZIndex=function(c,a){if(!(c=Dwt.getElement(c))){return
}if(a){while(c.style.zIndex===""&&c.parentNode){c=c.parentNode
}return c.style.zIndex
}return DwtCssStyle.getProperty(c,"z-index")
};
Dwt.setZIndex=function(c,a){if(!(c=Dwt.getElement(c))){return
}c.style.zIndex=a;
if(a<Dwt.Z_VIEW){c.setAttribute("aria-hidden",true)
}else{c.removeAttribute("aria-hidden")
}};
Dwt.getDisplay=function(a){DwtCssStyle.getProperty(a,"display")
};
Dwt.setDisplay=function(c,a){if(!(c=Dwt.getElement(c))){return
}c.style.display=a
};
Dwt.getWindowSize=function(a){var c=(!a)?new DwtPoint(0,0):a;
if(window.innerWidth){c.x=window.innerWidth;
c.y=window.innerHeight
}else{if(document.body&&document.body.clientWidth){c.x=document.body.clientWidth;
c.y=document.body.clientHeight
}}return c
};
Dwt.toWindow=function(e,h,g,k,i,j){var c;
if(!j){c=new DwtPoint(h,g)
}else{c=j;
c.set(h,g)
}e=Dwt.getElement(e);
var a=e;
while(a&&a!=k){c.x+=a.offsetLeft-a.scrollLeft;
c.y+=a.offsetTop;
if(!i){var d=AjxEnv.isOpera?a.pageYOffset:a.scrollTop;
if(d){c.y-=d
}var f=a.parentNode;
while(f!=a.offsetParent&&f!=k){d=AjxEnv.isOpera?f.pageYOffset:f.scrollTop;
if(d){c.y-=d
}f=f.parentNode
}}a=a.offsetParent
}return c
};
Dwt.getInsets=function(e){if(!(e=Dwt.getElement(e))){return
}var c=DwtCssStyle.getComputedStyleObject(e);
var d=parseInt(c.borderLeftWidth)||0;
var i=parseInt(c.borderTopWidth)||0;
var j=parseInt(c.borderRightWidth)||0;
var g=parseInt(c.borderBottomWidth)||0;
var f=parseInt(c.paddingLeft)||0;
var k=parseInt(c.paddingTop)||0;
var a=parseInt(c.paddingRight)||0;
var h=parseInt(c.paddingBottom)||0;
return{left:d+f,top:i+k,right:j+a,bottom:g+h}
};
Dwt.insetBounds=function(c,a){if(!c){return null
}c.x+=a.left;
c.y+=a.top;
c.width-=a.left+a.right;
c.height-=a.top+a.bottom;
return c
};
Dwt.getInsetBounds=function(d){if(!(d=Dwt.getElement(d))){return
}var c=Dwt.getBounds(d);
var a=Dwt.getInsets(d);
return Dwt.insetBounds(c,a)
};
Dwt.getMargins=function(c){if(!(c=Dwt.getElement(c))){return
}var a=DwtCssStyle.getComputedStyleObject(c);
return{left:parseInt(a.marginLeft)||0,top:parseInt(a.marginTop)||0,right:parseInt(a.marginRight)||0,bottom:parseInt(a.marginBottom)||0}
};
Dwt.getAncestors=function(d,a,c){var e=[];
if(!a){a=document.documentElement
}if(c){e.push(d)
}while(d&&d!=a){e.push(d.parentNode);
d=d.parentNode
}if(e[e.length-1]!=a){return null
}return e
};
Dwt.setStatus=function(a){window.status=a
};
Dwt.getTitle=function(){return window.document.title
};
Dwt.setTitle=function(a){window.document.title=a
};
Dwt.getIframeDoc=function(a){if(a){return a.contentDocument
}return null
};
Dwt.getIframeWindow=function(a){return a.contentWindow
};
Dwt.parseHtmlFragment=function(e,d){if(!Dwt._div){Dwt._div=document.createElement("div")
}if(d){e="<table style='table-layout:fixed'>"+e+"</table>"
}Dwt._div.innerHTML=e;
if(d){var a=document.createDocumentFragment();
var f=Dwt._div.firstChild.rows;
for(var c=f.length-1;
c>=0;
c--){a.appendChild(f[0])
}return a.childNodes.length>1?a:a.firstChild
}return Dwt._div.firstChild
};
Dwt.contains=function(d,c){var e=false;
if(d.compareDocumentPosition){var a=d.compareDocumentPosition(c);
if((a==(document.DOCUMENT_POSITION_CONTAINED_BY|document.DOCUMENT_POSITION_FOLLOWING))){e=true
}}else{if(d.contains){e=d.contains(c)
}}return e
};
Dwt.removeChildren=function(a){while(a.hasChildNodes()){a.removeChild(a.firstChild)
}};
Dwt.getCellIndex=function(c){if(AjxEnv.isOpera){if(c.tagName&&c.tagName.toLowerCase()=="td"){var d=c.parentNode.cells;
var a=d.length;
for(var e=0;
e<a;
e++){if(d[e]==c){return e
}}}}else{return c.cellIndex
}return -1
};
Dwt.delClass=function(d,a,e){if(d==null){return
}if(!a&&!e){return
}if(typeof a=="string"&&a.length){a=Dwt._DELCLASS_CACHE[a]||(Dwt._DELCLASS_CACHE[a]=new RegExp("\\b"+a+"\\b","ig"))
}var c=d.className||"";
c=c.replace(a," ");
c=AjxStringUtil.trim(c);
d.className=e?c+" "+e:c
};
Dwt._DELCLASS_CACHE={};
Dwt.addClass=function(a,d){Dwt.delClass(a,d,d)
};
Dwt.condClass=function(e,f,d,c){if(!!f){if(c){Dwt.delClass(e,c)
}Dwt.addClass(e,d)
}else{Dwt.delClass(e,d);
if(c){Dwt.addClass(e,c)
}}};
Dwt.hasClass=function(c,a){if(!c||!a){return false
}return c.className.match(new RegExp("\\b"+a+"\\b"))
};
Dwt.setSelectionRange=function(d,e,a){if(d.setSelectionRange){d.focus();
d.setSelectionRange(e,a)
}else{if(d.createTextRange){var c=d.createTextRange();
c.collapse(true);
c.moveStart("character",e);
c.moveEnd("character",a-e);
c.select()
}else{if(d.select){d.select()
}}}};
Dwt.getSelectionStart=function(e){if(AjxUtil.isSpecified(e.selectionStart)){return e.selectionStart
}else{if(document.selection){var d=document.selection.createRange();
var c=d.compareEndPoints("StartToEnd",d)==0;
if(!c){d.collapse(true)
}var a=d.getBookmark();
var f=e.createTextRange().getBookmark().charCodeAt(2);
return Math.max(a.charCodeAt(2)-f,0)
}}return e.value.length
};
Dwt.getSelectionEnd=function(e){if(AjxUtil.isSpecified(e.selectionEnd)){return e.selectionEnd
}else{if(document.selection){var d=document.selection.createRange();
var c=d.compareEndPoints("StartToEnd",d)==0;
if(!c){d.collapse(false)
}var a=d.getBookmark();
var f=e.createTextRange().getBookmark().charCodeAt(2);
return Math.max(a.charCodeAt(2)-f,0)
}}return e.value.length
};
Dwt.setSelectionText=function(c,f){var g=Dwt.getSelectionStart(c);
var a=Dwt.getSelectionEnd(c);
var e=c.value;
var d=[e.substr(0,g),f,e.substr(a)].join("");
if(typeof c.setValue=="function"){c.setValue(d)
}else{c.value=d
}Dwt.setSelectionRange(c,g,g+f.length)
};
Dwt.moveCursorToEnd=function(a){Dwt.setSelectionRange(a,a.value.length,a.value.length)
};
Dwt.instanceOf=function(c,a){if(typeof c=="string"){return window[c]&&(c==a||window[c].prototype instanceof window[a])
}return(window[a]&&c instanceof window[a])
};
Dwt.getParams=function(a,e){if(!a||a.length===0||(a.length===1&&!a[0])){return{}
}if(a.length>1||!AjxUtil.isHash(a[0]._object_||a[0])){var d={};
for(var c=0;
c<a.length;
c++){d[e[c]]=a[c]
}return d
}if(a.length===1){return a[0]
}return{}
};
Dwt.__REM_RE=/^(-?[0-9]+(?:\.[0-9]*)?)rem$/;
Dwt.__checkPxVal=function(c,a){if(c==Dwt.DEFAULT){return false
}if(isNaN(parseInt(c))){return false
}if(a&&c<0&&c!=Dwt.LOC_NOWHERE){c=0
}if(typeof(c)=="number"){c=c+"px"
}if(!AjxEnv.supportsCSS3RemUnits&&Dwt.__REM_RE.test(c)){c=DwtCssStyle.asPixelCount(c)+"px"
}return c
};
Dwt.byId=function(e,c){if(!c){return(typeof e=="string"?document.getElementById(e):e)
}if(c==e||c.id==e){return c
}for(var a=0;
a<c.childNodes.length;
a++){if(c.childNodes[a].nodeType==1){var d=Dwt.byId(e,c.childNodes[a]);
if(d){return d
}}}return null
};
Dwt.byTag=function(c,a){if(!a){a=document
}return AjxUtil.toArray(a.getElementsByTagName(c))
};
Dwt.byClassName=function(d,c){if(!c){c=document
}var a;
if(c.getElementsByClassName){a=c.getElementsByClassName(d)
}else{a=c.querySelectorAll("."+d)
}return AjxUtil.toArray(a)
};
Dwt.show=function(c){var a=Dwt.byId(c);
if(a){Dwt.setVisible(a,true)
}};
Dwt.hide=function(c){var a=Dwt.byId(c);
if(a){Dwt.setVisible(a,false)
}};
Dwt.setText=function(a,c){a.appendChild(document.createTextNode(c))
};
Dwt.populateText=function(){if(arguments.length==0){return
}var d,a=0,c=arguments.length;
while(a<c){d=document.getElementById(arguments[a]);
if(d){Dwt.setText(d,arguments[a+1])
}a+=2
}};
Dwt.setInnerHtml=function(c,a){c.innerHTML=a
};
Dwt.setFavIcon=function(h){var a=null;
if(Dwt._favIconId){a=document.getElementById(Dwt._favIconId)
}else{var j=document.getElementsByTagName("head")[0];
var c=j.getElementsByTagName("link");
for(var e=0;
e<c.length;
e++){var g=c[e];
if(g.rel.toUpperCase()=="SHORTCUT ICON"){if(!g.id){g.id=Dwt._favIconId=Dwt.getNextId()
}a=g;
break
}}}if(a){a.href=h;
a.type="image/x-icon";
var f=a.parentNode;
f.removeChild(a);
f.appendChild(a)
}else{var d=document.createElement("link");
d.id=Dwt._favIconId=Dwt.getNextId();
d.rel="SHORTCUT ICON";
d.href=h;
d.type="image/x-icon";
j=j||document.getElementsByTagName("head")[0];
j.appendChild(d)
}};
Dwt.enableDesignMode=function(d,a){if(!AjxEnv.isIE){d.designMode=a?"on":"off"
}else{var c=d.body;
if(!c||c.contentEditable===undefined){d.designMode=a?"on":"off"
}else{c.contentEditable=a?true:false
}}};
Dwt.ffScrollbarCheck=function(c){if(AjxEnv.isFirefox3_6up||AjxEnv.isDesktop2up){var a=c.target;
if(a&&(a.clientHeight&&a.scrollHeight&&(a.clientHeight!=a.scrollHeight))||(a.clientWidth&&a.scrollWidth&&(a.clientWidth!=a.scrollWidth))){c._dontCallPreventDefault=true;
c._stopPropagation=false;
c._returnValue=true;
return true
}}return false
};
Dwt.selectText=function(c){if(!c){Dwt.deselectText();
return
}if(document.selection){var a=c.parentTextEdit.createTextRange();
a.moveToElementText(c);
a.select()
}else{if(window.getSelection){var a=document.createRange();
a.selectNode(c);
var d=window.getSelection();
d.addRange(a)
}}};
Dwt.deselectText=function(){if(document.selection){document.selection.empty()
}else{if(window.getSelection){window.getSelection().removeAllRanges()
}}};
Dwt.insertText=function(c,e){if(!c||!e){return
}if(document.selection){c.focus();
var d=document.selection.createRange();
d.text=e;
c.focus()
}else{if(AjxUtil.isSpecified(c.selectionStart)){var f=c.selectionStart,a=c.selectionEnd;
c.value=c.value.substring(0,f)+e+c.value.substring(a,c.value.length);
c.selectionStart=f+e.length;
c.selectionEnd=a+e.length
}else{c.value+=e
}}};
Dwt.doOverlap=function(g,f){if(!g||!f){return false
}var i=Dwt.getLocation(g),h=Dwt.getLocation(f);
var m=Dwt.getSize(g),l=Dwt.getSize(f);
var o=i.x,n=h.x,k=i.y,j=h.y;
var e=o+m.x,c=n+l.x;
var d=k+m.y,a=j+l.y;
return !(o>c||e<n||k>a||d<j)
};
Dwt.scrollIntoView=function(d,c){if(!d||!c){return
}var a=Dwt.toWindow(d,0,0,null,null,DwtPoint.tmp).y;
var h=Dwt.toWindow(c,0,0,null,null,DwtPoint.tmp).y+c.scrollTop;
var g=a-h;
if(g<0){c.scrollTop+=g
}else{var f=Dwt.getSize(c,DwtPoint.tmp).y;
var e=Dwt.getSize(d,DwtPoint.tmp).y;
g=(a+e)-(h+f);
if(g>0){c.scrollTop+=g
}}};
Dwt.setLoadingTime=function(d,a){if(!window.isPerfMetric){return
}a=a||new Date();
d+="_loading";
var c=document.getElementById(d);
if(!c){c=document.createElement("div");
c.id=d;
c.style.display="none";
document.body.appendChild(c)
}c.innerHTML=a.getTime();
if(window.appDevMode){console.profile(d)
}};
Dwt.setLoadedTime=function(d,a){if(!window.isPerfMetric){return
}a=a||new Date();
d+="_loaded";
var c=document.getElementById(d);
if(!c){c=document.createElement("div");
c.id=d;
c.style.display="none";
document.body.appendChild(c)
}c.innerHTML=a.getTime();
if(window.appDevMode){console.profileEnd()
}};
Dwt.printPerfMetric=function(){$.each($('div[id*="_loaded"]'),function(d,g){var a=$(g).attr("id");
var h=a.substring(0,a.indexOf("_"));
var c=$("#"+h+"_launched");
if(c&&c.length>0){var e=$("#"+h+"_launched").html()
}else{e=$("#"+h+"_loading").html()
}var f="Load time for "+h+" is "+($(g).html()-e);
if(console){console.log(f)
}})
};
Dwt.createLinearGradientCss=function(f,c,e){var a=null;
var d=this.createLinearGradientInfo(f,c,e);
if(d.field){a=d.field+":"+d.css+";"
}return a
};
Dwt.createLinearGradientInfo=function(g,d,i){var h;
var j={};
if(AjxEnv.isIE9){var e={x1:"0%",x2:i=="v"?"0%":"100%",y1:"0%",y2:i=="v"?"100%":"0%",startColor:g,endColor:d};
var a=AjxTemplate.expand("dwt.Widgets#SVGGradient",e);
j.field="background";
j.css=("url(data:image/svg+xml,"+escape(a.replace(/\s+/g," "))+")")
}else{if(AjxEnv.isFirefox3_6up){h=(i=="v")?"top":"left";
j.field="background";
j.css="-moz-linear-gradient("+h+","+g+", "+d+")"
}else{if((AjxEnv.isSafari&&AjxEnv.isSafari5_1up)||AjxEnv.isChrome10up){h=(i=="v")?"top":"left";
j.field="background";
j.css="-webkit-linear-gradient("+h+","+g+", "+d+")"
}else{if((AjxEnv.isSafari&&AjxEnv.isSafari4up)||AjxEnv.isChrome2up){var c="left top";
var f=(i=="v")?"left bottom":"right top";
j.field="background";
j.css="-webkit-gradient(linear, "+c+", "+f+", color-stop(0%, "+g+"), color-stop(100%, "+d+"))"
}else{h=(i=="v")?"to bottom":"to right";
j.field="background";
j.css="linear-gradient("+h+","+g+", "+d+")"
}}}}return j
};
Dwt.getDescendant=function(d,f){var c=null;
for(var a=0;
a<d.childNodes.length;
a++){var e=d.childNodes[a];
if(e.id==f){c=e
}else{c=Dwt.getDescendant(e,f)
}if(c!=null){break
}}return c
};
Dwt.getPreviousElementSibling=function(a){var c=a.previousElementSibling;
if(c!==undefined){return c
}for(c=a.previousSibling;
c&&c.nodeType!==1;
c=c.previousSibling){}return c
};
Dwt.getNextElementSibling=function(a){var c=a.nextElementSibling;
if(c!==undefined){return c
}for(c=a.nextSibling;
c&&c.nodeType!==1;
c=c.nextSibling){}return c
};
Dwt.getScrollbarSizes=function(e){var f=Dwt.getInsets(e);
var a=DwtCssStyle.getComputedStyleObject(e);
var d=parseInt(a.borderLeftWidth)||0;
var h=parseInt(a.borderTopWidth)||0;
var j=parseInt(a.borderRightWidth)||0;
var g=parseInt(a.borderBottomWidth)||0;
var c=e.offsetWidth-e.clientWidth-d-j;
var i=e.offsetHeight-e.clientHeight-h-g;
return new DwtPoint(c,i)
}
}if(AjxPackage.define("ajax.dwt.core.DwtDraggable")){DwtDraggable=function(){};
DwtDraggable.dragEl=null;
DwtDraggable.init=function(e,n,g,c,f,a,i,l,m,j,h,k,d){e.onmousedown=DwtDraggable.__start;
e.__hMode=j?false:true;
e.__vMode=h?false:true;
e.__root=(n&&n!=null)?n:e;
if(e.__hMode&&isNaN(parseInt(e.__root.style.left))){e.__root.style.left="0px"
}if(e.__vMode&&isNaN(parseInt(e.__root.style.top))){e.__root.style.top="0px"
}if(!e.__hMode&&isNaN(parseInt(e.__root.style.right))){e.__root.style.right="0px"
}if(!e.__vMode&&isNaN(parseInt(e.__root.style.bottom))){e.__root.style.bottom="0px"
}e.__minX=(typeof g!="undefined")?g:null;
e.__minY=(typeof f!="undefined")?f:null;
e.__maxX=(typeof c!="undefined")?c:null;
e.__maxY=(typeof a!="undefined")?a:null;
e.__xMapper=k?k:null;
e.__yMapper=d?d:null;
e.__root.onDragStart=i;
e.__root.onDragEnd=m;
e.__root.onDrag=l
};
DwtDraggable.setDragBoundaries=function(c,a,e,f,d){if(c!=null){if(a!=null){c.__minX=a
}if(e!=null){c.__maxX=e
}if(f!=null){c.__minY=f
}if(d!=null){c.__maxY=d
}}};
DwtDraggable.__start=function(d){var c=DwtDraggable.dragEl=this;
d=DwtDraggable.__fixE(d);
var a=parseInt(c.__hMode?c.__root.style.left:c.__root.style.right);
var f=parseInt(c.__vMode?c.__root.style.top:c.__root.style.bottom);
if(c.__root.onDragStart){c.__root.onDragStart.run([a,f])
}c.__lastMouseX=d.clientX;
c.__lastMouseY=d.clientY;
if(c.__hMode){if(c.__minX!=null){c.__minMouseX=d.clientX-a+c.__minX
}if(c.__maxX!=null){c.__maxMouseX=c.__minMouseX+c.__maxX-c.__minX
}}else{if(c.__minX!=null){c.__maxMouseX=-c.__minX+d.clientX+a
}if(c.__maxX!=null){c.__minMouseX=-c.__maxX+d.clientX+a
}}if(c.__vMode){if(c.__minY!=null){c.__minMouseY=d.clientY-f+c.__minY
}if(c.__maxY!=null){c.__maxMouseY=c.__minMouseY+c.__maxY-c.__minY
}}else{if(c.__minY!=null){c.__maxMouseY=-c.__minY+d.clientY+f
}if(c.__maxY!=null){c.__minMouseY=-c.__maxY+d.clientY+f
}}document.onmousemove=DwtDraggable.__drag;
document.onmouseup=DwtDraggable.__end;
return false
};
DwtDraggable.__drag=function(h){h=DwtDraggable.__fixE(h);
var d=DwtDraggable.dragEl;
var f=h.clientY;
var g=h.clientX;
var c=parseInt(d.__hMode?d.__root.style.left:d.__root.style.right);
var j=parseInt(d.__vMode?d.__root.style.top:d.__root.style.bottom);
var a,i;
if(!d.__xMapper){if(d.__minX!=null){g=d.__hMode?Math.max(g,d.__minMouseX):Math.min(g,d.__maxMouseX)
}if(d.__maxX!=null){g=d.__hMode?Math.min(g,d.__maxMouseX):Math.max(g,d.__minMouseX)
}a=c+((g-d.__lastMouseX)*(d.__hMode?1:-1))
}else{a=d.__xMapper(c,g)
}if(!d.__yMapper){if(d.__minY!=null){f=d.__vMode?Math.max(f,d.__minMouseY):Math.min(f,d.__maxMouseY)
}if(d.__maxY!=null){f=d.__vMode?Math.min(f,d.__maxMouseY):Math.max(f,d.__minMouseY)
}i=j+((f-d.__lastMouseY)*(d.__vMode?1:-1))
}else{i=d.__yMapper(j,f)
}DwtDraggable.dragEl.__root.style[d.__hMode?"left":"right"]=a+"px";
DwtDraggable.dragEl.__root.style[d.__vMode?"top":"bottom"]=i+"px";
DwtDraggable.dragEl.__lastMouseX=g;
DwtDraggable.dragEl.__lastMouseY=f;
if(DwtDraggable.dragEl.__root.onDrag){DwtDraggable.dragEl.__root.onDrag.run([a,i])
}return false
};
DwtDraggable.__end=function(){document.onmousemove=null;
document.onmouseup=null;
if(DwtDraggable.dragEl.__root.onDragEnd){DwtDraggable.dragEl.__root.onDragEnd.run([parseInt(DwtDraggable.dragEl.__root.style[DwtDraggable.dragEl.__hMode?"left":"right"]),parseInt(DwtDraggable.dragEl.__root.style[DwtDraggable.dragEl.__vMode?"top":"bottom"])])
}DwtDraggable.dragEl=null
};
DwtDraggable.__fixE=function(a){if(typeof a=="undefined"){a=window.event
}if(!AjxEnv.isWebKitBased){if(typeof a.layerX=="undefined"){a.layerX=a.offsetX
}if(typeof a.layerY=="undefined"){a.layerY=a.offsetY
}}return a
}
}if(AjxPackage.define("ajax.dwt.events.DwtEvent")){DwtEvent=function(a){if(arguments.length==0){return
}this.dwtObj=null
};
DwtEvent.prototype.toString=function(){return"DwtEvent"
};
DwtEvent.ONCHANGE="onchange";
DwtEvent.ONCLICK="onclick";
DwtEvent.ONCONTEXTMENU="oncontextmenu";
DwtEvent.ONDBLCLICK="ondblclick";
DwtEvent.ONFOCUS="onfocus";
DwtEvent.ONBLUR="onblur";
DwtEvent.ONKEYDOWN="onkeydown";
DwtEvent.ONKEYPRESS="onkeypress";
DwtEvent.ONKEYUP="onkeyup";
DwtEvent.ONMOUSEDOWN="onmousedown";
DwtEvent.ONMOUSEENTER="onmouseenter";
DwtEvent.ONMOUSELEAVE="onmouseleave";
DwtEvent.ONMOUSEMOVE="onmousemove";
DwtEvent.ONMOUSEOUT="onmouseout";
DwtEvent.ONMOUSEOVER="onmouseover";
DwtEvent.ONMOUSEUP="onmouseup";
DwtEvent.ONMOUSEWHEEL="onmousewheel";
DwtEvent.ONSELECTSTART="onselectstart";
DwtEvent.ONSCROLL="onscroll";
DwtEvent.ONPASTE="onpaste";
DwtEvent.ONCUT="oncut";
DwtEvent.ONINPUT="oninput";
DwtEvent.ACTION="ACTION";
DwtEvent.CONTROL="CONTROL";
DwtEvent.DATE_RANGE="DATE_RANGE";
DwtEvent.DISPOSE="DISPOSE";
DwtEvent.ENTER="ENTER";
DwtEvent.HOVEROVER="HOVEROVER";
DwtEvent.HOVEROUT="HOVEROUT";
DwtEvent.POPDOWN="POPDOWN";
DwtEvent.POPUP="POPUP";
DwtEvent.SELECTION="SELECTION";
DwtEvent.TREE="TREE";
DwtEvent.STATE_CHANGE="STATE_CHANGE";
DwtEvent.TAB="TAB";
DwtEvent.XFORMS_READY="xforms-ready";
DwtEvent.XFORMS_DISPLAY_UPDATED="xforms-display-updated";
DwtEvent.XFORMS_VALUE_CHANGED="xforms-value-changed";
DwtEvent.XFORMS_FORM_DIRTY_CHANGE="xforms-form-dirty-change";
DwtEvent.XFORMS_CHOICES_CHANGED="xforms-choices-changed";
DwtEvent.XFORMS_VALUE_ERROR="xforms-value-error";
DwtEvent.XFORMS_INSTANCE_CHANGED="xforms-instance-cahnged";
DwtEvent.KEY_EVENTS=[DwtEvent.ONKEYDOWN,DwtEvent.ONKEYPRESS,DwtEvent.ONKEYUP];
DwtEvent.MOUSE_EVENTS=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]
}if(AjxPackage.define("ajax.dwt.events.DwtControlEvent")){DwtControlEvent=function(){this.reset()
};
DwtControlEvent.prototype=new DwtEvent;
DwtControlEvent.prototype.constructor=DwtControlEvent;
DwtControlEvent.RESIZE=1;
DwtControlEvent.MOVE=2;
DwtControlEvent.STATE=4;
DwtControlEvent.prototype.toString=function(){return"DwtControlEvent"
};
DwtControlEvent.prototype.reset=function(a){this.oldX=Dwt.DEFAULT;
this.oldY=Dwt.DEFAULT;
this.oldWidth=Dwt.DEFAULT;
this.oldHeight=Dwt.DEFAULT;
this.oldState=null;
this.newX=Dwt.DEFAULT;
this.newY=Dwt.DEFAULT;
this.newWidth=Dwt.DEFAULT;
this.newHeight=Dwt.DEFAULT;
this.newState=null;
this.type=a||null
}
}if(AjxPackage.define("ajax.dwt.events.DwtUiEvent")){DwtUiEvent=function(a){if(arguments.length==0){return
}DwtEvent.call(this,true);
this.reset()
};
DwtUiEvent.prototype=new DwtEvent;
DwtUiEvent.prototype.constructor=DwtUiEvent;
DwtUiEvent.prototype.isDwtUiEvent=true;
DwtUiEvent.prototype.toString=function(){return"DwtUiEvent"
};
DwtUiEvent.prototype.reset=function(){this.dwtObj=null;
this.altKey=false;
this.ctrlKey=false;
this.metaKey=false;
this.shiftKey=false;
this.target=null;
this.type=null;
this.docX=-1;
this.docY=-1;
this.elementX=-1;
this.elementY=-1;
this.ersatz=false;
this._stopPropagation=false;
this._returnValue=true;
this._dontCallPreventDefault=false
};
DwtUiEvent.getEvent=function(c,d){c=c||window.event;
if(c){return c
}if(d){var a=(d.ownerDocument||d.document||d).parentWindow;
return a?a.event:null
}};
DwtUiEvent.getTarget=function(a,c){a=DwtUiEvent.getEvent(a);
if(!a){return null
}if(!c){if(a.target){return(a.target.nodeType==3)?a.target.parentNode:a.target
}else{if(a.srcElement){return a.srcElement
}}}else{if(a.relatedTarget){return a.relatedTarget
}else{if(a.toElement){return a.toElement
}else{if(a.fromElement){return a.fromElement
}}}}return null
};
DwtUiEvent.getTargetWithProp=function(c,g,f,e){var d=DwtUiEvent.getTarget(c,f);
while(d){var a=Dwt.getAttr(d,g);
if(a!=null&&a!==""&&(!e||(a==e))){return d
}d=d.parentNode
}return null
};
DwtUiEvent.getTargetWithClass=function(c,a,e){var d=DwtUiEvent.getTarget(c,e);
while(d&&d.nodeType===1){if(Dwt.hasClass(d,a)){return d
}d=d.parentNode
}return null
};
DwtUiEvent.getTargetWithProps=function(e,d){var f=DwtUiEvent.getTarget(e);
while(f){var c=true;
for(var a in d){var g=Dwt.getAttr(f,d[a]);
if(g==null||g===""){f=f.parentNode;
c=false;
break
}}if(c){return f
}}return null
};
DwtUiEvent.copy=function(a,c){a.altKey=c.altKey;
a.ctrlKey=c.ctrlKey;
a.metaKey=c.metaKey;
a.shiftKey=c.shiftKey;
a.target=c.target;
a.type=c.type;
a.dwtObj=c.dwtObj;
a.docX=c.docX;
a.docY=c.docY;
a.elementX=c.elementX;
a.elementY=c.elementY;
a.ersatz=c.ersatz;
a._stopPropagation=c._stopPropagation;
a._returnValue=c._returnValue
};
DwtUiEvent.prototype.setFromDhtmlEvent=function(c,d){c=DwtUiEvent.getEvent(c);
if(!c){return
}this.altKey=c.altKey;
this.ctrlKey=c.ctrlKey;
this.metaKey=c.metaKey;
this.shiftKey=c.shiftKey;
this.type=c.type;
this.target=DwtUiEvent.getTarget(c);
this.dwtObj=(d===true)?DwtControl.getTargetControl(c):d;
if(c.pageX!=null){this.docX=c.pageX;
this.docY=c.pageY
}else{if(c.clientX!=null){this.docX=c.clientX+document.body.scrollLeft-document.body.clientLeft;
this.docY=c.clientY+document.body.scrollTop-document.body.clientTop;
if(document.body.parentElement){var a=document.body.parentElement;
this.docX+=a.scrollLeft-a.clientLeft;
this.docY+=a.scrollTop-a.clientTop
}}}if(c.offsetX!=null){this.elementX=c.offsetX;
this.elementY=c.offsetY
}else{if(!AjxEnv.isWebKitBased&&c.layerX!=null){this.elementX=c.layerX;
this.elementY=c.layerY
}else{this.elementX=Dwt.DEFAULT;
this.elementY=Dwt.DEFAULT
}}this.ersatz=false;
return c
};
DwtUiEvent.prototype.setToDhtmlEvent=function(a){DwtUiEvent.setBehaviour(a,this._stopPropagation,this._returnValue,this._dontCallPreventDefault)
};
DwtUiEvent.setBehaviour=function(f,a,c,d){var e=DwtUiEvent.getEvent(f);
DwtUiEvent.setDhtmlBehaviour(e,a,c,d)
};
DwtUiEvent.setDhtmlBehaviour=function(e,a,c,d){e=DwtUiEvent.getEvent(e);
if(!e){return
}if(e.stopPropagation!=null){if(a){e.stopPropagation()
}if(!c&&!d){e.preventDefault()
}}else{e.returnValue=c;
e.cancelBubble=a
}};
DwtUiEvent.getDwtObjFromEvent=function(a,d){var c=DwtUiEvent.getTargetWithProp(a,"dwtObj",d);
return c?Dwt.getObjectFromElement(c):null
};
DwtUiEvent.getDwtObjWithProp=function(a,d){var c=DwtUiEvent.getTargetWithProps(a,["dwtObj",d]);
return c?Dwt.getObjectFromElement(c):null
}
}if(AjxPackage.define("ajax.dwt.events.DwtFocusEvent")){DwtFocusEvent=function(a){if(arguments.length==0){return
}DwtEvent.call(this,true);
this.reset()
};
DwtFocusEvent.prototype=new DwtEvent;
DwtFocusEvent.prototype.constructor=DwtFocusEvent;
DwtFocusEvent.FOCUS=1;
DwtFocusEvent.BLUR=2;
DwtFocusEvent.prototype.toString=function(){return"DwtFocusEvent"
};
DwtFocusEvent.prototype.reset=function(){this.dwtObj=null;
this.state=DwtFocusEvent.FOCUS
}
}if(AjxPackage.define("ajax.dwt.events.DwtKeyEvent")){DwtKeyEvent=function(){DwtUiEvent.call(this,true);
this.reset(true)
};
DwtKeyEvent.prototype.toString=function(){return"DwtKeyEvent"
};
DwtKeyEvent.prototype.isDwtKeyEvent=true;
DwtKeyEvent.KEY_END_OF_TEXT=3;
DwtKeyEvent.KEY_BACKSPACE=8;
DwtKeyEvent.KEY_TAB=9;
DwtKeyEvent.KEY_RETURN=13;
DwtKeyEvent.KEY_ENTER=DwtKeyEvent.KEY_RETURN;
DwtKeyEvent.KEY_ESCAPE=27;
DwtKeyEvent.KEY_SPACE=32;
DwtKeyEvent.KEY_ARROW_LEFT=37;
DwtKeyEvent.KEY_ARROW_UP=38;
DwtKeyEvent.KEY_ARROW_RIGHT=39;
DwtKeyEvent.KEY_ARROW_DOWN=40;
DwtKeyEvent.KEY_DELETE=46;
DwtKeyEvent.KEY_SEMICOLON=59;
DwtKeyEvent.KEY_SEMICOLON_1=186;
DwtKeyEvent.KEY_COMMA=188;
DwtKeyEvent.KEY_COMMAND=224;
DwtKeyEvent.IS_RETURN={};
DwtKeyEvent.IS_RETURN[DwtKeyEvent.KEY_END_OF_TEXT]=true;
DwtKeyEvent.IS_RETURN[DwtKeyEvent.KEY_RETURN]=true;
DwtKeyEvent.MAC_FF_CODE={};
DwtKeyEvent.MAC_FF_CODE["~"]=192;
DwtKeyEvent.MAC_FF_CODE["!"]=49;
DwtKeyEvent.MAC_FF_CODE["@"]=50;
DwtKeyEvent.MAC_FF_CODE["#"]=51;
DwtKeyEvent.MAC_FF_CODE["$"]=52;
DwtKeyEvent.MAC_FF_CODE["%"]=53;
DwtKeyEvent.MAC_FF_CODE["^"]=54;
DwtKeyEvent.MAC_FF_CODE["&"]=55;
DwtKeyEvent.MAC_FF_CODE["*"]=56;
DwtKeyEvent.MAC_FF_CODE["("]=57;
DwtKeyEvent.MAC_FF_CODE[")"]=48;
DwtKeyEvent.MAC_FF_CODE["-"]=189;
DwtKeyEvent.MAC_FF_CODE._=189;
DwtKeyEvent.MAC_FF_CODE["+"]=187;
DwtKeyEvent.MAC_FF_CODE["|"]=220;
DwtKeyEvent.MAC_FF_CODE[":"]=186;
DwtKeyEvent.MAC_FF_CODE["<"]=188;
DwtKeyEvent.MAC_FF_CODE[">"]=190;
DwtKeyEvent.MAC_FF_CODE["?"]=191;
DwtKeyEvent.prototype=new DwtUiEvent;
DwtKeyEvent.prototype.constructor=DwtKeyEvent;
DwtKeyEvent.isKeyEvent=function(a){return a.type&&a.type.search(/^key/i)!=-1
};
DwtKeyEvent.isKeyPressEvent=function(a){return(AjxEnv.isIE&&a.type=="keydown")||(a.type=="keypress")
};
DwtKeyEvent.prototype.reset=function(a){if(!a){DwtUiEvent.prototype.reset.call(this)
}this.keyCode=0;
this.charCode=0
};
DwtKeyEvent.prototype.isCommand=function(a){return AjxEnv.isMac&&this.metaKey||this.ctrlKey
};
DwtKeyEvent.prototype.setFromDhtmlEvent=function(a,c){a=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
if(!a){return
}this.charCode=a.charCode||a.keyCode;
this.keyCode=a.keyCode
};
DwtKeyEvent.getCharCode=function(c){c=DwtUiEvent.getEvent(c);
var a=AjxEnv.isSafari?c.keyCode:(c.charCode||c.keyCode);
if(a==0&&AjxEnv.isMac&&AjxEnv.isGeckoBased&&c.type=="keyup"&&DwtKeyEvent._geckoCode){a=DwtKeyEvent._geckoCode;
DwtKeyEvent._geckoCode=null
}return a
};
DwtKeyEvent.copy=function(a,c){DwtUiEvent.copy(a,c);
a.charCode=c.charCode;
a.keyCode=c.keyCode
};
DwtKeyEvent.geckoCheck=function(c){c=DwtUiEvent.getEvent(c);
if(c.type=="keypress"){DwtKeyEvent._geckoCode=null;
if(AjxEnv.isMac&&AjxEnv.isGeckoBased){var a=String.fromCharCode(c.charCode);
DwtKeyEvent._geckoCode=DwtKeyEvent.MAC_FF_CODE[a]
}}}
}if(AjxPackage.define("ajax.dwt.events.DwtMouseEvent")){DwtMouseEvent=function(){DwtUiEvent.call(this,true);
this.reset(true)
};
DwtMouseEvent.prototype=new DwtUiEvent;
DwtMouseEvent.prototype.constructor=DwtMouseEvent;
DwtMouseEvent.prototype.toString=function(){return"DwtMouseEvent"
};
DwtMouseEvent.NONE=0;
DwtMouseEvent.LEFT=1;
DwtMouseEvent.MIDDLE=2;
DwtMouseEvent.RIGHT=3;
DwtMouseEvent.prototype.reset=function(a){if(!a){DwtUiEvent.prototype.reset.call(this)
}this.button=0
};
DwtMouseEvent.prototype.setFromDhtmlEvent=function(a,c){a=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
if(!a){return
}if(a.which){switch(a.which){case 1:this.button=DwtMouseEvent.LEFT;
break;
case 2:this.button=DwtMouseEvent.MIDDLE;
break;
case 3:this.button=DwtMouseEvent.RIGHT;
break;
default:this.button=DwtMouseEvent.NONE
}}else{if(a.button){if((a.button&1)!=0){this.button=DwtMouseEvent.LEFT
}else{if((a.button&2)!=0){this.button=DwtMouseEvent.RIGHT
}else{if((a.button&4)!=0){this.button=DwtMouseEvent.MIDDLE
}else{this.button=DwtMouseEvent.NONE
}}}}}if(AjxEnv.isMac&&this.button){if(this.ctrlKey&&(this.button==DwtMouseEvent.LEFT||this.button==DwtMouseEvent.RIGHT)){this.button=DwtMouseEvent.RIGHT;
this.ctrlKey=false
}if(this.altKey){this.ctrlKey=true;
this.altKey=false
}}}
}if(AjxPackage.define("ajax.dwt.events.DwtSelectionEvent")){DwtSelectionEvent=function(a){if(arguments.length==0){return
}DwtUiEvent.call(this,true);
this.reset(true)
};
DwtSelectionEvent.prototype=new DwtUiEvent;
DwtSelectionEvent.prototype.constructor=DwtSelectionEvent;
DwtSelectionEvent.prototype.toString=function(){return"DwtSelectionEvent"
};
DwtSelectionEvent.prototype.reset=function(a){if(!a){DwtUiEvent.prototype.reset.call(this)
}this.button=0;
this.detail=null;
this.item=null
}
}if(AjxPackage.define("ajax.dwt.events.DwtTreeEvent")){DwtTreeEvent=function(){DwtSelectionEvent.call(this,true)
};
DwtTreeEvent.prototype=new DwtSelectionEvent;
DwtTreeEvent.prototype.constructor=DwtTreeEvent;
DwtTreeEvent.prototype.toString=function(){return"DwtTreeEvent"
};
DwtTreeEvent.prototype.setFromDhtmlEvent=function(a,c){a=DwtSelectionEvent.prototype.setFromDhtmlEvent.apply(this,arguments)
}
}if(AjxPackage.define("ajax.dwt.events.DwtMouseEventCapture")){DwtMouseEventCapture=function(a){a=Dwt.getParams(arguments,DwtMouseEventCapture.PARAMS);
this.targetObj=a.targetObj;
this._id=a.id;
this._mouseOverHdlr=a.mouseOverHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseDownHdlr=a.mouseDownHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseMoveHdlr=a.mouseMoveHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseUpHdlr=a.mouseUpHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseOutHdlr=a.mouseOutHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseWheelHdlr=a.mouseWheelHdlr||DwtMouseEventCapture.emptyHdlr;
this._hardCapture=(a.hardCapture!==false)
};
DwtMouseEventCapture.PARAMS=["targetObj","id","mouseOverHdlr","mouseDownHdlr","mouseMoveHdlr","mouseUpHdlr","mouseOutHdlr","mouseWheelHdlr","hardCapture"];
DwtMouseEventCapture._capturing=false;
DwtMouseEventCapture.getCaptureObj=function(){return window._mouseEventCaptureObj
};
DwtMouseEventCapture.getTargetObj=function(){return window._mouseEventCaptureObj?window._mouseEventCaptureObj.targetObj:null
};
DwtMouseEventCapture.getId=function(){return window._mouseEventCaptureObj?window._mouseEventCaptureObj._id:null
};
DwtMouseEventCapture.prototype.toString=function(){return"DwtMouseEventCapture"
};
DwtMouseEventCapture.prototype.capturing=function(){return DwtMouseEventCapture._capturing
};
DwtMouseEventCapture.prototype.capture=function(){if(window._mouseEventCaptureObj){window._mouseEventCaptureObj.release()
}if(document.body!=null&&document.body.addEventListener!=null){document.body.addEventListener("mouseover",this._mouseOverHdlr,true);
document.body.addEventListener("mousedown",this._mouseDownHdlr,true);
document.body.addEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.addEventListener("mouseup",this._mouseUpHdlr,true);
document.body.addEventListener("mouseout",this._mouseOutHdlr,true);
document.body.addEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{this._savedMouseOverHdlr=document.onmouseover;
this._savedMouseDownHdlr=document.onmousedown;
this._savedMouseMoveHdlr=document.onmousemove;
this._savedMouseUpHdlr=document.onmouseup;
this._savedMouseOutHdlr=document.onmouseout;
this._savedMouseWheelHdlr=document.onmousewheel;
document.onmouseover=this._mouseOverHdlr;
document.onmousedown=this._mouseDownHdlr;
document.onmousemove=this._mouseMoveHdlr;
document.onmouseup=this._mouseUpHdlr;
document.onmouseout=this._mouseOutHdlr;
document.onmousewheel=this._mouseWheelHdlr
}window._mouseEventCaptureObj=this;
DwtMouseEventCapture._capturing=true
};
DwtMouseEventCapture.prototype.release=function(){if(window._mouseEventCaptureObj==null){return
}var a=window._shellCaptureObj;
if(document.body&&document.body.addEventListener){document.body.removeEventListener("mouseover",this._mouseOverHdlr,true);
document.body.removeEventListener("mousedown",this._mouseDownHdlr,true);
document.body.removeEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.removeEventListener("mouseup",this._mouseUpHdlr,true);
document.body.removeEventListener("mouseout",this._mouseOutHdlr,true);
document.body.removeEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{document.onmouseover=this._savedMouseOverHdlr;
document.onmousedown=this._savedMouseDownHdlr;
document.onmousemove=this._savedMouseMoveHdlr;
document.onmouseup=this._savedMouseUpHdlr;
document.onmouseout=this._savedMouseOutHdlr;
document.onmousewheel=this._savedMouseWheelHdlr
}window._mouseEventCaptureObj=null;
DwtMouseEventCapture._capturing=false
};
DwtMouseEventCapture.emptyHdlr=function(c){var d=DwtMouseEventCapture.getCaptureObj();
var a=DwtShell.mouseEvent;
a.setFromDhtmlEvent(c);
if(d._hardCapture){a._stopPropagation=true;
a._returnValue=false;
a.setToDhtmlEvent(c);
return false
}else{a._stopPropagation=false;
a._returnValue=true;
a.setToDhtmlEvent(c);
return true
}}
}if(AjxPackage.define("ajax.dwt.events.DwtEventManager")){DwtEventManager=function(){};
DwtEventManager._instance=new AjxEventMgr();
DwtEventManager._domEventToDwtMap={ondblclick:DwtEvent.ONDBLCLICK,onmousedown:DwtEvent.ONMOUSEDOWN,onmouseup:DwtEvent.ONMOUSEUP,onmousemove:DwtEvent.ONMOUSEMOVE,onmouseout:DwtEvent.ONMOUSEOUT,onmouseover:DwtEvent.ONMOUSEOVER,onselectstart:DwtEvent.ONSELECTSTART,onchange:DwtEvent.ONCHANGE};
DwtEventManager.addListener=function(a,c){DwtEventManager._instance.addListener(a,c)
};
DwtEventManager.notifyListeners=function(a,c){DwtEventManager._instance.notifyListeners(a,c)
};
DwtEventManager.removeListener=function(a,c){DwtEventManager._instance.removeListener(a,c)
}
}if(AjxPackage.define("ajax.dwt.events.DwtHoverEvent")){DwtHoverEvent=function(e,d,c,a,f){if(arguments.length==0){return
}DwtEvent.call(this,true);
this.type=e;
this.delay=d;
this.object=c;
this.x=a||-1;
this.y=f||-1
};
DwtHoverEvent.prototype=new DwtEvent;
DwtHoverEvent.prototype.constructor=DwtHoverEvent;
DwtHoverEvent.prototype.toString=function(){return"DwtHoverEvent"
};
DwtHoverEvent.prototype.reset=function(){this.type=0;
this.delay=0;
this.object=null;
this.x=-1;
this.y=-1
}
}if(AjxPackage.define("ajax.dwt.widgets.DwtControl")){DwtControl=function(c){if(arguments.length==0){return
}c=Dwt.getParams(arguments,DwtControl.PARAMS);
var a=this.parent=c.parent;
if(a&&!(a.isDwtComposite)){throw new DwtException("Parent must be a subclass of Composite",DwtException.INVALIDPARENT,"DwtControl")
}this.shell=null;
this._data={};
this._eventMgr=new AjxEventMgr();
this._disposed=false;
this._propagateEvent={};
this._propagateEvent[DwtEvent.ONMOUSEWHEEL]=true;
if(!a){return
}this._className=c.className||"DwtControl";
this.__posStyle=c.posStyle;
if(c.id){this._htmlElId=c.id
}this.isFocusable=(c.isFocusable!==false);
if(c.role!=null){this.role=c.role
}this.__index=c.index;
this.__parentElement=c.parentElement;
this._enabled=false;
this._dragging=null;
this._dndProxy=null;
this._hasFocus=false;
if(!c.deferred){this.__initCtrl()
}this._hoverOverListener=new AjxListener(this,this.__handleHoverOver);
this._hoverOutListener=new AjxListener(this,this.__handleHoverOut);
this._dblClickIsolation=false;
this._ignoreInternalOverOut=false;
this.TEMPLATE=c.template||this.TEMPLATE
};
DwtControl.prototype.isDwtControl=true;
DwtControl.prototype.toString=function(){return"DwtControl"
};
DwtControl.prototype.isFocusable=null;
DwtControl.PARAMS=["parent","className","posStyle","deferred","id","index","template"];
DwtControl.ALL_BY_ID={};
DwtControl.NORMAL="";
DwtControl.ACTIVE="ZActive";
DwtControl.FOCUSED="ZFocused";
DwtControl.DISABLED="ZDisabled";
DwtControl.HOVER="ZHover";
DwtControl.SELECTED="ZSelected";
DwtControl.DEFAULT="ZDefault";
DwtControl.ERROR="ZError";
DwtControl._STATES=[DwtControl.ACTIVE,DwtControl.FOCUSED,DwtControl.DISABLED,DwtControl.HOVER,DwtControl.SELECTED,DwtControl.DEFAULT,DwtControl.ERROR];
DwtControl._RE_STATES=new RegExp("\\b("+DwtControl._STATES.join("|")+")\\b","g");
DwtControl._RE_STATE=AjxUtil.arrayAsHash(DwtControl._STATES,function(a){return new RegExp("\\b"+a+"\\b","g")
});
DwtControl._ARIA_STATES={};
DwtControl._ARIA_STATES[DwtControl.DISABLED]="aria-disabled";
DwtControl._ARIA_STATES[DwtControl.SELECTED]="aria-selected";
DwtControl._ARIA_STATES[DwtControl.ERROR]="aria-invalid";
DwtControl.useBrowserTooltips=false;
DwtControl.STATIC_STYLE=Dwt.STATIC_STYLE;
DwtControl.ABSOLUTE_STYLE=Dwt.ABSOLUTE_STYLE;
DwtControl.RELATIVE_STYLE=Dwt.RELATIVE_STYLE;
DwtControl.FIXED_STYLE=Dwt.FIXED_STYLE;
DwtControl.CLIP=Dwt.CLIP;
DwtControl.VISIBLE=Dwt.VISIBLE;
DwtControl.SCROLL=Dwt.SCROLL;
DwtControl.FIXED_SCROLL=Dwt.FIXED_SCROLL;
DwtControl._NO_DRAG="NO_DRAG";
DwtControl._DRAGGING="DRAGGING";
DwtControl._DRAG_REJECTED="DRAG_REJECTED";
DwtControl.__DRAG_THRESHOLD=3;
DwtControl.__TOOLTIP_THRESHOLD=5;
DwtControl.__DND_HOVER_DELAY=750;
DwtControl.__controlEvent=new DwtControlEvent();
DwtControl.__DBL_CLICK_TIMEOUT=300;
DwtControl.prototype._displayState="";
DwtControl.prototype.addControlListener=function(a){this.addListener(DwtEvent.CONTROL,a)
};
DwtControl.prototype.removeControlListener=function(a){this.removeListener(DwtEvent.CONTROL,a)
};
DwtControl.prototype.addDisposeListener=function(a){this.addListener(DwtEvent.DISPOSE,a)
};
DwtControl.prototype.removeDisposeListener=function(a){this.removeListener(DwtEvent.DISPOSE,a)
};
DwtControl.prototype.addListener=function(c,d,a){return this._eventMgr.addListener(c,d,a)
};
DwtControl.prototype.removeListener=function(a,c){return this._eventMgr.removeListener(a,c)
};
DwtControl.prototype.removeAllListeners=function(a){return this._eventMgr.removeAll(a)
};
DwtControl.prototype.isListenerRegistered=function(a){return this._eventMgr.isListenerRegistered(a)
};
DwtControl.prototype.notifyListeners=function(a,c){return this._eventMgr.notifyListeners(a,c)
};
DwtControl.prototype.dispose=function(){if(this._disposed){return
}if(this.parent&&this.parent.isDwtComposite){this.parent.removeChild(this)
}this._elRef=null;
DwtControl.ALL_BY_ID[this._htmlElId]=null;
delete DwtControl.ALL_BY_ID[this._htmlElId];
this._disposed=true;
var a=new DwtDisposeEvent();
a.dwtObj=this;
this.notifyListeners(DwtEvent.DISPOSE,a);
this._eventMgr.clearAllEvents()
};
DwtControl.prototype.getDocument=function(){return document
};
DwtControl.prototype.getTabGroupMember=function(){return this.tabGroupMember||this
};
DwtControl.prototype.getData=function(a){return this._data[a]
};
DwtControl.prototype.setData=function(a,c){this._data[a]=c
};
DwtControl.prototype.isDisposed=function(){return this._disposed
};
DwtControl.prototype.isInitialized=function(){return this.__ctrlInited
};
DwtControl.prototype.focus=function(){if(!this._checkState()){return
}var c=this.getFocusElement();
if(c&&c.focus){AjxTimedAction.scheduleAction(this._focusAction);
var a=this.getScrollContainer(),d=a&&a.scrollTop;
c.focus();
if(d>0){a.scrollTop=d
}}return this
};
DwtControl.prototype.blur=function(){if(!this._checkState()){return
}var a=this.getFocusElement();
if(a&&a.blur){AjxTimedAction.scheduleAction(this._blurAction);
a.blur()
}return this
};
DwtControl.prototype.hasFocus=function(){return this._hasFocus
};
DwtControl.prototype.handleKeyAction=function(a,c){return false
};
DwtControl.prototype.reparent=function(c,a){if(!this._checkState()){return
}var d=this.getHtmlElement();
this.parent.removeChild(this,true);
DwtComposite._pendingElements[this._htmlElId]=d;
c.addChild(this,a);
this.parent=c
};
DwtControl.prototype.reparentHtmlElement=function(d,a){if(typeof d=="string"){d=document.getElementById(d)
}if(!d){return
}var c=this.getHtmlElement();
if(a==null){d.appendChild(c)
}else{if(typeof a=="object"){d.insertBefore(c,a)
}else{if(d.childNodes[a]){d.insertBefore(c,d.childNodes[a])
}else{d.appendChild(c)
}}}};
DwtControl.prototype.setHandler=function(c,a){if(!this._checkState()){return
}var d=this.getHtmlElement();
Dwt.setHandler(d,c,a)
};
DwtControl.prototype.clearHandler=function(a){if(!this._checkState()){return
}var c=this.getHtmlElement();
Dwt.clearHandler(c,a)
};
DwtControl.prototype.setEventPropagation=function(a,d){d=AjxUtil.toArray(d);
for(var c=0;
c<d.length;
c++){this._propagateEvent[d[c]]=a
}};
DwtControl.prototype.getBounds=function(){if(!this._checkState()){return
}return Dwt.getBounds(this.getHtmlElement())
};
DwtControl.prototype.getInsetBounds=function(){if(!this._checkState()){return
}return Dwt.getInsetBounds(this.getHtmlElement())
};
DwtControl.prototype.getInsets=function(){if(!this._checkState()){return
}return Dwt.getInsets(this.getHtmlElement())
};
DwtControl.prototype.getMargins=function(){if(!this._checkState()){return
}return Dwt.getMargins(this.getHtmlElement())
};
DwtControl.prototype.setBounds=function(d,g,e,c){if(!this._checkState()){return
}var f=this.getHtmlElement();
if(this.isListenerRegistered(DwtEvent.CONTROL)){this.__controlEvent.reset(DwtControlEvent.RESIZE|DwtControlEvent.MOVE);
var a=Dwt.getBounds(f);
this.__controlEvent.oldX=a.x;
this.__controlEvent.oldY=a.y;
this.__controlEvent.oldWidth=a.width;
this.__controlEvent.oldHeight=a.height;
this.setLocation(d,g);
this.setSize(e,c);
a=Dwt.getBounds(f);
this.__controlEvent.newX=a.x;
this.__controlEvent.newY=a.y;
this.__controlEvent.newWidth=(AjxUtil.isNumber(e))?e:a.width;
this.__controlEvent.newHeight=(AjxUtil.isNumber(c))?c:a.height;
this.__controlEvent.requestedWidth=e;
this.__controlEvent.requestedHeight=c;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{this.setLocation(d,g);
this.setSize(e,c)
}return this
};
DwtControl.prototype.getClassName=function(){return this._className
};
DwtControl.prototype.setClassName=function(c){if(!this._checkState()){return
}this._className=c;
var a=this.getHtmlElement();
a.className=c;
Dwt.addClass(a,this._displayState)
};
DwtControl.prototype.addClassName=function(a){Dwt.addClass(this.getHtmlElement(),a)
};
DwtControl.prototype.delClassName=function(a,c){Dwt.delClass(this.getHtmlElement(),a,c)
};
DwtControl.prototype.condClassName=function(d,a,c){Dwt.condClass(this.getHtmlElement(),d,a,c)
};
DwtControl.prototype.setDisplayState=function(f){if(!this._enabled){f=DwtControl.DISABLED
}if(arguments.length>1){var c=[];
for(var e=0;
e<arguments.length;
e++){c.push(arguments[e])
}f=c.join(" ")
}if(this._displayState==f){return
}var d=this._displayState;
this._displayState=f;
Dwt.delClass(this.getHtmlElement(),DwtControl._RE_STATES,f);
AjxUtil.foreach(DwtControl._ARIA_STATES,(function(a,g){if(DwtControl._RE_STATE[g].test(this._displayState)){this.setAttribute(a,true)
}else{this.removeAttribute(a)
}}).bind(this));
if(this.isListenerRegistered(DwtEvent.STATE_CHANGE)){this.__controlEvent.reset(DwtControlEvent.STATE);
this.__controlEvent.oldState=d;
this.__controlEvent.newState=f;
this.__controlEvent.dwtObj=this;
this.notifyListeners(DwtEvent.STATE_CHANGE,this.__controlEvent)
}};
DwtControl.prototype.showAlert=function(a){if(a&&!this._alert){this.delClassName(null,"ZAlert")
}else{if(!a&&this._alert){this.delClassName("ZAlert",null)
}}this._alert=a
};
DwtControl.prototype.isAlertShown=function(){return this._alert
};
DwtControl.prototype._createHtmlFromTemplate=function(a,d){this.getHtmlElement().innerHTML=AjxTemplate.expand(a,d);
var e=AjxTemplate.getParams(a);
var c=e&&e["class"];
if(c){c=[this._className,c].join(" ");
this.setClassName(c)
}};
DwtControl.prototype.getCursor=function(){if(!this._checkState()){return
}return Dwt.getCursor(this.getHtmlElement())
};
DwtControl.prototype.setCursor=function(a){if(!this._checkState()){return
}Dwt.setCursor(this.getHtmlElement(),a)
};
DwtControl.prototype.getDragSource=function(){return this._dragSource
};
DwtControl.prototype.setDragSource=function(a){this._dragSource=a;
if(a&&!this._ctrlCaptureObj){this.__initCapture();
this._dndHoverAction=new AjxTimedAction(null,this.__dndDoHover)
}};
DwtControl.prototype.getDropTarget=function(){return this._dropTarget
};
DwtControl.prototype.setDropTarget=function(a){this._dropTarget=a
};
DwtControl.prototype.getDragBox=function(){return this._dragBox
};
DwtControl.prototype.setDragBox=function(a){this._dragBox=a;
if(a&&!this._ctrlCaptureObj){this.__initCapture()
}};
DwtControl.prototype.__initCapture=function(a){this._ctrlCaptureObj=new DwtMouseEventCapture({targetObj:this,id:"DwtControl",mouseOverHdlr:DwtControl.__mouseOverHdlr,mouseDownHdlr:DwtControl.__mouseDownHdlr,mouseMoveHdlr:DwtControl.__mouseMoveHdlr,mouseUpHdlr:DwtControl.__mouseUpHdlr,mouseOutHdlr:DwtControl.__mouseOutHdlr})
};
DwtControl.prototype.getEnabled=function(){if(!this._checkState()){return
}return this._enabled
};
DwtControl.prototype.setEnabled=function(a,c){if(!this._checkState()){return
}if(a!=this._enabled){this._enabled=a;
this.setDisplayState(a?DwtControl.NORMAL:DwtControl.DISABLED);
if(c){this.getHtmlElement().disabled=!a
}}};
DwtControl.prototype.getHTMLElId=function(){return this._htmlElId
};
DwtControl.prototype.getHtmlElement=function(){if(!this._checkState()){return
}var a=this._elRef||document.getElementById(this._htmlElId);
if(a==null){a=DwtComposite._pendingElements[this._htmlElId]
}else{if(!a._rendered){delete DwtComposite._pendingElements[this._htmlElId];
a._rendered=true
}}return this._elRef=a
};
DwtControl.prototype.getFocusElement=function(){return this.isFocusable?this._focusElement:null
};
DwtControl.prototype.setFocusElement=function(d){if(!this.isFocusable){return
}var a=(document.activeElement===this._focusElement),c=d||(this.getInputElement&&this.getInputElement())||this.getHtmlElement();
if(this._focusElement&&this._focusElement!==c){this._makeFocusable(this._focusElement,false)
}this._focusElement=c;
if(c){this._makeFocusable(this._focusElement,true);
if(a){c.focus()
}}};
DwtControl.fromElement=function(a){return DwtControl.ALL_BY_ID[a.id]
};
DwtControl.fromElementId=function(a){return DwtControl.ALL_BY_ID[a]
};
DwtControl.findControl=function(c){if(AjxEnv.isFirefox3_5up&&!AjxEnv.isFirefox3_6up){var a=HTMLElement.prototype.toString.call(c);
if(a=="[xpconnect wrapped native prototype]"||a=="[object XULElement]"){return null
}}try{while(c){if(c.id&&DwtControl.ALL_BY_ID[c.id]){return DwtControl.ALL_BY_ID[c.id]
}c=c.parentNode
}}catch(d){}return null
};
DwtControl.getTargetControl=function(a,d){var c=DwtUiEvent.getTarget(a,d);
return c?DwtControl.findControl(c):null
};
DwtControl.prototype.setHtmlElementId=function(c){if(this._disposed){return
}if(this.__ctrlInited){var a=this.getHtmlElement();
if(!a._rendered){delete DwtComposite._pendingElements[this._htmlElId];
DwtComposite._pendingElements[c]=a
}else{delete DwtControl.ALL_BY_ID[this._htmlElId];
DwtControl.ALL_BY_ID[c]=this
}a.id=c
}this._htmlElId=c
};
DwtControl.prototype.getX=function(){if(!this._checkState()){return
}return Dwt.getLocation(this.getHtmlElement()).x
};
DwtControl.prototype.getXW=function(){if(!this._checkState()){return
}var a=this.getBounds();
return a.x+a.width
};
DwtControl.prototype.getY=function(){if(!this._checkState()){return
}return Dwt.getLocation(this.getHtmlElement()).y
};
DwtControl.prototype.getYH=function(){if(!this._checkState()){return
}var a=this.getBounds();
return a.y+a.height
};
DwtControl.prototype.getPosition=function(){if(!this._checkState()){return
}return Dwt.getPosition(this.getHtmlElement())
};
DwtControl.prototype.setPosition=function(a){if(!this._checkState()){return
}return Dwt.setPosition(this.getHtmlElement(),a)
};
DwtControl.prototype.getLocation=function(){if(!this._checkState()){return
}return Dwt.getLocation(this.getHtmlElement())
};
DwtControl.prototype.setLocation=function(a,e){if(!this._checkState()){return
}if(this.isListenerRegistered(DwtEvent.CONTROL)){var c=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.MOVE);
var d=Dwt.getLocation(c);
this.__controlEvent.oldX=d.x;
this.__controlEvent.oldY=d.y;
Dwt.setLocation(c,a,e);
d=Dwt.getLocation(c);
this.__controlEvent.newX=d.x;
this.__controlEvent.newY=d.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{Dwt.setLocation(this.getHtmlElement(),a,e)
}return this
};
DwtControl.prototype.getScrollStyle=function(){if(!this._checkState()){return
}return Dwt.getScrollStyle(this.getHtmlElement())
};
DwtControl.prototype.setScrollStyle=function(a){if(!this._checkState()){return
}Dwt.setScrollStyle(this.getHtmlElement(),a)
};
DwtControl.prototype.getScrollContainer=function(){return this.parent&&this.parent.getHtmlElement()
};
DwtControl.prototype.setPosition=function(a){if(!this._checkState()){return
}if(a==DwtControl.STATIC_STYLE||a==DwtControl.ABSOLUTE_STYLE||a==DwtControl.RELATIVE_STYLE){this.__posStyle=a;
Dwt.setPosition(this.getHtmlElement(),a)
}};
DwtControl.prototype.getW=function(){if(!this._checkState()){return
}return Dwt.getSize(this.getHtmlElement()).x
};
DwtControl.prototype.getH=function(){if(!this._checkState()){return
}return Dwt.getSize(this.getHtmlElement()).y
};
DwtControl.prototype.getSize=function(a){if(!this._checkState()){return
}return Dwt.getSize(this.getHtmlElement(),null,a)
};
DwtControl.prototype.getOuterSize=function(){if(!this._checkState()){return
}return Dwt.getOuterSize(this.getHtmlElement(),null)
};
DwtControl.prototype.setSize=function(c,a){if(!this._checkState()){return
}if(this.isListenerRegistered(DwtEvent.CONTROL)){var e=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.RESIZE);
var d=Dwt.getSize(e);
this.__controlEvent.oldWidth=d.x;
this.__controlEvent.oldHeight=d.y;
Dwt.setSize(e,c,a);
d=Dwt.getSize(e);
this.__controlEvent.newWidth=d.x;
this.__controlEvent.newHeight=d.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{Dwt.setSize(this.getHtmlElement(),c,a)
}return this
};
DwtControl.prototype.getToolTipContent=function(a){if(this._disposed){return null
}return this.__toolTipContent
};
DwtControl.prototype.setToolTipContent=function(c,a){if(this._disposed){return
}if(c&&(typeof(c)=="string")&&DwtControl.useBrowserTooltips){if(!c||(!c.match(/[\n\r\t]/)&&!c.match(/<[a-zA-Z]+/))){var d=this.getHtmlElement();
if(d){d.title=c;
this._browserToolTip=true;
return
}}}this._browserToolTip=false;
this.__toolTipContent=c
};
DwtControl.prototype.getVisible=function(){if(!this._checkState()){return
}return Dwt.getVisible(this.getHtmlElement())
};
DwtControl.prototype.setVisible=function(a){if(!this._checkState()){return
}Dwt.setVisible(this.getHtmlElement(),a)
};
DwtControl.prototype.setVisibility=function(a){if(!this._checkState()){return
}Dwt.setVisibility(this.getHtmlElement(),a)
};
DwtControl.prototype.getVisibility=function(){if(!this._checkState()){return
}return Dwt.getVisibility(this.getHtmlElement())
};
DwtControl.prototype.getZIndex=function(a){if(!this._checkState()){return
}return Dwt.getZIndex(this.getHtmlElement(),a)
};
DwtControl.prototype.setZIndex=function(a){if(!this._checkState()){return
}Dwt.setZIndex(this.getHtmlElement(),a)
};
DwtControl.prototype.zShow=function(a){this.setZIndex(a?Dwt.Z_VIEW:Dwt.Z_HIDDEN)
};
DwtControl.prototype.setDisplay=function(a){if(!this._checkState()){return
}Dwt.setDisplay(this.getHtmlElement(),a)
};
DwtControl.prototype.setOpacity=function(a){if(!this._checkState()){return
}Dwt.setOpacity(this.getHtmlElement(),a)
};
DwtControl.prototype.getOpacity=function(){if(!this._checkState()){return
}return Dwt.getOpacity(this.getHtmlElement())
};
DwtControl.prototype.preventSelection=function(a){return !this.__isInputEl(a)
};
DwtControl.prototype.preventContextMenu=function(a){return a?(!this.__isInputEl(a)):true
};
DwtControl.prototype.getContent=function(){return this.getHtmlElement().innerHTML
};
DwtControl.prototype.setContent=function(a){if(a){this.getHtmlElement().innerHTML=a
}};
DwtControl.prototype.clearContent=function(){this.getHtmlElement().innerHTML=""
};
DwtControl.prototype.appendElement=function(c){var a=AjxUtil.isString(c)?document.getElementById(c):c;
if(a){a.appendChild(this.getHtmlElement(),a)
}};
DwtControl.prototype.replaceElement=function(e,a,f){var c=AjxUtil.isString(e)?document.getElementById(e):e;
if(c){var d=this.getHtmlElement();
c.parentNode.replaceChild(d,c);
this._replaceElementHook(c,d,a,f)
}};
DwtControl.prototype._replaceElementHook=function(c,f,a,i){if((a==null||a)&&c.className){Dwt.addClass(f,c.className)
}if(i==null||i){var d=c.getAttribute("style")||c.style;
if(d){if(AjxUtil.isString(d)){f.setAttribute("style",[f.getAttribute("style"),d].join(";"))
}else{if(AjxUtil.isString(d.cssText)){if(d.cssText){f.setAttribute("style",[f.getAttribute("style"),d.cssText].join(";"))
}}else{for(var g in d){if(d[g]){try{f.style[g]=d[g]
}catch(h){}}}}}}}};
DwtControl.prototype._blur=function(){};
DwtControl.prototype._focus=function(){};
DwtControl.prototype._focusByMouseUpEvent=function(a){if(this.getEnabled()){this.shell.getKeyboardMgr().grabFocus(this)
}};
DwtControl.prototype._focusByMouseDownEvent=function(a){this._duringFocusByMouseDown=true;
this._focusByMouseUpEvent(a);
this._duringFocusByMouseDown=false
};
DwtControl.prototype._getDragOp=function(a){return a.ctrlKey?Dwt.DND_DROP_COPY:Dwt.DND_DROP_MOVE
};
DwtControl.prototype._getDragProxy=function(a){return null
};
DwtControl.prototype.getDragSelectionBox=function(a){if(!this._dragSelectionBox){var c=this._dragSelectionBox=document.createElement("div");
c.className="dndSelectionBox";
Dwt.setPosition(c,Dwt.ABSOLUTE_STYLE);
this.shell.getHtmlElement().appendChild(c);
Dwt.setZIndex(c,Dwt.Z_DND)
}return this._dragSelectionBox
};
DwtControl.prototype._setDragProxyState=function(a){if(this._dndProxy){Dwt.condClass(this._dndProxy,a,DwtCssStyle.DROPPABLE,DwtCssStyle.NOT_DROPPABLE)
}};
DwtControl.__junkIconId=0;
DwtControl.prototype._destroyDragProxy=function(a){if(a){if(a.parentNode){a.parentNode.removeChild(a)
}else{a.style.zIndex=-100;
a.id="DwtJunkIcon"+DwtControl.__junkIconId++;
a=null
}}};
DwtControl.prototype.destroyDragSelectionBox=function(){var a=this._dragSelectionBox;
if(a&&a.parentNode){a.parentNode.removeChild(a)
}this._dragSelectionBox=null
};
DwtControl.prototype._isValidDragObject=function(a){return true
};
DwtControl.prototype._dragEnter=function(a){};
DwtControl.prototype._dragOver=function(a){};
DwtControl.prototype._dragHover=function(a){};
DwtControl.prototype._dragLeave=function(a){};
DwtControl.prototype._drop=function(a){};
DwtControl.prototype._makeFocusable=function(a,c){c=(c!==false);
this._setEventHdlrs([DwtEvent.ONFOCUS,DwtEvent.ONBLUR],true,a);
if(c){this._setEventHdlrs([DwtEvent.ONFOCUS,DwtEvent.ONBLUR],false,a);
a.tabIndex=0
}else{a.removeAttribute("tabIndex")
}};
DwtControl.prototype._setKeyPressEventHdlr=function(a,c){this._setEventHdlrs([DwtEvent.ONKEYPRESS],a,c)
};
DwtControl.prototype._setMouseEventHdlrs=function(a,c){this._setEventHdlrs(DwtEvent.MOUSE_EVENTS,a,c)
};
DwtControl.prototype._setKeyEventHdlrs=function(a,c){this._setEventHdlrs(DwtEvent.KEY_EVENTS,a,c)
};
DwtControl.prototype._setEventHdlrs=function(e,a,d){if(!this._checkState()){return
}var f=d||this.getHtmlElement();
for(var c=0;
c<e.length;
c++){if(a!==true){Dwt.setHandler(f,e[c],DwtControl.__HANDLER[e[c]])
}else{Dwt.clearHandler(f,e[c])
}}};
DwtControl.prototype._setMouseEvents=function(){var a=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART];
if(AjxEnv.isIE){a.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{a.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}this._setEventHdlrs(a)
};
DwtControl.prototype._setMouseEvent=function(c,a){c.reset();
a.ersatz=true;
DwtUiEvent.copy(c,a);
c.button=a.button
};
DwtControl.prototype._getStopPropagationValForMouseEv=function(a){return true
};
DwtControl.prototype._getEventReturnValForMouseEv=function(a){return false
};
DwtControl.prototype._checkState=function(){if(this._disposed){return false
}if(!this.__ctrlInited){this.__initCtrl()
}return true
};
DwtControl.prototype._position=function(e){this._checkState();
var d=this.shell.getSize();
var c=this.getSize();
var a,f;
if(c){if(!e){a=Math.round((d.x-c.x)/2);
f=Math.round((d.y-c.y)/2)
}else{a=e.x;
f=e.y
}if((a+c.x)>d.x){a=d.x-c.x
}if((f+c.y)>d.y){f=d.y-c.y
}this.setLocation(a,f)
}};
DwtControl._dndScrollCallback=function(d,h){var c=d.container;
if(!c){return
}var l=h.dwtObj&&h.dwtObj._dndScrollId;
if(h.type=="mouseup"||!l||(d.id&&l!=d.id)){if(c._dndScrollActionId!=-1){AjxTimedAction.cancelAction(c._dndScrollActionId);
c._dndScrollActionId=-1
}return
}c._scrollAmt=0;
if(c.clientHeight<c.scrollHeight){var e=Dwt.toWindow(c,0,0,null,null,DwtPoint.tmp).y;
var m=e+c.scrollTop;
var i=c.scrollTop;
var j=h.docY-m;
var f=(c.clientWidth<c.scrollWidth)?d.threshold+Dwt.SCROLLBAR_WIDTH:d.threshold;
var g=(j<=f)?-1*d.amount:0;
if(g==0){var a=Dwt.getSize(c,DwtPoint.tmp).y;
var k=m+a;
j=k-h.docY;
g=(j<=f)?d.amount:0
}c._scrollAmt=g;
if(g){if(!c._dndScrollAction){c._dndScrollAction=new AjxTimedAction(null,DwtControl._dndScroll,[d]);
c._dndScrollActionId=-1
}if(c._dndScrollActionId==-1){c._dndScrollActionId=AjxTimedAction.scheduleAction(c._dndScrollAction,0)
}}else{if(c._dndScrollActionId!=-1){AjxTimedAction.cancelAction(c._dndScrollActionId);
c._dndScrollActionId=-1
}}}};
DwtControl._dndScroll=function(f){var c=f.container;
var e=Dwt.toWindow(c,0,0,null,null,DwtPoint.tmp).y;
var d=Dwt.getSize(c,DwtPoint.tmp).y;
var a=c.scrollTop;
if((c._scrollAmt<0&&a>0)||(c._scrollAmt>0&&(a+d<c.scrollHeight))){c.scrollTop+=c._scrollAmt;
c._dndScrollActionId=AjxTimedAction.scheduleAction(c._dndScrollAction,f.interval)
}};
DwtControl.__keyPressHdlr=function(d){var e=e?e:DwtControl.getTargetControl(d);
if(!e){return false
}if(e.__hasToolTipContent()){var c=DwtShell.getShell(window);
var a=c.getHoverMgr();
a.setHoverOutListener(e._hoverOutListener);
a.hoverOut();
e.__tooltipClosed=false
}};
DwtControl.__keyUpHdlr=function(a){return DwtKeyboardMgr.__keyUpHdlr.apply(this,arguments)
};
DwtControl.__keyDownHdlr=function(a){return DwtKeyboardMgr.__keyDownHdlr.apply(this,arguments)
};
DwtControl.__focusHdlr=function(c,a,d){d=d||DwtControl.getTargetControl(c);
if(!d){return false
}d._cancelFocusBlurActions();
return d.__doFocus(c)
};
DwtControl.__blurHdlr=function(c,a,d){d=d||DwtControl.getTargetControl(c);
if(!d){return false
}d._cancelFocusBlurActions();
return d.__doBlur(c)
};
DwtControl.prototype._cancelFocusBlurActions=function(){if(this._focusAction._id!==-1){AjxTimedAction.cancelAction(this._focusAction._id)
}if(this._blurAction._id!==-1){AjxTimedAction.cancelAction(this._blurAction._id)
}};
DwtControl.prototype.__hasToolTipContent=function(){if(this._disposed){return false
}return Boolean(!this._browserToolTip&&(this.__toolTipContent||(this.getToolTipContent!=DwtControl.prototype.getToolTipContent)))
};
DwtControl.prototype.__doFocus=function(a){if(!this._checkState()){return false
}this._hasFocus=true;
this.shell.getKeyboardMgr().updateFocus(this,a);
if(this.isListenerRegistered(DwtEvent.ONFOCUS)){a=a||DwtShell.focusEvent;
a.dwtObj=this;
a.state=DwtFocusEvent.FOCUS;
this.notifyListeners(DwtEvent.ONFOCUS,a)
}this._focus();
return true
};
DwtControl.prototype.__doBlur=function(a){if(!this._checkState()){return false
}this._hasFocus=false;
if(this.isListenerRegistered(DwtEvent.ONBLUR)){a=a||DwtShell.focusEvent;
a.dwtObj=this;
a.state=DwtFocusEvent.BLUR;
this.notifyListeners(DwtEvent.ONBLUR,a)
}this._blur();
return true
};
DwtControl.__clickHdlr=function(c){var d=DwtControl.getTargetControl(c);
if(d&&d._clickPending){return
}try{return DwtControl.__mouseEvent(c,DwtEvent.ONCLICK)
}catch(a){AjxException.reportScriptError(a)
}};
DwtControl.__dblClickHdlr=function(c){try{var d=DwtControl.getTargetControl(c);
if(d&&d._dblClickIsolation){d._clickPending=false;
AjxTimedAction.cancelAction(d._dblClickActionId)
}return DwtControl.__mouseEvent(c,DwtEvent.ONDBLCLICK)
}catch(a){AjxException.reportScriptError(a)
}};
DwtControl.__mouseOverHdlr=function(g,h){try{var d=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
if(d!=null){g=DwtUiEvent.getEvent(g);
g._stopPropagation=true;
return false
}var c=DwtControl.getTargetControl(g);
if(!c){return false
}h=h||DwtEvent.ONMOUSEOVER;
if((h==DwtEvent.ONMOUSEOVER)&&c._ignoreInternalOverOut){var j=DwtControl.getTargetControl(g,true);
if(c==j){return false
}}var i=DwtShell.mouseEvent;
if(c._dragging==DwtControl._NO_DRAG){i.setFromDhtmlEvent(g,c);
i.hoverStarted=false;
if(c.isListenerRegistered(h)){c.notifyListeners(h,i)
}if(c.__hasToolTipContent(i)&&!i.hoverStarted){var e=DwtShell.getShell(window);
var a=e.getHoverMgr();
if((!a.isHovering()||a.getHoverObject()!=c)&&!DwtMenu.menuShowing()){a.reset();
a.setHoverObject(c);
a.setHoverOverData(i);
a.setHoverOverDelay(DwtToolTip.TOOLTIP_DELAY);
a.setHoverOverListener(c._hoverOverListener);
a.hoverOver(i.docX,i.docY)
}}}i._stopPropagation=true;
i._returnValue=false;
i.setToDhtmlEvent(g);
return false
}catch(f){AjxException.reportScriptError(f)
}};
DwtControl.__mouseEnterHdlr=function(a){return DwtControl.__mouseOverHdlr(a,DwtEvent.ONMOUSEENTER)
};
DwtControl.__mouseDownHdlr=function(f){try{var g=DwtControl.getTargetControl(f);
if(!g){return false
}f=DwtUiEvent.getEvent(f);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(f,g);
if(e.button==DwtMouseEvent.LEFT){g._focusByMouseDownEvent(f);
e.setFromDhtmlEvent(f,g)
}if(g.__hasToolTipContent()){var d=DwtShell.getShell(window);
var c=d.getHoverMgr();
c.setHoverOutListener(g._hoverOutListener);
c.hoverOut()
}if(g._dragSource&&(e.button==DwtMouseEvent.LEFT)&&g._isValidDragObject(e)){try{g._ctrlCaptureObj.capture()
}catch(a){}g._dragOp=g._getDragOp(e);
g.__dragStartX=e.docX;
g.__dragStartY=e.docY
}else{if(g._dragBox){if(g._dragBox._setStart(e,g)){try{g._ctrlCaptureObj.capture()
}catch(a){}}}}return DwtControl.__mouseEvent(f,DwtEvent.ONMOUSEDOWN,g,e)
}catch(a){AjxException.reportScriptError(a)
}};
DwtControl.__mouseMoveHdlr=function(n){try{var h=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var g=h?h.targetObj:DwtControl.getTargetControl(n);
if(!g){return false
}if(g.__dndHoverActionId!=-1){AjxTimedAction.cancelAction(g.__dndHoverActionId);
g.__dndHoverActionId=-1
}var o=DwtShell.mouseEvent;
o.setFromDhtmlEvent(n,h?true:g);
if(o.docX<0||o.docY<0){o._stopPropagation=true;
o._returnValue=false;
o.setToDhtmlEvent(n);
return false
}var l=(g._dragSource&&h&&(Math.abs(g.__dragStartX-o.docX)>=DwtControl.__DRAG_THRESHOLD||Math.abs(g.__dragStartY-o.docY)>=DwtControl.__DRAG_THRESHOLD));
var p=(h&&g._dragBox&&g._dragBox._dragObj==g);
if(!l&&!p){if(g.__hasToolTipContent()){var j=DwtShell.getShell(window);
var d=j.getHoverMgr();
if(!g.__tooltipClosed&&!DwtMenu.menuShowing()){d.hoverOver(o.docX,o.docY)
}else{var e=g.__lastTooltipX?Math.abs(o.docX-g.__lastTooltipX):null;
var c=g.__lastTooltipY?Math.abs(o.docY-g.__lastTooltipY):null;
if((e!=null&&e>DwtControl.__TOOLTIP_THRESHOLD)||(c!=null&&c>DwtControl.__TOOLTIP_THRESHOLD)){d.setHoverOutListener(g._hoverOutListener);
d.hoverOut();
g.__tooltipClosed=true
}}}return DwtControl.__mouseEvent(n,DwtEvent.ONMOUSEMOVE,g,o)
}else{if(g._dragging==DwtControl._NO_DRAG){if(g._dragSource){g._dragOp=g._dragSource._beginDrag(g._dragOp,g);
if(g._dragOp!=Dwt.DND_DROP_NONE){g._dragging=DwtControl._DRAGGING;
g._dndProxy=g._getDragProxy(g._dragOp);
Dwt.addClass(g._dndProxy,"DwtDragProxy");
if(!g._dndProxy){g._dragging=DwtControl._DRAG_REJECTED
}}else{g._dragging=DwtControl._DRAG_REJECTED
}}else{if(g._dragBox){g._dragging=DwtControl._DRAGGING;
g._dragBox._beginDrag(g)
}}}if(g._dragging!=DwtControl._DRAG_REJECTED){var k=o.dwtObj;
if(g._dragSource){var a=k&&k._dropTarget;
var q=g.__lastTargetObj;
if(k){g._dndHoverAction.args=[k];
g.__dndHoverActionId=AjxTimedAction.scheduleAction(g._dndHoverAction,DwtControl.__DND_HOVER_DELAY)
}if(k&&a&&((k!=g)||a.hasMultipleTargets())){if(k!=q||a.hasMultipleTargets()){var f=g._dragSource._getData();
if(a._dragEnter(g._dragOp,k,f,o,g._dndProxy)){g._setDragProxyState(true);
g.__dropAllowed=true;
k._dragEnter(o)
}else{g._setDragProxyState(false);
g.__dropAllowed=false
}}else{if(g.__dropAllowed){k._dragOver(o)
}}}else{g._setDragProxyState(false)
}if(q&&q!=k&&q._dropTarget&&q!=g){if(k&&!k._dndScrollCallback&&q._dndScrollCallback){q._dndScrollCallback.run(o)
}q._dragLeave(o);
q._dropTarget._dragLeave()
}g.__lastTargetObj=k;
if((k!=g)&&k&&k._dndScrollCallback){k._dndScrollCallback.run(o)
}Dwt.setLocation(g._dndProxy,o.docX+2,o.docY+2)
}else{if(g._dragBox){var i=DwtUiEvent.getTarget(n);
if(k&&(Dwt.isAncestor(g.getHtmlElement(),i)||i==g._dragSelectionBox)){g._dragBox._dragMove(o,g)
}}}}else{DwtControl.__mouseEvent(n,DwtEvent.ONMOUSEMOVE,g,o)
}o._stopPropagation=true;
o._returnValue=false;
o.setToDhtmlEvent(n);
return false
}}catch(m){AjxException.reportScriptError(m)
}};
DwtControl.__mouseUpHdlr=function(e){try{var g=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var f=g?g.targetObj:DwtControl.getTargetControl(e);
if(!f){return false
}if(f.__dndHoverActionId!=-1){AjxTimedAction.cancelAction(f.__dndHoverActionId);
f.__dndHoverActionId=-1
}var d=DwtShell.mouseEvent;
d.setFromDhtmlEvent(e,g?true:f);
if(!(g&&(f._dragSource||f._dragBox))){return DwtControl.__processMouseUpEvent(e,f,d)
}else{g.release();
if(f._dragging!=DwtControl._DRAGGING){f._dragging=DwtControl._NO_DRAG;
return DwtControl.__processMouseUpEvent(e,f,d)
}if(f._dragSource){f.__lastTargetObj=null;
var c=d.dwtObj;
var h=c&&c._dropTarget;
if(c&&h&&f.__dropAllowed&&((c!=f)||h.hasMultipleTargets())){c._drop(d);
h._drop(f._dragSource._getData(),d);
f._dragSource._endDrag();
f._destroyDragProxy(f._dndProxy);
f._dragging=DwtControl._NO_DRAG
}else{DwtControl.__badDrop(f,d)
}if(c&&c._dndScrollCallback){c._dndScrollCallback.run(d)
}}else{if(f._dragBox){f._dragBox._endDrag(f)
}}d._stopPropagation=true;
d._returnValue=false;
d.setToDhtmlEvent(e);
return false
}}catch(a){AjxException.reportScriptError(a)
}};
DwtControl.__badDrop=function(e,d){if(e._dragSource){e._dragSource._cancelDrag()
}var c=d.dwtObj;
if(c){c._drop(d)
}e.__dragEndX=d.docX;
e.__dragEndY=d.docY;
if(e.__badDropAction==null){e.__badDropAction=new AjxTimedAction(e,e.__badDropEffect)
}var a=(e.__dragEndY-e.__dragStartY)/(e.__dragEndX-e.__dragStartX);
e.__badDropAction.args=[a,e.__dragStartY-(a*e.__dragStartX),(e.__dragStartX-e.__dragEndX<0)?-1:1];
AjxTimedAction.scheduleAction(e.__badDropAction,0)
};
DwtControl.__processMouseUpEvent=function(e,g,d){var c=DwtShell.getShell(window);
var f=c.getHoverMgr();
f.ignoreHoverOverOnClick();
if(g._dblClickIsolation&&d&&(d.button==DwtMouseEvent.LEFT)){if(g._clickPending){return false
}else{g._clickPending=true;
var a=new AjxTimedAction(null,DwtControl.__timedClick,[e,g,d]);
g._dblClickActionId=AjxTimedAction.scheduleAction(a,DwtControl.__DBL_CLICK_TIMEOUT);
DwtUiEvent.setBehaviour(e,true,false);
g._st=new Date();
return false
}}else{g._clickPending=false;
return DwtControl.__mouseEvent(e,DwtEvent.ONMOUSEUP,g,d)
}};
DwtControl.__timedClick=function(c,d,a){d._clickPending=false;
DwtControl.__mouseEvent(c,DwtEvent.ONMOUSEUP,d,a)
};
DwtControl.__mouseOutHdlr=function(g,f){try{var h=DwtControl.getTargetControl(g);
if(!h){return false
}f=f||DwtEvent.ONMOUSEOUT;
if((f==DwtEvent.ONMOUSEOUT)&&h._ignoreInternalOverOut){var a=DwtControl.getTargetControl(g,true);
if(h==a){return false
}}if(h.__hasToolTipContent()){var e=DwtShell.getShell(window);
var d=e.getHoverMgr();
d.setHoverOutListener(h._hoverOutListener);
d.hoverOut();
h.__tooltipClosed=false
}return DwtControl.__mouseEvent(g,f||DwtEvent.ONMOUSEOUT,h)
}catch(c){AjxException.reportScriptError(c)
}};
DwtControl.__mouseLeaveHdlr=function(a){return DwtControl.__mouseOutHdlr(a,DwtEvent.ONMOUSELEAVE)
};
DwtControl.__mouseWheelHdlr=function(c){try{return DwtControl.__mouseEvent(c,DwtEvent.ONMOUSEWHEEL)
}catch(a){AjxException.reportScriptError(a)
}};
DwtControl.__selectStartHdlr=function(c){try{return DwtControl.__mouseEvent(c,DwtEvent.ONSELECTSTART)
}catch(a){AjxException.reportScriptError(a)
}};
DwtControl.__contextMenuHdlr=function(d){try{if(AjxEnv.isSafari){var e=DwtControl.getTargetControl(d);
var a=e?e.preventContextMenu():true;
if(a){DwtControl.__mouseEvent(d,DwtEvent.ONMOUSEDOWN);
return DwtControl.__mouseEvent(d,DwtEvent.ONMOUSEUP)
}}return DwtControl.__mouseEvent(d,DwtEvent.ONCONTEXTMENU)
}catch(c){AjxException.reportScriptError(c)
}};
DwtControl.__mouseEvent=function(f,d,g,e){var g=g?g:DwtControl.getTargetControl(f);
if(!g){return false
}if(!e){e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(f,g)
}var c=e.target.tagName&&e.target.tagName.toLowerCase();
var a=g._propagateEvent[d]||(c==="input"||c==="textarea"||c==="a"||c==="label"||c==="select");
e._stopPropagation=!a;
e._dontCallPreventDefault=a;
e._returnValue=a;
DwtEventManager.notifyListeners(d,e);
if(g.isListenerRegistered&&g.isListenerRegistered(d)){g.notifyListeners(d,e)
}e.setToDhtmlEvent(f);
if(d==DwtEvent.ONMOUSELEAVE||d==DwtEvent.ONMOUSEOUT){g.__ignoreNextClick=false
}else{if(d==DwtEvent.ONMOUSEUP){g.__ignoreNextClick=true
}else{if(d==DwtEvent.ONCLICK){if(g.__ignoreNextClick){DBG.println(AjxDebug.ACCESSIBILITY,"DwtControl: ignoring a click!");
g.__ignoreNextClick=false;
return true
}if(g.isListenerRegistered&&!g.isListenerRegistered(DwtEvent.ONCLICK)){DBG.println(AjxDebug.ACCESSIBILITY,"DwtControl: faking a click!");
d=DwtEvent.ONMOUSEDOWN;
if(f){f.type=d
}DwtControl.__mouseEvent(f,d,g,DwtShell.mouseEvent);
d=DwtEvent.ONMOUSEUP;
if(f){f.type=d
}DwtControl.__mouseEvent(f,d,g,DwtShell.mouseEvent);
return DwtShell.mouseEvent._returnValue
}else{DBG.println(AjxDebug.ACCESSIBILITY,"DwtControl: skipping a click!");
window.console&&console.warn("skipping a click!")
}}}}return e._returnValue
};
DwtControl.__HANDLER={};
DwtControl.__HANDLER[DwtEvent.ONCONTEXTMENU]=DwtControl.__contextMenuHdlr;
DwtControl.__HANDLER[DwtEvent.ONCLICK]=DwtControl.__clickHdlr;
DwtControl.__HANDLER[DwtEvent.ONDBLCLICK]=DwtControl.__dblClickHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEDOWN]=DwtControl.__mouseDownHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEENTER]=DwtControl.__mouseEnterHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSELEAVE]=DwtControl.__mouseLeaveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEMOVE]=DwtControl.__mouseMoveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOUT]=DwtControl.__mouseOutHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOVER]=DwtControl.__mouseOverHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEUP]=DwtControl.__mouseUpHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEWHEEL]=DwtControl.__mouseWheelHdlr;
DwtControl.__HANDLER[DwtEvent.ONSELECTSTART]=DwtControl.__selectStartHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYPRESS]=DwtControl.__keyPressHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYUP]=DwtControl.__keyUpHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYDOWN]=DwtControl.__keyDownHdlr;
DwtControl.__HANDLER[DwtEvent.ONFOCUS]=DwtControl.__focusHdlr;
DwtControl.__HANDLER[DwtEvent.ONBLUR]=DwtControl.__blurHdlr;
DwtControl.prototype.__initCtrl=function(){this.shell=this.parent.shell||this.parent;
this._htmlElId=this.__internalId=this._htmlElId||Dwt.getNextId();
var a=this._elRef=this._createElement(this._htmlElId);
a.id=this._htmlElId;
if(DwtControl.ALL_BY_ID[this._htmlElId]){this._htmlElId=a.id=this.__internalId=DwtId.makeId(this._htmlElId,Dwt.getNextId())
}DwtControl.ALL_BY_ID[this._htmlElId]=this;
DwtComposite._pendingElements[this._htmlElId]=a;
a.style.position=this.__posStyle||DwtControl.STATIC_STYLE;
a.className=this._className;
a.style.overflow="visible";
if(this.role){a.setAttribute("role",this.role)
}this._enabled=true;
this.__controlEvent=DwtControl.__controlEvent;
this._dragging=DwtControl._NO_DRAG;
this.__ctrlInited=true;
this.setFocusElement();
this._focusAction=new AjxTimedAction(null,DwtControl.__focusHdlr,[DwtShell.focusEvent,DwtEvent.ONFOCUS,this]);
this._blurAction=new AjxTimedAction(null,DwtControl.__blurHdlr,[DwtShell.focusEvent,DwtEvent.ONBLUR,this]);
this.parent.addChild(this,this.__index)
};
DwtControl.prototype._createElement=function(a){return document.createElement("DIV")
};
DwtControl.prototype.__dndDoHover=function(a){a._dragHover()
};
DwtControl.prototype.__badDropEffect=function(a,h,f){var e=(Math.abs(a)<=1);
var g=e?this.__dragStartX-this.__dragEndX:this.__dragStartY-this.__dragEndY;
if(g*f>0&&!(this.__dragEndY==this.__dragStartY||this.__dragEndX==this.__dragStartX)){if(e){this.__dragEndX+=(30*f);
this._dndProxy.style.top=a*this.__dragEndX+h;
this._dndProxy.style.left=this.__dragEndX
}else{this.__dragEndY+=(30*f);
this._dndProxy.style.top=this.__dragEndY;
this._dndProxy.style.left=(this.__dragEndY-h)/a
}AjxTimedAction.scheduleAction(this.__badDropAction,0)
}else{this._destroyDragProxy(this._dndProxy);
this._dragging=DwtControl._NO_DRAG
}};
DwtControl.prototype.__handleHoverOver=function(e){if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROVER)){this._eventMgr.notifyListeners(DwtEvent.HOVEROVER,e)
}var d=e&&e.object;
var f=this.getToolTipContent(d);
var c,g;
if(!f){c=""
}else{if(typeof(f)=="string"){c=f
}else{if(f.isAjxCallback||AjxUtil.isFunction(f)){g=f
}else{if(typeof(f)=="object"){c=f.content;
g=f.callback
}}}}if(!c&&g&&f.loading){c=AjxMsg.loading
}if(c){this.__showToolTip(e,c)
}if(g){var a=new AjxCallback(this,this.__showToolTip,[e]);
AjxTimedAction.scheduleAction(new AjxTimedAction(null,function(){g.run(a)
}),0)
}};
DwtControl.prototype.__showToolTip=function(c,a){if(!a){return
}DwtControl.showToolTip(a,c.x,c.y,this,c);
this.__lastTooltipX=c.x;
this.__lastTooltipY=c.y;
this.__tooltipClosed=false
};
DwtControl.prototype.__handleHoverOut=function(a){if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROUT)){this._eventMgr.notifyListeners(DwtEvent.HOVEROUT,a)
}DwtControl.hideToolTip();
this.__lastTooltipX=null;
this.__lastTooltipY=null
};
DwtControl.prototype.__isInputEl=function(d){var e=false;
if(!d||!d.tagName){return e
}var a=d.tagName.toLowerCase();
var c=a=="input"?d.type.toLowerCase():null;
if(a=="textarea"||(c&&(c=="text"||c=="password"))){e=true
}return e
};
DwtControl.ON_UNLOAD=function(){var c=DwtControl.ALL_BY_ID,a;
for(a in c){c[a]._elRef=null
}DwtControl.ALL_BY_ID={}
};
if(window.attachEvent){window.attachEvent("onunload",DwtControl.ON_UNLOAD)
}else{if(window.addEventListener){window.addEventListener("unload",DwtControl.ON_UNLOAD,false)
}}DwtControl.showToolTip=function(c,a,g,e,f){if(!c){return
}var d=DwtShell.getShell(window).getToolTip();
d.setContent(c);
d.popup(a,g,false,false,e,f)
};
DwtControl.hideToolTip=function(){DwtShell.getShell(window).getToolTip().popdown()
};
DwtControl.prototype.getTooltipBase=function(a){return this.getHtmlElement()
};
DwtControl.prototype.boundsForChild=function(d){if(d&&d.getHtmlElement){d=d.getHtmlElement()
}var a=function(f,e){var g=Dwt.getMargins(e);
var f=Dwt.insetBounds(f,Dwt.getInsets(e));
f.width=Math.max(f.width-g.left-g.right,0);
f.height=Math.max(f.height-g.top-g.bottom,0);
return f
};
var c=new DwtRectangle(0,0,this.getHtmlElement().clientWidth,this.getHtmlElement().clientHeight);
return AjxUtil.reduce(Dwt.getAncestors(d,this.getHtmlElement(),true),a,c)
};
DwtControl.prototype.hasAttribute=function(a){return this.getHtmlElement().hasAttribute(a)
};
DwtControl.prototype.getAttribute=function(a){return this.getHtmlElement().getAttribute(a)
};
DwtControl.prototype.setAttribute=function(a,c){this.getHtmlElement().setAttribute(a,c)
};
DwtControl.prototype.removeAttribute=function(a){this.getHtmlElement().removeAttribute(a)
}
}if(AjxPackage.define("ajax.dwt.widgets.DwtComposite")){DwtComposite=function(c){if(arguments.length==0){return
}c=Dwt.getParams(arguments,DwtComposite.PARAMS);
c.className=c.className||"DwtComposite";
DwtControl.call(this,c);
var a=this.toString();
if(a=="DwtComposite"){a=this.getHTMLElId()
}this._compositeTabGroup=new DwtTabGroup(a+" (DwtComposite)");
this._children=new AjxVector()
};
DwtComposite.PARAMS=DwtControl.PARAMS.concat();
DwtComposite.prototype=new DwtControl;
DwtComposite.prototype.constructor=DwtComposite;
DwtComposite.prototype.isDwtComposite=true;
DwtComposite.prototype.toString=function(){return"DwtComposite"
};
DwtComposite._pendingElements=new Object();
DwtComposite.prototype.dispose=function(){if(this._disposed){return
}var a=this._children.getArray();
while(a.length>0){a.pop().dispose()
}if(this._compositeTabGroup){this._compositeTabGroup.removeAllMembers()
}this._compositeTabGroup=null;
DwtControl.prototype.dispose.call(this)
};
DwtComposite.prototype.getChildren=function(){return this._children.getArray().slice(0)
};
DwtComposite.prototype.getChild=function(a){return this._children.get(a)
};
DwtComposite.prototype.cleanupSeparators=function(){var c=this.getChildren();
var d=true;
var f;
for(var e=0;
e<c.length;
e++){var g=c[e];
var a=g.isStyle&&g.isStyle(DwtMenuItem.SEPARATOR_STYLE);
if(a){g.setVisible(!d);
if(!d||!f){d=true;
f=g
}continue
}if(g.getVisible()){d=false
}}if(d&&f){f.setVisible(false)
}};
DwtComposite.prototype.getNumChildren=function(){return this._children.size()
};
DwtComposite.prototype.removeChildren=function(){var c=this._children.getArray();
while(c.length>0){c[0].dispose()
}if(this._compositeTabGroup){this._compositeTabGroup.removeAllMembers()
}};
DwtComposite.prototype.clear=function(){this.removeChildren();
this.getHtmlElement().innerHTML=""
};
DwtComposite.prototype.addChild=function(d,a){this._children.add(d,a);
this._compositeTabGroup.addMember(d,a);
var c=d.getHtmlElement();
c.setAttribute("parentId",this._htmlElId);
if(this instanceof DwtShell&&this.isVirtual()){document.body.appendChild(c)
}else{d.reparentHtmlElement(d.__parentElement||this.getHtmlElement(),a);
d.__parentElement=null
}};
DwtComposite.prototype.removeChild=function(d){if(d.isInitialized()){this._children.remove(d);
this._compositeTabGroup.removeMember(d);
var c=d.getHtmlElement();
if(c){c.removeAttribute("parentId");
if(c.parentNode){var a=c.parentNode.removeChild(c)
}}}};
DwtComposite.prototype.getTabGroupMember=function(){return this.tabGroupMember||(this.getNumChildren()>0?this._compositeTabGroup:this)
};
DwtComposite.prototype._setAllowSelection=function(){if(!this._allowSelection){this._allowSelection=true;
this.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));
this.addListener(DwtEvent.ONCONTEXTMENU,new AjxListener(this,this._contextMenuListener))
}};
DwtComposite.prototype.preventSelection=function(a){return this._allowSelection?false:DwtControl.prototype.preventSelection.call(this,a)
};
DwtComposite.prototype.preventContextMenu=function(d){if(!this._allowSelection){return DwtControl.prototype.preventContextMenu.apply(this,arguments)
}var a=d?(d.id.indexOf("OBJ_")==0):false;
var c=false;
if(document.selection){c=document.selection.type=="Text"
}else{if(getSelection()){c=getSelection().toString().length>0
}}return(c&&!a)?false:true
};
DwtComposite.prototype._focusByMouseUpEvent=function(){if(!this._allowSelection){DwtControl.prototype._focusByMouseUpEvent.apply(this,arguments)
}};
DwtComposite.prototype._mouseDownListener=function(a){if(a.button==DwtMouseEvent.LEFT){a._stopPropagation=true;
a._returnValue=true
}};
DwtComposite.prototype._contextMenuListener=function(a){a._stopPropagation=false;
a._returnValue=true
}
}if(AjxPackage.define("ajax.dwt.widgets.DwtBaseDialog")){DwtBaseDialog=function(c){if(arguments.length==0){return
}c=Dwt.getParams(arguments,DwtBaseDialog.PARAMS);
var a=c.parent;
if(!(a instanceof DwtShell)){throw new DwtException("DwtBaseDialog parent must be a DwtShell",DwtException.INVALIDPARENT,"DwtDialog")
}c.className=c.className||"DwtBaseDialog";
c.posStyle=DwtControl.ABSOLUTE_STYLE;
c.isFocusable=false;
this._title=c.title||"";
DwtComposite.call(this,c);
this._disposeOnPopDown=c.disposeOnPopDown||false;
this._shell=a;
this._zIndex=c.zIndex||Dwt.Z_DIALOG;
this._mode=c.mode||DwtBaseDialog.MODAL;
this._loc=new DwtPoint();
if(c.loc){this._loc.x=c.loc.x;
this._loc.y=c.loc.y
}else{this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
}this._tabGroup=new DwtTabGroup(this.toString());
this._dragHandleId=c.dragHandleId||this._htmlElId+"_handle";
this._createHtml();
this._initializeDragging(this._dragHandleId);
if(c.view){this.setView(c.view)
}this.setZIndex(Dwt.Z_HIDDEN);
this.setVisible(true);
this._position(DwtBaseDialog.__nowhereLoc);
this._propagateEvent[DwtEvent.ONMOUSEUP]=true;
this.shellResizeHandler=this._resizeHdlr.bind(this)
};
DwtBaseDialog.PARAMS=["parent","className","title","zIndex","mode","loc","view","dragHandleId","id"];
DwtBaseDialog.prototype=new DwtComposite;
DwtBaseDialog.prototype.constructor=DwtBaseDialog;
DwtBaseDialog.prototype.toString=function(){return"DwtBaseDialog"
};
DwtBaseDialog.prototype.isDwtBaseDialog=true;
DwtBaseDialog.prototype.role="dialog";
DwtBaseDialog.prototype.isFocusable=true;
DwtBaseDialog.MODELESS=1;
DwtBaseDialog.MODAL=2;
DwtBaseDialog.__nowhereLoc=new DwtPoint(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
DwtBaseDialog.prototype.TEMPLATE="dwt.Widgets#DwtBaseDialog";
DwtBaseDialog.prototype.CONTROLS_TEMPLATE=null;
DwtBaseDialog.prototype.addPopupListener=function(a){this.addListener(DwtEvent.POPUP,a)
};
DwtBaseDialog.prototype.removePopupListener=function(a){this.removeListener(DwtEvent.POPUP,a)
};
DwtBaseDialog.prototype.addPopdownListener=function(a){this.addListener(DwtEvent.POPDOWN,a)
};
DwtBaseDialog.prototype.removePopdownListener=function(a){this.removeListener(DwtEvent.POPDOWN,a)
};
DwtBaseDialog.prototype.popup=function(c){if(this._poppedUp){return
}this.cleanup(true);
var a=this._zIndex;
if(this._mode==DwtBaseDialog.MODAL){a=this._setModalEffect(a)
}this._shell._veilOverlay.activeDialogs.push(this);
this.setVisible(true);
if(c){this._loc.x=c.x;
this._loc.y=c.y
}this._position(c);
this._resetTabFocus();
this.setZIndex(a);
this._poppedUp=true;
var d=this._shell.getKeyboardMgr();
d.pushTabGroup(this._tabGroup);
d.pushDefaultHandler(this);
DwtShell.getShell().addListener(DwtEvent.CONTROL,this.shellResizeHandler);
this.notifyListeners(DwtEvent.POPUP,this)
};
DwtBaseDialog.prototype._resetTabFocus=function(){this._tabGroup.resetFocusMember(true)
};
DwtBaseDialog.prototype.focus=function(){if(this.isListenerRegistered(DwtEvent.ONFOCUS)){this.notifyListeners(DwtEvent.ONFOCUS)
}else{if(this._focusElementId){var a=document.getElementById(this._focusElementId);
if(a){a.focus();
return a
}}}};
DwtBaseDialog.prototype.isPoppedUp=function(){return this._poppedUp
};
DwtBaseDialog.prototype.popdown=function(){if(this._poppedUp){this._poppedUp=false;
this.cleanup(false);
var a=this._zIndex;
this.setZIndex(Dwt.Z_HIDDEN);
this.setVisible(false);
this._position(DwtBaseDialog.__nowhereLoc);
if(this._mode==DwtBaseDialog.MODAL){this._undoModality(a)
}else{this._shell._veilOverlay.activeDialogs.pop()
}if(this._disposeOnPopDown===true){this.dispose()
}var c=this._shell.getKeyboardMgr();
c.popTabGroup(this._tabGroup);
c.popDefaultHandler();
DwtShell.getShell().removeListener(DwtEvent.CONTROL,this.shellResizeHandler);
this.notifyListeners(DwtEvent.POPDOWN,this)
}};
DwtBaseDialog.prototype.setView=function(a){this.reset();
if(a){this._getContentDiv().appendChild(a.getHtmlElement())
}};
DwtBaseDialog.prototype.reset=function(){this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
};
DwtBaseDialog.prototype.cleanup=function(c){var e=this._getInputFields();
if(e){var a=e.length;
for(var d=0;
d<a;
d++){e[d].disabled=!c;
if(c){e[d].value=""
}}}};
DwtBaseDialog.prototype.setTitle=function(a){if(this._titleEl){this._titleEl.innerHTML=a||""
}this._title=a
};
DwtBaseDialog.prototype.setContent=function(c){var a=this._getContentDiv();
if(a){a.innerHTML=c||""
}};
DwtBaseDialog.prototype._getContentDiv=function(){return this._contentEl
};
DwtBaseDialog.prototype.addEnterListener=function(a){this.addListener(DwtEvent.ENTER,a)
};
DwtBaseDialog.getActiveDialog=function(){var c=null;
var d=DwtShell.getShell(window);
if(d){var a=d._veilOverlay.activeDialogs.length;
if(a>0){c=d._veilOverlay.activeDialogs[a-1]
}}return c
};
DwtBaseDialog.prototype.getTabGroupMember=function(){return this._tabGroup
};
DwtBaseDialog.prototype._initializeDragging=function(i){var h=document.getElementById(i);
if(h){var g=DwtControl.fromElementId(window._dwtShellId);
if(g){var a=Dwt.getSize(g.getHtmlElement());
var d=document.getElementById(this._htmlElId);
var j=this.getSize();
var f=new AjxCallback(this,this._dragEnd);
var e=new AjxCallback(this,this._duringDrag);
var c=new AjxCallback(this,this._dragStart);
DwtDraggable.init(h,d,0,document.body.offsetWidth-10,0,document.body.offsetHeight-10,c,e,f)
}}};
DwtBaseDialog.prototype._getContentHtml=function(){return""
};
DwtBaseDialog.prototype._createHtml=function(a){var c={id:this._htmlElId};
this._createHtmlFromTemplate(a||this.TEMPLATE,c)
};
DwtBaseDialog.prototype._createHtmlFromTemplate=function(a,c){c.dragId=this._dragHandleId;
c.title=this._title;
c.icon="";
c.closeIcon1="";
c.closeIcon2="";
c.controlsTemplateId=this.CONTROLS_TEMPLATE;
DwtComposite.prototype._createHtmlFromTemplate.call(this,a,c);
this._titleBarEl=document.getElementById(c.id+"_titlebar");
this._titleEl=document.getElementById(c.id+"_title");
this._contentEl=document.getElementById(c.id+"_content");
if(this._titleEl){this.setAttribute("aria-labelledby",this._titleEl.id);
this._titleEl.setAttribute("role","heading");
this._titleEl.setAttribute("aria-level","2")
}this.setContent(this._getContentHtml())
};
DwtBaseDialog.prototype._setModalEffect=function(){var d=this._shell._veilOverlay.dialogZ;
var e=null;
var c,a;
if(d.length){e=d[d.length-1]
}if(e){c=e+2;
a=e+1
}else{c=this._zIndex;
a=Dwt.Z_VEIL
}this._shell._veilOverlay.veilZ.push(a);
this._shell._veilOverlay.dialogZ.push(c);
Dwt.setZIndex(this._shell._veilOverlay,a);
return c
};
DwtBaseDialog.prototype._undoModality=function(d){var a=this._shell._veilOverlay.veilZ;
a.pop();
var c=a[a.length-1];
Dwt.setZIndex(this._shell._veilOverlay,c);
this._shell._veilOverlay.dialogZ.pop();
this._shell._veilOverlay.activeDialogs.pop();
if(this._shell._veilOverlay.activeDialogs.length>0){this._shell._veilOverlay.activeDialogs[0].focus()
}};
DwtBaseDialog.prototype._getInputFields=function(){};
DwtBaseDialog.prototype._resizeHdlr=function(a){if(this._loc.x===Dwt.LOC_NOWHERE&&this._loc.y===Dwt.LOC_NOWHERE){this._position()
}};
DwtBaseDialog.prototype._dragStart=function(a,e){if(AjxEnv.isNav&&!this._ignoreSetDragBoundries){this._currSize=this.getSize();
var d=DwtControl.fromElementId(window._dwtShellId);
if(d){var c=Dwt.getSize(d.getHtmlElement());
DwtDraggable.setDragBoundaries(DwtDraggable.dragEl,0,c.x-this._currSize.x,0,c.y-this._currSize.y)
}}};
DwtBaseDialog.prototype._dragEnd=function(a,c){this._loc.x=a;
this._loc.y=c
};
DwtBaseDialog.prototype._duringDrag=function(a,c){};
DwtBaseDialog.prototype._doesContainElement=function(a){return Dwt.contains(this.getHtmlElement(),a)
}
}if(AjxPackage.define("ajax.dwt.widgets.DwtDialog")){DwtDialog=function(c){if(arguments.length==0){return
}c=Dwt.getParams(arguments,DwtDialog.PARAMS);
c.className=c.className||"DwtDialog";
this._title=c.title=c.title||"";
var d=c.standardButtons;
var k=c.extraButtons;
if(!d){d=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]
}else{if(d==DwtDialog.NO_BUTTONS){d=null
}else{if(d&&!d.length){d=[d]
}}}this._buttonList=[];
var m={};
m[DwtDialog.ALIGN_LEFT]=[];
m[DwtDialog.ALIGN_CENTER]=[];
m[DwtDialog.ALIGN_RIGHT]=[];
if(d||k){this._buttonDesc={};
if(d&&d.length){this._initialEnterButtonId=this._enterButtonId=d[0];
for(var e=0;
e<d.length;
e++){var j=d[e];
this._buttonList.push(j);
var h=DwtDialog.ALIGN[j];
if(h){m[h].push(j)
}this._buttonDesc[j]=new DwtDialog_ButtonDescriptor(j,AjxMsg[DwtDialog.MSG_KEY[j]],h)
}this._resetCallbacks()
}if(k&&k.length){if(!this._enterButtonId){this._initialEnterButtonId=this._enterButtonId=k[0]
}for(var e=0;
e<k.length;
e++){var j=k[e].id;
this._buttonList.push(j);
var h=k[e].align;
if(h){m[h].push(j)
}this._buttonDesc[j]=k[e]
}}}this._buttonElementId={};
for(var e=0;
e<this._buttonList.length;
e++){var j=this._buttonList[e];
this._buttonElementId[j]=this._buttonDesc[j].label?this._buttonDesc[j].label+"_"+Dwt.getNextId():Dwt.getNextId()
}DwtBaseDialog.call(this,c);
this._button={};
for(var e=0;
e<this._buttonList.length;
e++){var j=this._buttonList[e];
var l=this._button[j]=new DwtButton({parent:this,id:this._htmlElId+"_button"+j});
l.setText(this._buttonDesc[j].label);
l.buttonId=j;
l.addSelectionListener(new AjxListener(this,this._buttonListener));
var a=document.getElementById(this._buttonElementId[j]);
if(a){a.appendChild(l.getHtmlElement())
}}var g=m[DwtDialog.ALIGN_LEFT].concat(m[DwtDialog.ALIGN_CENTER],m[DwtDialog.ALIGN_RIGHT]);
for(var e=0;
e<g.length;
e++){var f=this._button[g[e]];
this._tabGroup.addMember(f)
}};
DwtDialog.PARAMS=["parent","className","title","standardButtons","extraButtons","zIndex","mode","loc","id"];
DwtDialog.prototype=new DwtBaseDialog;
DwtDialog.prototype.constructor=DwtDialog;
DwtDialog.prototype.isDwtDialog=true;
DwtDialog.prototype.toString=function(){return"DwtDialog"
};
DwtDialog.ALIGN_LEFT=1;
DwtDialog.ALIGN_RIGHT=2;
DwtDialog.ALIGN_CENTER=3;
DwtDialog.CANCEL_BUTTON=1;
DwtDialog.OK_BUTTON=2;
DwtDialog.DISMISS_BUTTON=3;
DwtDialog.NO_BUTTON=4;
DwtDialog.YES_BUTTON=5;
DwtDialog.LAST_BUTTON=5;
DwtDialog.NO_BUTTONS=256;
DwtDialog.ALL_BUTTONS=[DwtDialog.CANCEL_BUTTON,DwtDialog.OK_BUTTON,DwtDialog.DISMISS_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.YES_BUTTON];
DwtDialog.MSG_KEY={};
DwtDialog.MSG_KEY[DwtDialog.CANCEL_BUTTON]="cancel";
DwtDialog.MSG_KEY[DwtDialog.OK_BUTTON]="ok";
DwtDialog.MSG_KEY[DwtDialog.DISMISS_BUTTON]="close";
DwtDialog.MSG_KEY[DwtDialog.NO_BUTTON]="no";
DwtDialog.MSG_KEY[DwtDialog.YES_BUTTON]="yes";
DwtDialog.ALIGN={};
DwtDialog.ALIGN[DwtDialog.CANCEL_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.OK_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.DISMISS_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.NO_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.YES_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.MODELESS=DwtBaseDialog.MODELESS;
DwtDialog.MODAL=DwtBaseDialog.MODAL;
DwtDialog.prototype.CONTROLS_TEMPLATE="dwt.Widgets#DwtDialogControls";
DwtDialog.prototype.popdown=function(){DwtBaseDialog.prototype.popdown.call(this);
if(!this._disposeOnPopDown){this.resetButtonStates()
}};
DwtDialog.prototype.popup=function(a,c){this._focusButtonId=c;
DwtBaseDialog.prototype.popup.call(this,a)
};
DwtDialog.prototype._resetTabFocus=function(){if(this._focusButtonId){var a=this.getButton(this._focusButtonId);
this._tabGroup.setFocusMember(a,true)
}else{DwtBaseDialog.prototype._resetTabFocus.call(this)
}};
DwtDialog.prototype.reset=function(){this._resetCallbacks();
this.resetButtonStates();
DwtBaseDialog.prototype.reset.call(this)
};
DwtDialog.prototype.resetButtonStates=function(){for(b in this._button){this._button[b].setEnabled(true);
this._button[b].setHovered(false)
}this.associateEnterWithButton(this._initialEnterButtonId)
};
DwtDialog.prototype.getButton=function(a){return this._button[a]
};
DwtDialog.prototype.setButtonEnabled=function(c,a){if(!this._button[c]){return
}this._button[c].setEnabled(a)
};
DwtDialog.prototype.setButtonVisible=function(a,c){if(!this._button[a]){return
}this._button[a].setVisible(c)
};
DwtDialog.prototype.getButtonEnabled=function(a){return this._button[a].getEnabled()
};
DwtDialog.prototype.registerCallback=function(c,d,e,a){this._buttonDesc[c].callback=(d&&(d.isAjxCallback||(!e&&!a)))?d:(new AjxCallback(e,d,a))
};
DwtDialog.prototype.unregisterCallback=function(a){this._buttonDesc[a].callback=null
};
DwtDialog.prototype.setButtonListener=function(a,c){this._button[a].removeSelectionListeners();
this._button[a].addSelectionListener(c)
};
DwtDialog.prototype.setEnterListener=function(a){this.removeAllListeners(DwtEvent.ENTER);
this.addEnterListener(a)
};
DwtDialog.prototype.associateEnterWithButton=function(a){this._enterButtonId=a
};
DwtDialog.prototype.getKeyMapName=function(){return DwtKeyMap.MAP_DIALOG
};
DwtDialog.prototype.handleKeyAction=function(a,c){switch(a){case DwtKeyMap.ENTER:this.notifyListeners(DwtEvent.ENTER,c);
break;
case DwtKeyMap.CANCEL:var d=false;
d=d||this._runCallbackForButtonId(DwtDialog.CANCEL_BUTTON);
d=d||this._runCallbackForButtonId(DwtDialog.NO_BUTTON);
d=d||this._runCallbackForButtonId(DwtDialog.DISMISS_BUTTON);
if(!d&&this._buttonDesc[DwtDialog.OK_BUTTON]&&this._buttonList.length==1){d=d||this._runCallbackForButtonId(DwtDialog.OK_BUTTON)
}this.popdown();
return true;
case DwtKeyMap.YES:if(this._buttonDesc[DwtDialog.YES_BUTTON]){this._runCallbackForButtonId(DwtDialog.YES_BUTTON)
}break;
case DwtKeyMap.NO:if(this._buttonDesc[DwtDialog.NO_BUTTON]){this._runCallbackForButtonId(DwtDialog.NO_BUTTON)
}break;
default:return false
}return true
};
DwtDialog.prototype._createHtmlFromTemplate=function(d,f){DwtBaseDialog.prototype._createHtmlFromTemplate.call(this,d,f);
var e=f.id+"_focus";
if(document.getElementById(e)){this._focusElementId=e
}this._buttonsEl=document.getElementById(f.id+"_buttons");
if(this._buttonsEl){var c=[];
var a=0;
this._addButtonsHtml(c,a);
this._buttonsEl.innerHTML=c.join("")
}};
DwtDialog.prototype._getButtonsContainerStartTemplate=function(){return"<table role='presentation' width='100%'><tr>"
};
DwtDialog.prototype._getButtonsAlignStartTemplate=function(){return"<td align=\"{0}\"><table role='presentation'><tr>"
};
DwtDialog.prototype._getButtonsAlignEndTemplate=function(){return"</tr></table></td>"
};
DwtDialog.prototype._getButtonsCellTemplate=function(){return'<td id="{0}"></td>'
};
DwtDialog.prototype._getButtonsContainerEndTemplate=function(){return"</tr></table>"
};
DwtDialog.prototype._addButtonsHtml=function(g,c){if(this._buttonList&&this._buttonList.length){var d=new Array();
var a=new Array();
var f=new Array();
for(var e=0;
e<this._buttonList.length;
e++){var h=this._buttonList[e];
switch(this._buttonDesc[h].align){case DwtDialog.ALIGN_RIGHT:a.push(h);
break;
case DwtDialog.ALIGN_LEFT:d.push(h);
break;
case DwtDialog.ALIGN_CENTER:f.push(h);
break
}}g[c++]=this._getButtonsContainerStartTemplate();
if(d.length){g[c++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["left"]);
for(var e=0;
e<d.length;
e++){var h=d[e];
var j=this._buttonDesc[h].cellTemplate?this._buttonDesc[h].cellTemplate:this._getButtonsCellTemplate();
g[c++]=AjxMessageFormat.format(j,[this._buttonElementId[h]])
}g[c++]=this._getButtonsAlignEndTemplate()
}if(f.length){g[c++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["center"]);
for(var e=0;
e<f.length;
e++){var h=f[e];
var j=this._buttonDesc[h].cellTemplate?this._buttonDesc[h].cellTemplate:this._getButtonsCellTemplate();
g[c++]=AjxMessageFormat.format(j,[this._buttonElementId[h]])
}g[c++]=this._getButtonsAlignEndTemplate()
}if(a.length){g[c++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["right"]);
for(var e=0;
e<a.length;
e++){var h=a[e];
var j=this._buttonDesc[h].cellTemplate?this._buttonDesc[h].cellTemplate:this._getButtonsCellTemplate();
g[c++]=AjxMessageFormat.format(j,[this._buttonElementId[h]])
}g[c++]=this._getButtonsAlignEndTemplate()
}g[c++]=this._getButtonsContainerEndTemplate()
}return c
};
DwtDialog.prototype._buttonListener=function(d,a){var e=DwtControl.getTargetControl(d);
var c=(e&&e.buttonId)||this._enterButtonId;
if(c){this._runCallbackForButtonId(c,a)
}};
DwtDialog.prototype._runCallbackForButtonId=function(e,a){var c=this._buttonDesc[e];
var d=c&&c.callback;
if(!d){return false
}a=(a instanceof Array)?a:[a];
d.run.apply(d,a);
return true
};
DwtDialog.prototype._runEnterCallback=function(a){if(this._enterButtonId&&this.getButtonEnabled(this._enterButtonId)){this._runCallbackForButtonId(this._enterButtonId,a)
}};
DwtDialog.prototype._resetCallbacks=function(){if(this._buttonDesc){for(var a=0;
a<DwtDialog.ALL_BUTTONS.length;
a++){var c=DwtDialog.ALL_BUTTONS[a];
if(this._buttonDesc[c]){this._buttonDesc[c].callback=new AjxCallback(this,this.popdown)
}}}};
DwtDialog_ButtonDescriptor=function(f,a,e,d,c){this.id=f;
this.label=a;
this.align=e;
this.callback=d;
this.cellTemplate=c
}
}if(AjxPackage.define("ajax.dwt.widgets.DwtToolTip")){DwtToolTip=function(f,g,e){if(arguments.length==0){return
}this.shell=f;
this._dialog=e;
this._poppedUp=false;
this._div=document.createElement("div");
this._div.className=g||"DwtToolTip";
this._div.style.position=DwtControl.ABSOLUTE_STYLE;
this.shell.getHtmlElement().appendChild(this._div);
Dwt.setZIndex(this._div,Dwt.Z_HIDDEN);
Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._eventMgr=new AjxEventMgr();
var d="dwt.Widgets#DwtToolTip";
this._div.innerHTML=AjxTemplate.expand(d);
var j=AjxTemplate.getParams(d);
this._offsetX=(j.width!=null)?Number(j.width):DwtToolTip.POPUP_OFFSET_X;
this._offsetY=(j.height!=null)?Number(j.height):DwtToolTip.POPUP_OFFSET_Y;
this._contentDiv=document.getElementById("tooltipContents");
Dwt.setHandler(this._div,DwtEvent.ONMOUSEOVER,AjxCallback.simpleClosure(this._mouseOverListener,this));
Dwt.setHandler(this._div,DwtEvent.ONMOUSEOUT,AjxCallback.simpleClosure(this._mouseOutListener,this));
var c=[DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEWHEEL,DwtEvent.ONSCROLL];
for(var a=0;
a<c.length;
a++){var h=c[a];
Dwt.setHandler(this._div,h,AjxCallback.simpleClosure(this.notifyListeners,this,[h]))
}};
DwtToolTip.prototype.isDwtToolTip=true;
DwtToolTip.prototype.toString=function(){return"DwtToolTip"
};
DwtToolTip.TOOLTIP_DELAY=750;
DwtToolTip.WINDOW_GUTTER=5;
DwtToolTip.POPUP_OFFSET_X=5;
DwtToolTip.POPUP_OFFSET_Y=5;
DwtToolTip.prototype.getContent=function(){return this._div.innerHTML
};
DwtToolTip.prototype.setContent=function(c,a){this._content=c;
if(a){this._contentDiv.innerHTML=this._content
}};
DwtToolTip.prototype.popup=function(a,h,c,d,e,g,f){this._hovered=false;
if(this._popupAction){AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}this._popdownOnMouseOver=d;
this._popdownListener=f;
if(this._content!=null){if(!c){this._contentDiv.innerHTML=this._content
}this._popupAction=new AjxTimedAction(this,this._positionElement,[a,h,e,g]);
AjxTimedAction.scheduleAction(this._popupAction,5)
}};
DwtToolTip.prototype.setSticky=function(a){this._poppedUp=!a
};
DwtToolTip.prototype.popdown=function(){this._popdownOnMouseOver=false;
this._hovered=false;
if(this._popupAction){AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}if(this._content!=null&&this._poppedUp){Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._poppedUp=false;
if(this._popdownListener instanceof AjxCallback){this._popdownListener.run()
}this._popdownListener=null
}};
DwtToolTip.prototype._positionElement=function(h,g,f,i){this._popupAction=null;
var d=DwtShell.getShell(window).getSize();
var c=d.x,o=d.y;
var p,n,a;
var q=f&&f.getTooltipBase(i);
if(q){a=Dwt.toWindow(q);
var e=Dwt.getSize(q);
p=a.x+this._offsetX;
n=a.y+e.y+this._offsetY
}else{p=h+this._offsetX;
n=g+this._offsetY
}var l=Dwt.getSize(this._div);
var m=l.x,j=l.y;
if(p+m>c-DwtToolTip.WINDOW_GUTTER){p=c-DwtToolTip.WINDOW_GUTTER-m
}if(n+j>o-DwtToolTip.WINDOW_GUTTER){n=(a?a.y:n)-this._offsetY-j
}Dwt.setLocation(this._div,p,n);
var k=this._dialog?this._dialog.getZIndex()+Dwt._Z_INC:Dwt.Z_TOOLTIP;
Dwt.setZIndex(this._div,k);
this._poppedUp=true
};
DwtToolTip.prototype._mouseOverListener=function(a){this._hovered=true;
if(this._popdownOnMouseOver&&this._poppedUp){var c=(this._popdownOnMouseOver.isAjxCallback||AjxUtil.isFunction(this._popdownOnMouseOver))?this._popdownOnMouseOver:null;
this.popdown();
if(c){c.run()
}}this.notifyListeners(DwtEvent.ONMOUSEOVER)
};
DwtToolTip.prototype._mouseOutListener=function(d){d=DwtUiEvent.getEvent(d,this._div);
var a=Dwt.toWindow(this._div);
var c=Dwt.getSize(this._div);
if(d.clientX<=a.x||d.clientX>=(a.x+c.x)||d.clientY<=a.y||d.clientY>=(a.y+c.y)){this.popdown();
this.notifyListeners(DwtEvent.ONMOUSEOUT)
}};
DwtToolTip.prototype.getHovered=function(){return this._hovered
};
DwtToolTip.prototype.addListener=function(c,d,a){return this._eventMgr.addListener(c,d,a)
};
DwtToolTip.prototype.setListener=function(c,d,a){this.removeAllListeners(c);
return this._eventMgr.addListener(c,d,a)
};
DwtToolTip.prototype.removeListener=function(a,c){return this._eventMgr.removeListener(a,c)
};
DwtToolTip.prototype.removeAllListeners=function(a){return this._eventMgr.removeAll(a)
};
DwtToolTip.prototype.isListenerRegistered=function(a){return this._eventMgr.isListenerRegistered(a)
};
DwtToolTip.prototype.notifyListeners=function(a,c){return this._eventMgr.notifyListeners(a,c)
}
}if(AjxPackage.define("ajax.dwt.widgets.DwtHoverMgr")){DwtHoverMgr=function(){this._hoverOverAction=new AjxTimedAction(this,this._notifyHoverOver);
this._hoverOutAction=new AjxTimedAction(this,this._notifyHoverOut);
this._ignoreHoverOverOnClickAction=new AjxTimedAction(this,this._resetIgnoreHoverOverOnClick)
};
DwtHoverMgr.prototype.isDwtHoverMgr=true;
DwtHoverMgr.prototype.toString=function(){return"DwtHoverMgr"
};
DwtHoverMgr.prototype._hoverOverDelay=750;
DwtHoverMgr.prototype._hoverOverActionId=-1;
DwtHoverMgr.prototype._hoverOutDelay=50;
DwtHoverMgr.prototype._ignoreHoverOverOnClickDelay=750;
DwtHoverMgr.prototype._hoverOutActionId=-1;
DwtHoverMgr.prototype._isHovering=false;
DwtHoverMgr.prototype.setHoverObject=function(a){this._hoverObject=a
};
DwtHoverMgr.prototype.getHoverObject=function(){return this._hoverObject
};
DwtHoverMgr.prototype.reset=function(){this._hoverObject=null;
this._hoverOverDelay=DwtHoverMgr.prototype._hoverOverDelay;
this._hoverOverData=null;
if(this._hoverOverActionId!=-1){AjxTimedAction.cancelAction(this._hoverOverActionId)
}this._hoverOverActionId=-1;
this._hoverOverListener=null;
this._hoverOutDelay=DwtHoverMgr.prototype._hoverOutDelay;
this._hoverOutData=null;
if(this._hoverOutActionId!=-1){AjxTimedAction.cancelAction(this._hoverOutActionId);
this._notifyHoverOut()
}this._hoverOutActionId=-1;
this._hoverOutListener=null
};
DwtHoverMgr.prototype.isHovering=function(){return this._isHovering
};
DwtHoverMgr.prototype.setHoverOverDelay=function(a){this._hoverOverDelay=a
};
DwtHoverMgr.prototype.setHoverOverData=function(a){this._hoverOverData=a
};
DwtHoverMgr.prototype.setHoverOverListener=function(a){this._hoverOverListener=a
};
DwtHoverMgr.prototype.setHoverOutDelay=function(a){this._hoverOutDelay=a
};
DwtHoverMgr.prototype.setHoverOutData=function(a){this._hoverOutData=a
};
DwtHoverMgr.prototype.setHoverOutListener=function(a){this._hoverOutListener=a
};
DwtHoverMgr.prototype.ignoreHoverOverOnClick=function(){this._ignoreHoverOverOnClick=true;
AjxTimedAction.scheduleAction(this._ignoreHoverOverOnClickAction,this._ignoreHoverOverOnClickDelay)
};
DwtHoverMgr.prototype._resetIgnoreHoverOverOnClick=function(){this._ignoreHoverOverOnClick=false
};
DwtHoverMgr.prototype.hoverOver=function(a,c){if(this._ignoreHoverOverOnClick){return
}this._isHovering=true;
if(this._hoverOverActionId!=-1){AjxTimedAction.cancelAction(this._hoverOverActionId)
}this._hoverOverAction.args=[a,c];
this._hoverOverActionId=AjxTimedAction.scheduleAction(this._hoverOverAction,this._hoverOverDelay)
};
DwtHoverMgr.prototype.hoverOut=function(){this._isHovering=false;
if(this._hoverOverActionId!=-1){AjxTimedAction.cancelAction(this._hoverOverActionId)
}if(this._hoverOutActionId==-1){if(this._hoverOutDelay>0){this._hoverOutActionId=AjxTimedAction.scheduleAction(this._hoverOutAction,this._hoverOutDelay)
}else{this._notifyHoverOut()
}}};
DwtHoverMgr.prototype._notifyHoverOver=function(){this._hoverOverActionId=-1;
if(this._hoverOverListener!=null){var a=this._hoverOverAction.args[0];
var d=this._hoverOverAction.args[1];
var c=new DwtHoverEvent(DwtEvent.HOVEROVER,this._hoverOverDelay,this._hoverOverData,a,d);
this._hoverOverListener.handleEvent(c)
}};
DwtHoverMgr.prototype._notifyHoverOut=function(){this._hoverOutActionId=-1;
if(this._hoverOutListener!=null){var a=new DwtHoverEvent(DwtEvent.HOVEROUT,this._hoverOutDelay,this._hoverOutData);
this._hoverOutListener.handleEvent(a)
}}
}if(AjxPackage.define("ajax.dwt.widgets.DwtLabel")){DwtLabel=function(a){if(arguments.length==0){return
}a=Dwt.getParams(arguments,DwtLabel.PARAMS);
a.className=a.className||"DwtLabel";
DwtComposite.call(this,a);
this._style=a.style||(DwtLabel.IMAGE_LEFT|DwtLabel.ALIGN_CENTER);
this._textBackground=null;
this._textForeground=null;
this._createHtml(a.template)
};
DwtLabel.PARAMS=["parent","style","className","posStyle","id","index"];
DwtLabel.prototype=new DwtComposite;
DwtLabel.prototype.constructor=DwtLabel;
DwtLabel.prototype.isFocusable=true;
DwtLabel.prototype.toString=function(){return"DwtLabel"
};
DwtLabel.IMAGE_LEFT=1;
DwtLabel.IMAGE_RIGHT=2;
DwtLabel.IMAGE_BOTH=4;
DwtLabel.ALIGN_LEFT=8;
DwtLabel.ALIGN_RIGHT=16;
DwtLabel.ALIGN_CENTER=32;
DwtLabel._LAST_STYLE=32;
DwtLabel.LEFT="left";
DwtLabel.RIGHT="right";
DwtLabel.prototype.TEMPLATE="dwt.Widgets#ZLabel";
DwtLabel.prototype.dispose=function(){delete this._dropDownEl;
delete this._iconEl;
delete this._textEl;
DwtControl.prototype.dispose.call(this)
};
DwtLabel.prototype.setEnabled=function(a){if(a!=this._enabled){DwtControl.prototype.setEnabled.call(this,a);
var c=this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT;
this.__imageInfo=this.__imageInfo||{};
this.__setImage(this.__imageInfo[c])
}};
DwtLabel.prototype.getImage=function(a){a=a||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
return this.__imageInfo[a]
};
DwtLabel.prototype.setImage=function(a,d,c){d=d||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
this.__imageInfo=this.__imageInfo||{};
this.__imageInfo[d]=a;
this.__setImage(a,d,c)
};
DwtLabel.prototype.setIconEl=function(a,c){this._iconEl=this._iconEl||{};
c=c||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
this._iconEl[c]=a
};
DwtLabel.prototype.setDisabledImage=function(a){};
DwtLabel.prototype.getText=function(){return(this.__text!=null)?this.__text:null
};
DwtLabel.prototype.setText=function(a){if(!this._textEl){return
}if(a==null||a==""){this.__text=null;
this._textEl.innerHTML=""
}else{this.__text=a;
this._textEl.innerHTML=a
}this._textSet(a)
};
DwtLabel.prototype.setTextBackground=function(a){this._textBackground=a;
if(this._textEl){this._textEl.style.backgroundColor=a
}};
DwtLabel.prototype.setTextForeground=function(a){this._textForeground=a;
if(this._textEl){this._textEl.style.color=a
}};
DwtLabel.prototype.setAlign=function(a){this._style=a;
var c=this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT;
this.__imageInfo=this.__imageInfo||{};
this.__setImage(this.__imageInfo[c])
};
DwtLabel.prototype.isStyle=function(a){return this._style&a
};
DwtLabel.prototype.getTabGroupMember=function(){return DwtControl.prototype.getTabGroupMember.apply(this,arguments)
};
DwtLabel.prototype._createHtml=function(a){var c={id:this._htmlElId};
this._createHtmlFromTemplate(a||this.TEMPLATE,c)
};
DwtLabel.prototype._createHtmlFromTemplate=function(a,c){DwtControl.prototype._createHtmlFromTemplate.call(this,a,c);
this._textEl=document.getElementById(c.id+"_title")
};
DwtLabel.prototype._getIconEl=function(c){var a=this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT;
c=typeof c==="boolean"?a:(c||a);
this._iconEl=this._iconEl||{};
return this._iconEl[c]||(this._iconEl[c]=document.getElementById(this._htmlElId+"_"+c+"_icon"))
};
DwtLabel.prototype.__setImage=function(c,e,d){this.__altText=d||this.__altText;
var a=this._getIconEl(e);
if(a){if(c){AjxImg.setImage(a,c,null,!this._enabled,null,this.__altText);
var f=(this._style&DwtLabel.IMAGE_RIGHT?"ZHasRightIcon":"ZHasLeftIcon");
Dwt.addClass(this.getHtmlElement(),f)
}else{a.innerHTML=""
}}};
DwtLabel.prototype._textSet=function(a){if(!this.hasAttribute("aria-labelledby")){if(a){this.setAttribute("aria-label",a)
}else{this.removeAttribute("aria-label")
}}}
}if(AjxPackage.define("ajax.dwt.widgets.DwtButton")){DwtButton=function(d){if(arguments.length==0){return
}d=Dwt.getParams(arguments,DwtButton.PARAMS);
d.className=d.className||"ZButton";
DwtLabel.call(this,d);
var c=d.parent;
if(!c._hasSetMouseEvents||AjxEnv.isIE){this._setMouseEvents()
}var a;
if(c._hasSetMouseEvents){a=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[]
}else{a=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
a.push(DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONCLICK)
}if(a&&a.length){this._setEventHdlrs(a)
}this._listeners=d.listeners||DwtButton._listeners;
this._addMouseListeners();
this._ignoreInternalOverOut=true;
this._dropDownEvtMgr=new AjxEventMgr();
this._selected=false;
this._actionTiming=d.actionTiming||DwtButton.ACTION_MOUSEUP;
this.__preventMenuFocus=null;
this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_BELOW
};
DwtButton.prototype=new DwtLabel;
DwtButton.prototype.constructor=DwtButton;
DwtButton.prototype.isDwtButton=true;
DwtButton.prototype.toString=function(){return"DwtButton"
};
DwtButton.prototype.role="button";
DwtButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index","listeners"];
DwtButton.TOGGLE_STYLE=DwtLabel._LAST_STYLE*2;
DwtButton.ALWAYS_FLAT=DwtLabel._LAST_STYLE*4;
DwtButton._LAST_STYLE=DwtButton.ALWAYS_FLAT;
DwtButton.ACTION_MOUSEUP=1;
DwtButton.ACTION_MOUSEDOWN=2;
DwtButton.NOTIFY_WINDOW=500;
DwtButton.MENU_POPUP_STYLE_BELOW="BELOW";
DwtButton.MENU_POPUP_STYLE_ABOVE="ABOVE";
DwtButton.MENU_POPUP_STYLE_RIGHT="RIGHT";
DwtButton.MENU_POPUP_STYLE_CASCADE="CASCADE";
DwtButton.MOUSE_EVENTS=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP];
if(AjxEnv.isIE){DwtButton.MOUSE_EVENTS.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{DwtButton.MOUSE_EVENTS.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}DwtButton.prototype.TEMPLATE="dwt.Widgets#ZButton";
DwtButton.prototype.dispose=function(){if(this._menu&&this._menu.isDwtMenu&&(this._menu.parent==this)){this._menu.dispose();
this._menu=null
}DwtLabel.prototype.dispose.call(this)
};
DwtButton.prototype.addSelectionListener=function(c,a){this.addListener(DwtEvent.SELECTION,c,a)
};
DwtButton.prototype.removeSelectionListener=function(a){this.removeListener(DwtEvent.SELECTION,a)
};
DwtButton.prototype.removeSelectionListeners=function(){this.removeAllListeners(DwtEvent.SELECTION)
};
DwtButton.prototype.addDropDownSelectionListener=function(a){return this._dropDownEvtMgr.addListener(DwtEvent.SELECTION,a)
};
DwtButton.prototype.removeDropDownSelectionListener=function(a){this._dropDownEvtMgr.removeListener(DwtEvent.SELECTION,a)
};
DwtButton.prototype._dropDownImg="SelectPullDownArrow";
DwtButton.prototype._dropDownDepImg="SelectPullDownArrow";
DwtButton.prototype._dropDownHovImg="SelectPullDownArrowHover";
DwtButton.prototype.setDropDownImages=function(c,d,e,a){this._dropDownImg=c;
this._dropDownHovImg=e;
this._dropDownDepImg=a
};
DwtButton.prototype.setDropDownHovImage=function(a){this._dropDownHovImg=a
};
DwtButton.prototype._addMouseListeners=function(){AjxUtil.foreach(DwtButton.MOUSE_EVENTS,(function(a){this.addListener(a,this._listeners[a])
}).bind(this))
};
DwtButton.prototype._removeMouseListeners=function(){AjxUtil.foreach(DwtButton.MOUSE_EVENTS,(function(a){this.removeListener(a,this._listeners[a])
}).bind(this))
};
DwtButton.prototype.setDisplayState=function(c,a){if(this._selected&&c!=DwtControl.SELECTED&&!a){c=[DwtControl.SELECTED,c].join(" ")
}DwtLabel.prototype.setDisplayState.call(this,c)
};
DwtButton.prototype.setEnabled=function(c){if(c!=this._enabled){DwtLabel.prototype.setEnabled.call(this,c);
if(c){var d=(AjxEnv.isIE)?this.getHtmlElement().firstChild:null;
if(d){var a=d.className;
d.className="";
d.className=a
}this._addMouseListeners();
if(this._menu){this._setDropDownCellMouseHandlers(true);
if(this._dropDownEl&&this._dropDownImg){AjxImg.setImage(this._dropDownEl,this._dropDownImg)
}}}else{this._removeMouseListeners();
if(this._menu){this._setDropDownCellMouseHandlers(false);
if(this._dropDownEl&&this._dropDownImg){AjxImg.setDisabledImage(this._dropDownEl,this._dropDownImg)
}}}}};
DwtButton.prototype.setImage=function(a,c){if(this.whatToShow&&!this.whatToShow.showImage){return
}DwtLabel.prototype.setImage.apply(this,arguments);
this._setMinWidth()
};
DwtButton.prototype.setText=function(a){if(this.whatToShow&&!this.whatToShow.showText){return
}DwtLabel.prototype.setText.call(this,a);
this._setMinWidth()
};
DwtButton.prototype._setMinWidth=function(){if(this.getText()!=null){Dwt.addClass(this.getHtmlElement(),"ZHasText")
}else{Dwt.delClass(this.getHtmlElement(),"ZHasText")
}};
DwtButton.prototype.setHoverImage=function(c,a){a=a||(this._style&DwtLabel.IMAGE_RIGHT?DwtLabel.RIGHT:DwtLabel.LEFT);
this._hoverImageInfo=this._hoverImageInfo||{};
this._hoverImageInfo[a]=c
};
DwtButton.prototype.setMenu=function(a){a=Dwt.getParams(arguments,DwtButton.setMenuParams,(arguments.length==1&&arguments[0]&&!arguments[0].menu));
if(a){this._menu=a.menu
}if(this._menu){if(this._menu.isDwtMenu){this._shouldToggleMenu=(a.shouldToggle===true);
if(a.popupAbove){this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_ABOVE
}else{if(a.popupRight){this._menuPopupStyle=DwtButton.MENU_POPUP_STYLE_RIGHT
}else{this._menuPopupStyle=a.menuPopupStyle||DwtButton.MENU_POPUP_STYLE_BELOW
}}this._menuAdded(this._menu)
}else{this._savedMenuParams=a
}if(this._dropDownEl){Dwt.addClass(this.getHtmlElement(),"ZHasDropDown");
if(this._dropDownImg){AjxImg.setImage(this._dropDownEl,this._dropDownImg)
}if(this._enabled){this._setDropDownCellMouseHandlers(true)
}if(this._menu.isDwtMenu){this._menu.setAssociatedElementId(this._dropDownEl.id)
}}if((this.__preventMenuFocus!=null)&&this._menu.isDwtMenu){this._menu.dontStealFocus(this.__preventMenuFocus)
}}else{if(this._dropDownEl){Dwt.delClass(this.getHtmlElement(),"ZHasDropDown");
this._dropDownEl.innerHTML=""
}}};
DwtButton.setMenuParams=["menu","shouldToggle","followIconStyle","popupAbove","popupRight"];
DwtButton.prototype._setDropDownCellMouseHandlers=function(a){this._dropDownEventsEnabled=a
};
DwtButton.prototype.getMenu=function(a){if(this._menu&&this._menu.isAjxCallback){if(a){return null
}var d=this._menu;
var c=this._savedMenuParams||{};
c.menu=d.run(this);
this.setMenu(c);
if((this.__preventMenuFocus!=null)&&(this._menu.isDwtMenu)){this._menu.dontStealFocus(this.__preventMenuFocus)
}}if(this._menu){this.setAttribute("menuId",this._menu._htmlElId)
}return this._menu
};
DwtButton.prototype.resetClassName=function(){this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype.setActionTiming=function(a){this._actionTiming=a
};
DwtButton.prototype.setHovered=function(a){this.setDisplayState(a?DwtControl.HOVER:DwtControl.NORMAL)
};
DwtButton.prototype.setEnabledImage=function(a){this._enabledImageInfo=a;
this.setImage(a)
};
DwtButton.prototype.setDepressedImage=function(a){this._depressedImageInfo=a
};
DwtButton.prototype.setSelected=function(a){if(this._selected!=a){this._selected=a;
this.setDisplayState(a?DwtControl.SELECTED:DwtControl.NORMAL)
}};
DwtButton.prototype.isToggled=function(){return this._selected
};
DwtButton.prototype.popup=function(f,c){f=f||this.getMenu();
if(!f){return
}var l=f.parent;
var h=l.getBounds();
var k=f.shell.getSize();
var d=f.getSize();
var m=l.getHtmlElement();
var e=Dwt.toWindow(m,0,0);
var a=(m.style.borderLeftWidth=="")?0:parseInt(m.style.borderLeftWidth);
var n=Boolean(c&&DwtKeyEvent.isKeyEvent(c));
var j;
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_RIGHT){j=e.x+h.width-d.x
}else{if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_CASCADE){j=e.x+h.width
}else{j=e.x+a;
j=((j+d.x)>=k.x)?k.x-d.x:j
}}var i;
if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_ABOVE){i=e.y-d.y
}else{if(this._menuPopupStyle==DwtButton.MENU_POPUP_STYLE_CASCADE){i=e.y
}else{var g=(m.style.borderTopWidth=="")?0:parseInt(m.style.borderTopWidth);
g+=(m.style.borderBottomWidth=="")?0:parseInt(m.style.borderBottomWidth);
i=e.y+h.height+g
}}f.popup(0,j,i,n);
f.setSelectedItem(0)
};
DwtButton.prototype.getKeyMapName=function(){return DwtKeyMap.MAP_BUTTON
};
DwtButton.prototype.handleKeyAction=function(a,c){switch(a){case DwtKeyMap.SELECT:this._emulateSingleClick();
break;
case DwtKeyMap.SUBMENU:var d=this.getMenu();
if(!d){return false
}this._emulateDropDownClick();
d.setSelectedItem(0);
break
}return true
};
DwtButton.prototype.removePullDownMenuOptions=function(){if(this._menu){this._setDropDownCellMouseHandlers(false);
if(this._dropDownEl&&this._dropDownImg){AjxImg.setImage(this._dropDownEl,"");
this.setDropDownImages("","","","")
}}};
DwtButton.prototype._emulateSingleClick=function(){this.trigger();
var a=this.getHtmlElement();
var c=Dwt.toWindow(a);
var d=new DwtMouseEvent();
this._setMouseEvent(d,{type:this._actionTiming==DwtButton.ACTION_MOUSEDOWN?DwtEvent.ONMOUSEDOWN:DwtEvent.ONMOUSEUP,dwtObj:this,target:a,button:DwtMouseEvent.LEFT,docX:c.x,docY:c.y,kbNavEvent:true});
this.notifyListeners(d.type,d)
};
DwtButton.prototype._emulateDropDownClick=function(){var a=this._dropDownEl;
if(!a){return
}var c=Dwt.toWindow(a);
var d=new DwtMouseEvent();
this._setMouseEvent(d,{dwtObj:this,target:a,button:DwtMouseEvent.LEFT,docX:c.x,docY:c.y,kbNavEvent:true});
DwtButton._dropDownCellMouseUpHdlr(d)
};
DwtButton.prototype._focusByMouseUpEvent=function(){};
DwtButton.prototype._focus=function(){this.setDisplayState(DwtControl.FOCUSED)
};
DwtButton.prototype._blur=function(){this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._toggleMenu=function(a){if(this._shouldToggleMenu){var c=this.getMenu();
if(!c.isPoppedUp()){this.popup(null,a);
this._menuUp=true
}else{c.popdown(0,a);
this._menuUp=false;
this.deactivate()
}}else{this.popup(null,a)
}};
DwtButton.prototype._isDropDownEvent=function(c){if(this._dropDownEventsEnabled&&this._dropDownEl){var a=c.docX;
var d=Dwt.toWindow(this._dropDownEl,0,0,window).x;
if(a>=d){return true
}}return false
};
DwtButton.prototype.trigger=function(){if(this._depressedImageInfo){this.setImage(this._depressedImageInfo)
}this.setDisplayState(DwtControl.ACTIVE,true);
this.isActive=true
};
DwtButton.prototype.deactivate=function(){this._showHoverImage(true);
if(this._style&DwtButton.TOGGLE_STYLE){this._selected=!this._selected
}this.setDisplayState(DwtControl.HOVER)
};
DwtButton.prototype.dontStealFocus=function(a){if(a==null){a=true
}if(this._menu&&this._menu.isDwtMenu){this._menu.dontStealFocus(a)
}this.__preventMenuFocus=a
};
DwtButton.prototype._toggleHoverClass=function(c,e){var a=this._getIconEl(e);
if(a){var d=c?this._hoverImageInfo[e]:this.__imageInfo[e];
a.firstChild.className=AjxImg.getClassForImage(d)
}};
DwtButton.prototype._showHoverImage=function(a){if(!this._hoverImageInfo){return
}if(this._hoverImageInfo.left){this._toggleHoverClass(a,DwtLabel.LEFT)
}if(this._hoverImageInfo.right){this._toggleHoverClass(a,DwtLabel.RIGHT)
}};
DwtButton.prototype._handleClick=function(c){if(this.isListenerRegistered(DwtEvent.SELECTION)){var a=(new Date()).getTime();
if(!this._lastNotify||(a-this._lastNotify>DwtButton.NOTIFY_WINDOW)){var d=DwtShell.selectionEvent;
DwtUiEvent.copy(d,c);
d.item=this;
d.detail=(typeof this.__detail=="undefined")?0:this.__detail;
this.notifyListeners(DwtEvent.SELECTION,d);
this._lastNotify=a;
this.shell.notifyGlobalSelection(d)
}}else{if(this._menu){if(this._menu.isDwtMenu&&!this.isListenerRegistered(DwtEvent.SELECTION)){this._menu.setAssociatedObj(this)
}this._toggleMenu(c)
}}};
DwtButton.prototype._setMouseOutClassName=function(){this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._createHtmlFromTemplate=function(a,c){DwtLabel.prototype._createHtmlFromTemplate.call(this,a,c);
this._dropDownEl=document.getElementById(c.id+"_dropdown")
};
DwtButton.prototype._menuAdded=function(a){this.setAttribute("aria-haspopup",true);
this.setAttribute("aria-controls",a._htmlElId)
};
DwtButton.prototype._menuItemSelected=function(a){};
DwtButton._dropDownCellMouseDownHdlr=function(c){var d=DwtControl.getTargetControl(c);
var a=DwtShell.mouseEvent;
a.setFromDhtmlEvent(c,d);
if(a.button==DwtMouseEvent.LEFT){if(this._depImg){AjxImg.setImage(this,this._depImg)
}}a._stopPropagation=true;
a._returnValue=false;
a.setToDhtmlEvent(c);
return false
};
DwtButton._dropDownCellMouseUpHdlr=function(c){var a=DwtShell.mouseEvent;
a.setFromDhtmlEvent(c);
if(a.button==DwtMouseEvent.LEFT){if(this._dropDownHovImg&&!this.noMenuBar){AjxImg.setImage(this,this._dropDownHovImg)
}DwtEventManager.notifyListeners(DwtEvent.ONMOUSEDOWN,a);
var e=DwtControl.getTargetControl(c);
if(e){if(e.getMenu()&&e.getMenu().isPoppedUp()){e.getMenu().popdown()
}else{if(e._menu&&e._menu.isAjxCallback){e.popup()
}if(e._dropDownEvtMgr.isListenerRegistered(DwtEvent.SELECTION)){var d=DwtShell.selectionEvent;
DwtUiEvent.copy(d,a);
d.item=e;
e._dropDownEvtMgr.notifyListeners(DwtEvent.SELECTION,d)
}else{e._toggleMenu(c)
}}}}a._stopPropagation=true;
a._returnValue=false;
a.setToDhtmlEvent(c);
return false
};
DwtButton._mouseOverListener=function(e){var c=e.dwtObj;
if(!c){return false
}c._showHoverImage(true);
c.setDisplayState(DwtControl.HOVER);
var f=c._dropDownEl;
if(c._menu&&f&&c._dropDownHovImg&&!c.noMenuBar&&c.isListenerRegistered(DwtEvent.SELECTION)){if(c._dropDownHovImg){AjxImg.setImage(f,c._dropDownHovImg)
}}if(AjxEnv.isIE){if(e&&e.target&&e.target.firstChild){var d=e.target.firstChild;
var a=d.className;
d.className="";
d.className=a
}}e._stopPropagation=true
};
DwtButton._mouseOutListener=function(c){var a=c.dwtObj;
if(!a){return false
}a._showHoverImage(false);
a._setMouseOutClassName();
a.isActive=false;
var d=a._dropDownEl;
if(a._menu&&d&&a._dropDownImg){AjxImg.setImage(d,a._dropDownImg)
}};
DwtButton._mouseDownListener=function(c){var a=c.dwtObj;
if(!a){return false
}if(a._isDropDownEvent(c)){return DwtButton._dropDownCellMouseDownHdlr(c)
}if(c.button!=DwtMouseEvent.LEFT){return
}var d=a._dropDownEl;
if(a._menu&&d&&a._dropDownDepImg){AjxImg.setImage(d,a._dropDownDepImg)
}switch(a._actionTiming){case DwtButton.ACTION_MOUSEDOWN:a.trigger();
a._handleClick(c);
break;
case DwtButton.ACTION_MOUSEUP:a.trigger();
break
}};
DwtButton._mouseUpListener=function(d){var a=d.dwtObj;
if(!a){return false
}if(a._isDropDownEvent(d)){return DwtButton._dropDownCellMouseUpHdlr(d)
}if(d.button!=DwtMouseEvent.LEFT){return
}var e=a._dropDownEl;
if(a._menu&&e&&a._dropDownHovImg&&!a.noMenuBar){AjxImg.setImage(e,a._dropDownHovImg)
}switch(a._actionTiming){case DwtButton.ACTION_MOUSEDOWN:a.deactivate();
break;
case DwtButton.ACTION_MOUSEUP:var c=a.getHtmlElement();
if(a.isActive){a.deactivate();
a._handleClick(d)
}break
}};
DwtButton._listeners={};
DwtButton._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtButton._mouseOutListener);
DwtButton._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtButton._mouseDownListener);
DwtButton._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtButton._mouseUpListener);
DwtButton._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtButton._mouseOutListener)
}if(AjxPackage.define("ajax.dwt.widgets.DwtMenu")){DwtMenu=function(e){this._created=false;
if(arguments.length==0){return
}e=Dwt.getParams(arguments,DwtMenu.PARAMS);
this._origStyle=e.style;
var c=e.parent;
if(c){if(c instanceof DwtMenuItem||c instanceof DwtButton){if((e.style==DwtMenu.GENERIC_WIDGET_STYLE)||(e.style==DwtMenu.DROPDOWN_CENTERV_STYLE)){this._style=e.style
}else{this._style=DwtMenu.DROPDOWN_STYLE
}}else{this._style=e.style||DwtMenu.POPUP_STYLE
}if(!e.posStyle){e.posStyle=(this._style==DwtMenu.BAR_STYLE)?DwtControl.STATIC_STYLE:DwtControl.ABSOLUTE_STYLE
}}e.className=e.className||"DwtMenu";
this._layoutStyle=e.layout==null||e.layout;
if(this._layoutStyle===true){this._layoutStyle=DwtMenu.LAYOUT_CASCADE
}else{if(this._layoutStyle===false){this._layoutStyle=DwtMenu.LAYOUT_STACK
}}this._maxRows=this._layoutStyle&&e.maxRows||0;
this._congruent=e.congruent;
e.parent=(c instanceof DwtShell)?c:c.shell;
DwtComposite.call(this,e);
this.parent=c;
if(this._isPopupStyle()&&(this._layoutStyle==DwtMenu.LAYOUT_STACK)){this.setScrollStyle(DwtControl.SCROLL)
}if(!c){return
}var a=AjxEnv.isIE?[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP]:[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
this._setEventHdlrs(a);
this._hasSetMouseEvents=true;
var d=this.getHtmlElement();
if(e.posStyle!=DwtControl.STATIC_STYLE){Dwt.setLocation(d,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}if(this._style!=DwtMenu.COLOR_PICKER_STYLE&&this._style!=DwtMenu.CALENDAR_PICKER_STYLE&&this._style!=DwtMenu.GENERIC_WIDGET_STYLE){this._table=document.createElement("table");
this._table.border=this._table.cellPadding=this._table.cellSpacing=0;
this._table.className="DwtMenuTable";
this._table.id=Dwt.getNextId();
if(this._layoutStyle==DwtMenu.LAYOUT_SCROLL){this._setupScroll()
}else{d.appendChild(this._table)
}this._table.backgroundColor=DwtCssStyle.getProperty(d,"background-color")
}if(e.style!=DwtMenu.BAR_STYLE){this.setVisible(false);
this._isPoppedUp=false
}else{DwtMenu._activeMenuIds.add(d.id,null,true);
this._isPoppedUp=true
}this._popdownAction=new AjxTimedAction(this,this._doPopdown);
this._popdownActionId=-1;
this._popupAction=new AjxTimedAction(this,this._doPopup);
this._popupActionId=-1;
this._outsideListener=new AjxListener(null,DwtMenu._outsideMouseDownListener);
this._menuItemsHaveChecks=false;
this._menuItemsHaveIcons=false;
this._menuItemsWithSubmenus=0;
this.__currentItem=null;
this.__preventMenuFocus=false;
this._created=true;
this._itemSelectionListener=new AjxListener(this,this._propagateItemSelection);
if(c._menuAdded){c._menuAdded(this)
}};
DwtMenu.PARAMS=["parent","style","className","posStyle","cascade","id"];
DwtMenu.prototype=new DwtComposite;
DwtMenu.prototype.constructor=DwtMenu;
DwtMenu.prototype.isDwtMenu=true;
DwtMenu.prototype.toString=function(){return"DwtMenu"
};
DwtMenu.prototype.role="menu";
DwtMenu.BAR_STYLE="BAR";
DwtMenu.POPUP_STYLE="POPUP";
DwtMenu.DROPDOWN_STYLE="DROPDOWN";
DwtMenu.DROPDOWN_CENTERV_STYLE="DROPDOWN_CENTERV";
DwtMenu.COLOR_PICKER_STYLE="COLOR";
DwtMenu.CALENDAR_PICKER_STYLE="CALENDAR";
DwtMenu.GENERIC_WIDGET_STYLE="GENERIC";
DwtMenu.HAS_ICON="ZHasIcon";
DwtMenu.HAS_CHECK="ZHasCheck";
DwtMenu.HAS_SUBMENU="ZHasSubMenu";
DwtMenu.LAYOUT_STACK=0;
DwtMenu.LAYOUT_CASCADE=1;
DwtMenu.LAYOUT_SCROLL=2;
DwtMenu._activeMenuUp=false;
DwtMenu._activeMenuIds=new AjxVector();
DwtMenu._activeMenus=new AjxVector();
DwtMenu.prototype.dispose=function(){this._table=null;
DwtComposite.prototype.dispose.call(this);
if(!(this.parent instanceof DwtShell)){this.shell.removeChild(this)
}};
DwtMenu.prototype.addSelectionListener=function(a){this.addListener(DwtEvent.SELECTION,a)
};
DwtMenu.prototype.removeSelectionListener=function(a){this.removeListener(DwtEvent.SELECTION,a)
};
DwtMenu.prototype.addPopupListener=function(a){this.addListener(DwtEvent.POPUP,a)
};
DwtMenu.prototype.removePopupListener=function(a){this.removeListener(DwtEvent.POPUP,a)
};
DwtMenu.prototype.addPopdownListener=function(a){this.addListener(DwtEvent.POPDOWN,a)
};
DwtMenu.prototype.removePopdownListener=function(a){this.removeListener(DwtEvent.POPDOWN,a)
};
DwtMenu.prototype.setWidth=function(a){this._width=a;
if(this._table){Dwt.setSize(this._table,a,Dwt.CLEAR)
}};
DwtMenu.prototype.centerOnParentVertically=function(){return(this._style===DwtMenu.DROPDOWN_CENTERV_STYLE)
};
DwtMenu.prototype._isPopupStyle=function(){return(this._style===DwtMenu.POPUP_STYLE||this._style===DwtMenu.DROPDOWN_STYLE||this._style===DwtMenu.DROPDOWN_CENTERV_STYLE)
};
DwtMenu.prototype.getItem=function(a){return this._children.get(a)
};
DwtMenu.prototype.getItemIndex=function(a){return this._children.indexOf(a)
};
DwtMenu.prototype.getItemById=function(d,f){var a=this.getItems();
for(var c=0;
c<a.length;
c++){var e=a[c].getData(d);
if(e==f){a[c].index=c;
return a[c]
}}return null
};
DwtMenu.prototype.getItemCount=function(){return this._children.size()
};
DwtMenu.prototype.getItems=function(){return this._children.getArray()
};
DwtMenu.prototype.getSelectedItem=function(f){var c=this._children.getArray();
for(var e=0;
e<c.length;
e++){var d=c[e];
if((f==null||(d._style&&f!=0))&&d.getChecked()){return d
}}return null
};
DwtMenu.prototype.isPoppedUp=function(){return this._isPoppedUp
};
DwtMenu.prototype.popup=function(d,a,e,c){if(this._style==DwtMenu.BAR_STYLE){return
}if(this._popdownActionId!=-1){AjxTimedAction.cancelAction(this._popdownActionId);
this._popdownActionId=-1
}else{if(this._isPoppedUp||(this._popupActionId!=-1&&d&&d>0)){return
}else{if(this._popupActionId!=-1){AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}}if(!d){this._doPopup(a,e,c)
}else{this._popupAction.args=[a,e,c];
this._popupActionId=AjxTimedAction.scheduleAction(this._popupAction,d)
}}};
DwtMenu.prototype.popdown=function(c,a){if(this._style==DwtMenu.BAR_STYLE){return
}if(this._popupActionId!=-1){AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}else{if(!this._isPoppedUp||this._popdownActionId!=-1){return
}if(c==null||c==0){this._doPopdown(a)
}else{this._popdownActionId=AjxTimedAction.scheduleAction(this._popdownAction,c)
}}};
DwtMenu.prototype._setupScroll=function(){var i=this.getHtmlElement();
this._table.style.position="relative";
this._topScroller=document.createElement("div");
this._topScroller.className="DwtMenuScrollTop";
this._topScroller.id=Dwt.getNextId();
this._imgDivTop=document.createElement("div");
this._imgDivTop.className="ImgUpArrowSmall";
this._topScroller.appendChild(this._imgDivTop);
Dwt.setHandler(this._imgDivTop,DwtEvent.ONMOUSEOUT,DwtMenu._stopEvent);
Dwt.setHandler(this._imgDivTop,DwtEvent.ONMOUSEOVER,DwtMenu._stopEvent);
i.appendChild(this._topScroller);
this._tableContainer=document.createElement("div");
this._tableContainer.appendChild(this._table);
i.appendChild(this._tableContainer);
this._bottomScroller=document.createElement("div");
this._bottomScroller.className="DwtMenuScrollBottom";
this._bottomScroller.id=Dwt.getNextId();
this._imgDivBottom=document.createElement("div");
this._imgDivBottom.className="ImgDownArrowSmall";
Dwt.setHandler(this._imgDivBottom,DwtEvent.ONMOUSEOUT,DwtMenu._stopEvent);
Dwt.setHandler(this._imgDivBottom,DwtEvent.ONMOUSEOVER,DwtMenu._stopEvent);
this._bottomScroller.appendChild(this._imgDivBottom);
i.appendChild(this._bottomScroller);
var d=AjxCallback.simpleClosure(this._scroll,this,this._table.id,true,false);
var a=AjxCallback.simpleClosure(this._scroll,this,this._table.id,false,false);
var c=AjxCallback.simpleClosure(this._handleMouseOut,this,this._topScroller.id,this._table.id);
var g=AjxCallback.simpleClosure(this._handleMouseOut,this,this._bottomScroller.id,this._table.id);
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEDOWN,d);
Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEUP,a);
if(!AjxEnv.isIE){Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSEOUT,c)
}else{Dwt.setHandler(this._topScroller,DwtEvent.ONMOUSELEAVE,a)
}var f=AjxCallback.simpleClosure(this._scroll,this,this._table.id,true,true);
var e=AjxCallback.simpleClosure(this._scroll,this,this._table.id,false,true);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEDOWN,f);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEUP,e);
Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEUP,e);
if(!AjxEnv.isIE){Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSEOUT,g)
}else{Dwt.setHandler(this._bottomScroller,DwtEvent.ONMOUSELEAVE,e)
}var h=AjxCallback.simpleClosure(this._handleScroll,this,this._table.id);
Dwt.setHandler(i,DwtEvent.ONMOUSEWHEEL,h)
};
DwtMenu.prototype.render=function(v,t){var A=this.shell.getSize();
var H=this.getSize();
var w=this.getHtmlElement();
A.y-=10+(AjxEnv.isIE?20:0);
A.x-=28;
var z=this._layoutStyle==DwtMenu.LAYOUT_SCROLL;
var g=this._isPopupStyle();
var D=this._layoutStyle==DwtMenu.LAYOUT_CASCADE;
if(this._table){if(g&&D){var I=A.y;
var J=null;
var u=this._table.rows;
var h=u.length;
var c=this._maxRows;
var B=H.y;
var s=I-25;
for(var F=h-1;
F>=0;
F--){B-=Dwt.getSize(u[F]).y;
if(B<s){break
}}var r=c?Math.min(F+1,c):(F+1);
for(var E=r;
E<h;
E++){var q=u[(E-r)%r];
var e=q.insertCell(-1);
e.className="DwtMenuCascadeCell";
var p=u[E].cells[0].firstChild;
while(p!=null){e.appendChild(p);
p=p.nextSibling
}}for(E=u.length-1;
E>=r;
E--){this._table.deleteRow(r)
}var n=h%r;
if(n>0){for(var E=n;
E<r;
E++){var q=u[E];
var e=q.insertCell(-1);
e.className="DwtMenuCascadeCell";
e.empty=true;
e.innerHTML="&nbsp;"
}}H=this.getSize();
if(J){t=J-H.y
}}else{if(g&&z){var u=this._table.rows;
var h=u.length;
var c=this._maxRows;
var o=c?Math.min(c,h):h;
var m=A.y-25;
var B=20;
for(var F=0;
F<o;
F++){var a=Dwt.getSize(u[F]).y;
if(B+a<=m){B+=a
}else{break
}}H.y=B
}}}var L="auto";
var l="auto";
if(g&&z){l=H.y;
if(this._tableContainer){this._tableContainer.style.height=(l-20)+"px"
}}else{if((g&&D)||t+H.y<A.y-5){l="auto"
}else{l=A.y-t-5
}}if(z){if(this._table){this._table.style.width=H.x
}L=H.x
}this.setSize(L,l);
if((AjxEnv.isGeckoBased||AjxEnv.isSafari||(this._origStyle==DwtMenu.CALENDAR_PICKER_STYLE))&&this._table&&!z){w.style.width=(H.x+(g&&!D?10:0))+"px"
}var K=v+H.x>=A.x?A.x-H.x:v;
if(this.parent instanceof DwtMenuItem){Dwt.delClass(w,"DwtMenu-congruentLeft");
Dwt.delClass(w,"DwtMenu-congruentRight");
var G=this.parent.getBounds();
var M=DwtCssStyle.getComputedStyleObject(this.parent.parent.getHtmlElement());
var d=DwtCssStyle.getComputedStyleObject(w);
if(((K>G.x&&K<G.x+G.width)||(G.x>=K&&G.x<K+H.x))&&G.x>=H.x){var f=parseInt(d.width);
if(!AjxEnv.isIE){f+=parseInt(d.paddingLeft)+parseInt(d.paddingRight)+parseInt(d.borderLeftWidth)+parseInt(d.borderRightWidth)
}K=(parseInt(M.left)||G.x)-(f||H.x);
if(this._congruent){var n;
if(AjxEnv.isIE){n=parseInt(d.borderLeftWidth)
}else{n=parseInt(d.borderLeftWidth)+parseInt(d.borderRightWidth)
}if(!isNaN(n)){K+=n;
Dwt.addClass(w,"DwtMenu-congruentLeft")
}}}else{var k=parseInt(M.left)||(G.x-(parseInt(M.paddingLeft)||0));
var C=parseInt(M.width)||G.width;
K=k+C;
if(this._congruent){var n=parseInt(M.paddingRight)+parseInt(d.paddingLeft)+parseInt(d.borderLeftWidth);
if(!isNaN(n)){K+=n;
Dwt.addClass(w,"DwtMenu-congruentRight")
}}}}if(this._style===DwtMenu.DROPDOWN_CENTERV_STYLE){t-=H.y/2;
if(t<0){t=0
}}var J=g&&t+H.y>=A.y?A.y-H.y:t;
if(this.parent instanceof DwtMenuItem&&this._congruent){var n=(parseInt(d.paddingTop)||0)-(parseInt(d.borderTopWidth)||0);
if(n>0){J-=n
}}K=K<0&&K!==Dwt.DEFAULT?0:K;
J=J<0&&J!==Dwt.DEFAULT?0:J;
this.setLocation(K,J)
};
DwtMenu.prototype.getKeyMapName=function(){return DwtKeyMap.MAP_MENU
};
DwtMenu.prototype._handleScroll=function(a,e){if(!e){e=window.event
}var g=Dwt.byId(a);
if(g&&e){e=e?e:window.event;
var c=e.detail?e.detail*-1:e.wheelDelta/40;
var f=g.rows;
var d=Dwt.getSize(f[0]).y||10;
this._popdownSubmenus();
if(c>0){this._doScroll(g,+d)
}else{if(c<0){this._doScroll(g,-d)
}}}};
DwtMenu.prototype._handleMouseOut=function(a,c,d){if(a&&d.type&&d.type=="mouseout"&&!AjxEnv.isIE){var e=a?Dwt.byId(a):null;
fromEl=d.target;
if(fromEl!=e){return
}toEl=d.relatedTarget;
while(toEl){toEl=toEl.parentNode;
if(toEl==e){return
}}this._scroll(c,false,false,null)
}};
DwtMenu.prototype._scroll=function(a,g,f,d){var h=a?document.getElementById(a):null;
if(h&&g){var e=h.rows;
var c=Dwt.getSize(e[0]).y||10;
if(this._direction!=f||!this._scrollTimer){this._popdownSubmenus();
this._direction=f;
if(this._scrollTimer){clearInterval(this._scrollTimer);
this._scrollTimer=null
}if(f){this._scrollTimer=setInterval(AjxCallback.simpleClosure(this._doScroll,this,h,-c),100);
this._doScroll(h,-c)
}else{this._scrollTimer=setInterval(AjxCallback.simpleClosure(this._doScroll,this,h,c),100);
this._doScroll(h,c)
}}}else{if(this._scrollTimer){clearInterval(this._scrollTimer);
this._scrollTimer=null
}}};
DwtMenu.prototype._doScroll=function(h,e){if(h&&e){var d=parseInt(h.style.top)||0;
var g;
if(e<0){var f=this._table.rows||null;
var c=f&&f.length&&Dwt.getSize(f[0]).y;
var a=h.scrollHeight-(parseInt(h.parentNode.style.height)||((this._maxRows||(f&&f.length))*c)||0);
if(Math.abs(d+e)<=a){g=d+e
}else{g=-a
}}else{if((d+e)<0){g=d+e
}else{g=0
}}Dwt.setLocation(h,Dwt.DEFAULT,g)
}};
DwtMenu.prototype.scrollToItem=function(d,a){var c=this.getItemIndex(d);
if(c!=-1){this.scrollToIndex(c,a)
}};
DwtMenu.prototype.scrollToIndex=function(j,e){if(this._created&&this._layoutStyle==DwtMenu.LAYOUT_SCROLL&&j!==null&&j>=0&&this._table){var p=this._table.rows;
if(p){var n=this._maxRows;
var a=0;
var l=[];
for(var d=0,g=p.length;
d<g;
d++){var f=Dwt.getSize(p[d]).y;
if(d<n){a+=f
}l.push(f)
}var c=l[j];
var k=parseInt(this._table.style.top)||0;
if(j>=p.length){j=p.length-1
}var m=0;
for(var d=0;
d<j&&d<l.length;
d++){m+=l[d]
}var o=0;
if(e){if(m<-k){o=-(m+k)
}else{if(m+c>a-k){o=-(m+k-a+c)
}}}else{o=-(m+k)
}if(o){this._popdownSubmenus();
this._doScroll(this._table,o)
}}}};
DwtMenu.prototype.handleKeyAction=function(c,e){switch(this._style){case DwtMenu.BAR_STYLE:case DwtMenu.POPUP_STYLE:case DwtMenu.DROPDOWN_STYLE:case DwtMenu.DROPDOWN_CENTERV_STYLE:break;
default:return false
}switch(c){case DwtKeyMap.PAGE_UP:case DwtKeyMap.PAGE_DOWN:var d=this.__currentItem||this._children.get(0);
var a=this.getItemIndex(d);
if(this._maxRows&&a!==-1){this.setSelectedItem(a+((c===DwtKeyMap.PAGE_UP)?-this._maxRows:this._maxRows))
}else{this.setSelectedItem(c===DwtKeyMap.PAGE_DOWN)
}break;
case DwtKeyMap.SELECT_PREV:case DwtKeyMap.SELECT_NEXT:this.setSelectedItem(c===DwtKeyMap.SELECT_NEXT);
break;
case DwtKeyMap.SELECT:if(this.__currentItem){this.__currentItem._emulateSingleClick()
}break;
case DwtKeyMap.SUBMENU:if(this.__currentItem&&this.__currentItem._menu){this.__currentItem._popupMenu(0,true)
}break;
case DwtKeyMap.PARENTMENU:if(this.parent.isDwtMenuItem){this.popdown();
this.parent.focus()
}break;
case DwtKeyMap.CANCEL:this.popdown();
break;
default:return false
}return true
};
DwtMenu.prototype.setAssociatedObj=function(a){this._associatedObj=a
};
DwtMenu.prototype.setAssociatedElementId=function(a){this._associatedElId=a
};
DwtMenu.prototype.checkItem=function(g,f,d){var a=this._children.getArray();
for(var c=0;
c<a.length;
c++){var e=a[c];
if(!(e.isStyle(DwtMenuItem.CHECK_STYLE)||e.isStyle(DwtMenuItem.RADIO_STYLE))){continue
}var h=e.getData(g);
if(h==f){e.setChecked(true,d)
}}};
DwtMenu.prototype.setSelectedItem=function(d,c){var a=this.__currentItem;
if(typeof(d)=="boolean"){a=!a?this._children.get(0):d?this._children.getNext(a):this._children.getPrev(a)
}else{if(d instanceof DwtMenuItem){if(this._children.contains(d)){a=d
}}else{d=Math.max(0,Math.min(this._children.size()-1,d));
a=this._children.get(d)
}}while(a){if(!a.isStyle){if(!c){a.focus()
}break
}else{if(!a.isStyle(DwtMenuItem.SEPARATOR_STYLE)&&a.getEnabled()&&a.getVisible()){break
}}a=(d===false)?this._children.getPrev(a):this._children.getNext(a)
}if(!a){return
}this.scrollToItem(a,true);
if(!c){a.focus()
}if(this.parent&&this.parent._menuItemSelected){this.parent._menuItemSelected(a)
}};
DwtMenu.prototype.clearExternallySelectedItems=function(){if(this._externallySelected!=null){this._externallySelected._deselect();
this._externallySelected=null
}};
DwtMenu.prototype.removeChild=function(d){if(this._table){if(this._style==DwtMenu.BAR_STYLE){var a=d.getHtmlElement().parentNode;
this._table.rows[0].deleteCell(Dwt.getCellIndex(a))
}else{var c=d.getHtmlElement();
if(c&&c.parentNode&&c.parentNode.parentNode.rowIndex>-1){this._table.deleteRow(c.parentNode.parentNode.rowIndex)
}}}this._children.remove(d);
if(d.removeSelectionListener){d.removeSelectionListener(this._itemSelectionListener)
}};
DwtMenu.prototype.addChild=function(a){DwtComposite.prototype.addChild.apply(this,arguments);
if(Dwt.instanceOf(a,"DwtColorPicker")||Dwt.instanceOf(a,"DwtCalendar")||(this._style==DwtMenu.GENERIC_WIDGET_STYLE)){this._addItem(a)
}if(a.addSelectionListener){a.addSelectionListener(this._itemSelectionListener)
}};
DwtMenu.prototype._addItem=function(e,c){if(this._style==DwtMenu.COLOR_PICKER_STYLE||this._style==DwtMenu.CALENDAR_PICKER_STYLE||this._style==DwtMenu.GENERIC_WIDGET_STYLE){return
}var g;
var a;
if(this._style==DwtMenu.BAR_STYLE){var f=this._table.rows;
g=(f.length!=0)?f[0]:this._table.insertRow(0);
if(c==null||c>g.cells.length){c=f.cells.length
}a=g.insertCell(c);
a.align="center";
a.vAlign="middle";
var d=g.insertCell(-1);
d.nowrap=true;
d.width="7px"
}else{if(e.isStyle&&(e.isStyle(DwtMenuItem.CHECK_STYLE)||e.isStyle(DwtMenuItem.RADIO_STYLE))){this._checkItemAdded()
}if(c==null||c>this._table.rows.length){c=-1
}g=this._table.insertRow(c);
a=g.insertCell(0)
}a.noWrap=true;
a.appendChild(e.getHtmlElement())
};
DwtMenu.prototype._radioItemSelected=function(h,f){var d=h._radioGroupId;
var g=this._children.size();
var c=this._children.getArray();
for(var e=0;
e<g;
e++){if(c[e]!=h&&c[e].isStyle(DwtMenuItem.RADIO_STYLE)&&c[e]._radioGroupId==d&&c[e]._itemChecked){c[e].setChecked(false,f);
break
}}};
DwtMenu.prototype._propagateItemSelection=function(a){if(this.isListenerRegistered(DwtEvent.SELECTION)){this.notifyListeners(DwtEvent.SELECTION,a)
}};
DwtMenu.prototype._menuHasCheckedItems=function(){return this._menuItemsHaveChecks
};
DwtMenu.prototype._menuHasItemsWithIcons=function(){return this._menuItemsHaveIcons
};
DwtMenu.prototype._menuHasSubmenus=function(){return(this._menuItemsWithSubmenus>0)
};
DwtMenu.prototype._iconItemAdded=function(a){if(!this._menuItemsHaveIcons){Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_ICON)
}this._menuItemsHaveIcons=true
};
DwtMenu.prototype._checkItemAdded=function(a){if(!this._menuItemsHaveChecks){Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_CHECK)
}this._menuItemsHaveChecks=true
};
DwtMenu.prototype._submenuItemAdded=function(){Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU);
this._menuItemsWithSubmenus++
};
DwtMenu.prototype._submenuItemRemoved=function(){if(this._menuItemsWithSubmenus==1){var e=this._children.size();
var c=this._children.getArray();
for(var d=0;
d<e;
d++){c[d]._submenuItemRemoved()
}}this._menuItemsWithSubmenus--;
if(this._menuItemsWithSubmenus==0){Dwt.delClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU)
}};
DwtMenu.prototype._popdownSubmenus=function(){var e=this._children.size();
var c=this._children.getArray();
for(var d=0;
d<e;
d++){if(c[d]._popdownMenu){c[d]._popdownMenu()
}}};
DwtMenu.prototype.dontStealFocus=function(a){if(a==null){a=true
}this.__preventMenuFocus=!!a
};
DwtMenu.prototype._doPopup=function(f,d,i){var e=DwtBaseDialog.getActiveDialog()?Dwt.Z_DIALOG_MENU:Dwt.Z_MENU;
this.setZIndex(e);
this.setVisible(true);
this.render(f,d);
var c=this._layoutStyle==DwtMenu.LAYOUT_SCROLL;
var g=this._layoutStyle==DwtMenu.LAYOUT_CASCADE;
if(!c){this.setScrollStyle(this._isPopupStyle()&&g?Dwt.CLIP:Dwt.SCROLL)
}else{if(this._tableContainer){Dwt.setScrollStyle(this._tableContainer,Dwt.CLIP)
}}this.notifyListeners(DwtEvent.POPUP,this);
var j=this.shell.getToolTip();
if(j){j.popdown()
}this._popupActionId=-1;
this._isPoppedUp=true;
var h=DwtOutsideMouseEventMgr.INSTANCE;
var a={id:"DwtMenu",obj:this,outsideListener:this._outsideListener};
h.startListening(a);
if(!DwtMenu._activeMenu){DwtMenu._activeMenu=this;
DwtMenu._activeMenuUp=true
}DwtMenu._activeMenuIds.add(this._htmlElId,null,true);
DwtMenu._activeMenuIds.sort();
DwtMenu._activeMenus.add(this,null,true);
DwtShell.getShell(window).getKeyboardMgr().pushTabGroup(this._compositeTabGroup,this.__preventMenuFocus);
if(i||!this.parent.isDwtMenu){this.setSelectedItem(0,this.__preventMenuFocus)
}};
DwtMenu.prototype.getSize=function(c){var a;
if(this._table){a=Dwt.getSize(this._table,c)
}else{a=DwtComposite.prototype.getSize.call(this,c)
}if(this._width&&this._width>a.x){a.x=this._width
}return a
};
DwtMenu.prototype._doPopdown=function(h){var k=this._children.getArray();
var o=this._children.size();
for(var f=0;
f<o;
f++){if((k[f] instanceof DwtMenuItem)&&!(k[f].isStyle(DwtMenuItem.SEPARATOR_STYLE))){k[f]._popdownMenu()
}}this.setVisible(false);
this._ev=h;
this.notifyListeners(DwtEvent.POPDOWN,this);
var m=DwtOutsideMouseEventMgr.INSTANCE;
m.stopListening({id:"DwtMenu",obj:this});
if(DwtMenu._activeMenu==this){DwtMenu._activeMenu=null;
DwtMenu._activeMenuUp=false
}DwtMenu._activeMenuIds.remove(this._htmlElId);
DwtMenu._activeMenus.remove(this);
this._popdownActionId=-1;
this._isPoppedUp=false;
if(this._isPopupStyle()&&this._table&&this._table.rows&&this._table.rows.length&&this._table.rows[0].cells.length){var d=this._table.rows[0].cells.length;
var g=this._table.rows.length;
for(var f=1;
f<d;
f++){for(var e=0;
e<g;
e++){var l=this._table.rows[e].cells[f];
if(!l.empty){var c=l.firstChild;
var n=this._table.insertRow(this._table.rows.length);
var l=n.insertCell(0);
while(c!=null){l.appendChild(c);
c=c.nextSibling
}}}}for(var e=0;
e<g;
e++){var n=this._table.rows[e];
for(var f=n.cells.length-1;
f>0;
f--){n.deleteCell(f)
}}}if(this.__currentItem){this.__currentItem.blur()
}DwtShell.getShell(window).getKeyboardMgr().popTabGroup(this._compositeTabGroup)
};
DwtMenu.prototype._getActiveItem=function(){var c=this._children.getArray();
var e=this._children.size();
for(var d=0;
d<e;
d++){if(c[d]._isMenuPoppedUp()){return c[d]
}}return null
};
DwtMenu._outsideMouseDownListener=function(c){if(DwtMenu._activeMenuUp){var e=DwtMenu._activeMenu;
var f=e._htmlElId;
var d=DwtUiEvent.getTarget(c);
while(d!=null){if(d.id&&d.id!=""&&(d.id==f||d.id==e._associatedElId||DwtMenu._activeMenuIds.binarySearch(d.id)!=-1)){return false
}d=d.parentNode
}e.popdown(0,c);
var a=null;
do{a=DwtMenu._activeMenus.getLast();
if(a!=null&&a instanceof DwtMenu){a.popdown()
}}while(a!=null)
}};
DwtMenu._stopEvent=function(a){if(!a){a=window.event
}a.cancelBubble=true;
if(a.stopPropagation){a.stopPropagation()
}};
DwtMenu.menuShowing=function(){return DwtMenu._activeMenuUp
};
DwtMenu.closeActiveMenu=function(a){if(DwtMenu._activeMenuUp){DwtMenu._activeMenu.popdown(0,a)
}}
}if(AjxPackage.define("ajax.dwt.widgets.DwtShell")){DwtShell=function(f){if(window._dwtShellId){throw new DwtException("DwtShell already exists for window",DwtException.INVALID_OP,"DwtShell")
}var d=f.className||"DwtShell";
DwtComposite.call(this,{className:d});
this.__ctrlInited=true;
document.body.style.margin=0;
if(!f.docBodyScrollable){if(AjxEnv.isIE){document.body.onscroll=DwtShell.__onBodyScroll
}document.body.style.overflow="hidden"
}document.body.onselect=DwtShell._preventDefaultSelectPrt;
document.body.onselectstart=DwtShell._preventDefaultSelectPrt;
document.body.oncontextmenu=DwtShell._preventDefaultPrt;
window.onresize=DwtShell._resizeHdlr;
var e=document.createElement("div");
this._htmlElId=window._dwtShellId=e.id=f.id||Dwt.getNextId();
DwtControl.ALL_BY_ID[this._htmlElId]=this;
e.className=d;
e.style.width=e.style.height="100%";
Dwt.setPosition(e,DwtControl.ABSOLUTE_STYLE);
if(e.style.overflow){e.style.overflow=null
}try{if(f.userShell){document.body.removeChild(f.userShell)
}}catch(c){}document.body.appendChild(e);
if(f.userShell){var a=new DwtControl({parent:this,posStyle:Dwt.ABSOLUTE_STYLE});
a.getHtmlElement().appendChild(f.userShell);
a.setSize("100%","100%");
a.zShow(true);
this._userShell=f.userShell
}else{this._userShell=null
}this.shell=this;
this._createBusyOverlay(e);
this._veilOverlay=document.createElement("div");
this._veilOverlay.className=(!AjxEnv.isLinux)?"VeilOverlay":"VeilOverlay-linux";
this._veilOverlay.style.position="absolute";
this._veilOverlay.style.cursor="not-allowed";
this._veilOverlay.veilZ=new Array();
this._veilOverlay.veilZ.push(Dwt.Z_HIDDEN);
this._veilOverlay.dialogZ=new Array();
this._veilOverlay.activeDialogs=new Array();
this._veilOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
e.appendChild(this._veilOverlay);
Dwt.setBounds(this._veilOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._veilOverlay,Dwt.Z_HIDDEN);
if(f.useCurtain){this._curtainOverlay=document.createElement("div");
this._curtainOverlay.className="CurtainOverlay";
this._curtainOverlay.style.position="absolute";
this._curtainOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
e.appendChild(this._curtainOverlay);
Dwt.setBounds(this._curtainOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._curtainOverlay,Dwt.Z_CURTAIN)
}this._uiEvent=new DwtUiEvent(true);
this.relayout();
this._toolTip=new DwtToolTip(this);
this._hoverMgr=new DwtHoverMgr();
this._keyboardMgr=new DwtKeyboardMgr(this)
};
DwtShell.prototype=new DwtComposite;
DwtShell.prototype.constructor=DwtShell;
DwtShell.CANCEL_BUTTON=-1;
DwtShell.controlEvent=new DwtControlEvent();
DwtShell.focusEvent=new DwtFocusEvent();
DwtShell.keyEvent=new DwtKeyEvent();
DwtShell.mouseEvent=new DwtMouseEvent();
DwtShell.selectionEvent=new DwtSelectionEvent(true);
DwtShell.treeEvent=new DwtTreeEvent();
DwtShell._GLOBAL_SELECTION="GlobalSelection";
DwtShell.prototype.toString=function(){return"DwtShell"
};
DwtShell.getShell=function(a){a=a||window;
return DwtControl.fromElementId(a._dwtShellId)
};
DwtShell.prototype.getKeyboardMgr=function(){return this._keyboardMgr
};
DwtShell.prototype.setBusy=function(e,f,c,d,a){if(e){this._setBusyCount++
}else{if(this._setBusyCount>0){this._setBusyCount--
}}if(!this._setBusy&&(this._setBusyCount>0)){Dwt.setCursor(this._busyOverlay,"wait");
Dwt.setVisible(this._busyOverlay,true);
this._setBusy=this._blockInput=true
}else{if(this._setBusy&&(this._setBusyCount<=0)){Dwt.setCursor(this._busyOverlay,"default");
Dwt.setVisible(this._busyOverlay,false);
this._setBusy=this._blockInput=false
}}if(e&&c){if(d&&d>0){this._busyActionId[f]=AjxTimedAction.scheduleAction(this._busyTimedAction,d)
}else{this._showBusyDialogAction(f)
}this._cancelBusyCallback=a;
if(this._busyDialog){this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(a!=null))
}}else{if(this._busyActionId[f]&&(this._busyActionId[f]!=-1)){AjxTimedAction.cancelAction(this._busyActionId[f]);
this._busyActionId[f]=-1
}if(this._busyDialog&&this._busyDialog.isPoppedUp){this._busyDialog.popdown()
}}};
DwtShell.prototype.getBusy=function(){return this._setBusy
};
DwtShell.prototype.setBusyDialogText=function(a){this._busyDialogText=a;
if(this._busyDialogTxt){this._busyDialogTxt.innerHTML=(a)?a:""
}};
DwtShell.prototype.setBusyDialogTitle=function(a){this._busyDialogTitle=a;
if(this._busyDialog){this._busyDialog.setTitle((a)?a:AjxMsg.workInProgress)
}};
DwtShell.prototype.getHoverMgr=function(){return this._hoverMgr
};
DwtShell.prototype.getToolTip=function(){return this._toolTip
};
DwtShell.prototype.getH=function(a){return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),a).y:Dwt.getSize(document.body,a).y
};
DwtShell.prototype.getW=function(a){return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),a).x:Dwt.getSize(document.body,a).x
};
DwtShell.prototype.getSize=function(a){return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),a):Dwt.getSize(document.body,a)
};
DwtShell.prototype.getLocation=function(){return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()):Dwt.getLocation(document.body)
};
DwtShell.prototype.getX=function(){return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).x:Dwt.getLocation(document.body).x
};
DwtShell.prototype.getY=function(){return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).y:Dwt.getLocation(document.body).y
};
DwtShell.prototype.getBounds=function(a){return(!this._virtual)?Dwt.getBounds(this.getHtmlElement(),a):Dwt.getBounds(document.body,a)
};
DwtShell.prototype.setVirtual=function(){this._virtual=true;
this.setVisible(false)
};
DwtShell.prototype.addFocusListener=function(a){if(!this._hasFocusHandler){var c=document;
if((typeof c.onfocusin!="undefined")&&c.attachEvent){c.attachEvent("onfocusin",DwtShell.__focusHdlr)
}else{if(window.addEventListener){window.addEventListener("focus",DwtShell.__focusHdlr,false)
}}this._hasFocusHandler=true
}this.addListener(DwtEvent.ONFOCUS,a)
};
DwtShell.prototype.addBlurListener=function(a){if(!this._hasBlurHandler){var c=document;
if((typeof c.onfocusin!="undefined")&&c.attachEvent){c.attachEvent("onfocusout",DwtShell.__blurHdlr)
}else{if(window.addEventListener){window.addEventListener("blur",DwtShell.__blurHdlr,false)
}}this._hasBlurHandler=true
}this.addListener(DwtEvent.ONBLUR,a)
};
DwtShell.prototype.addGlobalSelectionListener=function(a){this.addListener(DwtShell._GLOBAL_SELECTION,a)
};
DwtShell.prototype.removeGlobalSelectionListener=function(a){this.removeListener(DwtShell._GLOBAL_SELECTION,a)
};
DwtShell.prototype.notifyGlobalSelection=function(a){this.notifyListeners(DwtShell._GLOBAL_SELECTION,a)
};
DwtShell.prototype.isVirtual=function(){return this._virtual
};
DwtShell.prototype._showBusyDialogAction=function(c){var a=this._getBusyDialog();
a.popup();
this._busyActionId[c]=-1
};
DwtShell.prototype._createBusyOverlay=function(a){this._busyOverlay=document.createElement("div");
this._busyOverlay.className=(!AjxEnv.isLinux)?"BusyOverlay":"BusyOverlay-linux";
this._busyOverlay.style.position="absolute";
this._busyOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
a.appendChild(this._busyOverlay);
Dwt.setBounds(this._busyOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._busyOverlay,Dwt.Z_VEIL);
Dwt.setVisible(this._busyOverlay,false);
this._busyTimedAction=new AjxTimedAction(this,this._showBusyDialogAction);
this._busyActionId={};
this._setBusyCount=0;
this._setBusy=false
};
DwtShell.prototype._getBusyDialog=function(d){if(!this._busyDialog){var e=new DwtDialog_ButtonDescriptor(DwtShell.CANCEL_BUTTON,AjxMsg.cancelRequest,DwtDialog.ALIGN_CENTER);
this._busyDialog=new DwtDialog({parent:this,className:"DwtShellBusyDialog",title:AjxMsg.workInProgress,standardButtons:DwtDialog.NO_BUTTONS,extraButtons:[e],zIndex:Dwt.BUSY+10});
this._busyDialog.registerCallback(DwtShell.CANCEL_BUTTON,this._busyCancelButtonListener,this);
var c=Dwt.getNextId();
var a=["<table class='DialogContent'><tr>","<td><div class='WaitIcon'></div></td><td class='MsgText' id='",c,"'>&nbsp;</td>","</tr></table>"].join("");
this._busyDialog.setContent(a);
this._busyDialogTxt=document.getElementById(c);
if(this._busyDialogText){this._busyDialogTxt.innerHTML=this._busyDialogText
}if(this._busyDialogTitle){this._busyDialog.setTitle(this._busyDialogTitle)
}this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(this._cancelBusyCallback!=null))
}return this._busyDialog
};
DwtShell.prototype.relayout=function(){this._currWinSize=Dwt.getWindowSize();
if(this._userShell){var a=Dwt.byClassName("skin_layout_filler",this._userShell);
AjxUtil.foreach(a,function(d){if(Dwt.hasClass(d,"skin_layout_row")){var k=d;
var j=k.parentNode;
var i=Dwt.getSize(j).y;
var f=0;
var e=Dwt.getInsets(j);
i-=e.top+e.bottom;
var g=Dwt.getMargins(k);
i-=g.top+g.bottom;
AjxUtil.foreach(j.children,function(m){var n=Dwt.getMargins(m);
i-=n.top+n.bottom;
if(Dwt.hasClass(m,"skin_layout_filler")){f+=1
}else{var l=Dwt.getSize(m).y;
AjxUtil.foreach(m.children,function(p){var q=Dwt.getMargins(p);
var o=Dwt.getSize(p).y+q.top+q.bottom;
l=Math.max(l,o)
});
i-=l
}});
k.style.height=Math.max(i/f,0)+"px"
}else{if(Dwt.hasClass(d,"skin_layout_cell")){var h=d;
var k=h.parentNode;
var j=k.parentNode;
var c=Dwt.getSize(j).x;
var f=0;
var e=Dwt.getInsets(j);
c-=e.left+e.right;
var g=Dwt.getMargins(k);
c-=g.left+g.right;
AjxUtil.foreach(k.children,function(l){var m=Dwt.getMargins(l);
c-=m.left+m.right;
if(Dwt.hasClass(l,"skin_layout_filler")){f+=1
}else{if(h.id==="skin_td_main"&&l.id==="skin_td_tree_app_sash"&&AjxEnv.isChrome&&!AjxUtil.isInt(window.devicePixelRatio)){c-=3
}c-=Dwt.getSize(l).x
}});
h.style.width=Math.max(c/f,0)+"px"
}else{if(window.console){console.warn("not fixing sizes for element!",d)
}}}})
}};
DwtShell.prototype._busyCancelButtonListener=function(a){this._cancelBusyCallback.run();
if(this._busyDialog){this._busyDialog.popdown()
}};
DwtShell._preventDefaultSelectPrt=function(c){var a=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
a.setFromDhtmlEvent(c,true);
if(a.dwtObj&&a.dwtObj instanceof DwtControl&&!a.dwtObj.preventSelection(a.target)){a._stopPropagation=false;
a._returnValue=true
}else{a._stopPropagation=true;
a._returnValue=false
}a.setToDhtmlEvent(c);
return !a._stopPropagation
};
DwtShell._preventDefaultPrt=function(c){c=DwtUiEvent.getEvent(c);
var d=c.target?c.target:c.srcElement;
var a=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
a.setFromDhtmlEvent(c,true);
a._stopPropagation=true;
a._returnValue=false;
if(a.dwtObj&&a.dwtObj instanceof DwtControl&&!a.dwtObj.preventContextMenu(a.target)){a._stopPropagation=false;
a._returnValue=true
}else{if(d!=null&&typeof(d)=="object"){if((d.tagName=="A"||d.tagName=="a")&&d.href){a._stopPropagation=false;
a._returnValue=true
}}}a.setToDhtmlEvent(c);
return a._returnValue
};
DwtShell._resizeHdlr=function(d){var c=DwtControl.fromElementId(window._dwtShellId);
if(c.isListenerRegistered(DwtEvent.CONTROL)){var a=DwtShell.controlEvent;
a.reset();
a.oldWidth=c._currWinSize.x;
a.oldHeight=c._currWinSize.y;
c.relayout();
a.newWidth=c._currWinSize.x;
a.newHeight=c._currWinSize.y;
c.notifyListeners(DwtEvent.CONTROL,a)
}else{c.relayout()
}};
DwtShell.__onBodyScroll=function(){document.body.scrollTop=0;
document.body.scrollLeft=0
};
DwtShell.__focusHdlr=function(){var c=DwtShell.focusEvent;
var a=DwtShell.getShell(window);
c.dwtObj=a;
c.state=DwtFocusEvent.FOCUS;
a.notifyListeners(DwtEvent.ONFOCUS,c)
};
DwtShell.__blurHdlr=function(){var c=DwtShell.focusEvent;
var a=DwtShell.getShell(window);
c.dwtObj=a;
c.state=DwtFocusEvent.BLUR;
a.notifyListeners(DwtEvent.ONBLUR,c)
}
}if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroupEvent")){DwtTabGroupEvent=function(){this.tabGroup=null;
this.newFocusMember=null
};
DwtTabGroupEvent.prototype.toString=function(){return"DwtTabGroupEvent"
};
DwtTabGroupEvent.prototype.reset=function(){this.tabGroup=null;
this.newFocusMember=null
}
}if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroup")){DwtTabGroup=function(a){this.__members=new AjxVector();
this.__parent=null;
this.__name=a;
this.__currFocusMember=null;
this.__evtMgr=new AjxEventMgr();
DwtTabGroup.BY_NAME[a]=this
};
DwtTabGroup.prototype.isDwtTabGroup=true;
DwtTabGroup.prototype.toString=function(){return"DwtTabGroup"
};
DwtTabGroup.NOT_ROOT_TABGROUP="NOT ROOT TAB GROUP";
DwtTabGroup.__changeEvt=new DwtTabGroupEvent();
DwtTabGroup.getByName=function(a){return DwtTabGroup.BY_NAME[a]
};
DwtTabGroup.BY_NAME={};
DwtTabGroup.prototype.getName=function(){return this.__name
};
DwtTabGroup.prototype.addFocusChangeListener=function(a){this.__checkRoot();
this.__evtMgr.addListener(DwtEvent.STATE_CHANGE,a)
};
DwtTabGroup.prototype.removeFocusChangeListener=function(a){this.__checkRoot();
this.__evtMgr.removeListener(DwtEvent.STATE_CHANGE,a)
};
DwtTabGroup.prototype.addMember=function(f,d){d=(d!=null)?d:this.__members.size();
var c=AjxUtil.collapseList(AjxUtil.toArray(f));
for(var e=0,a=c.length;
e<a;
e++){var f=c[e];
this.__members.add(f,d+e);
if(f.isDwtTabGroup){f.newParent(this)
}}};
DwtTabGroup.prototype.setMembers=function(a){this.removeAllMembers();
this.addMember(a)
};
DwtTabGroup.prototype.addMemberAfter=function(a,c){this.addMember(a,this.__indexOfMember(c)+1)
};
DwtTabGroup.prototype.addMemberBefore=function(a,c){this.addMember(a,this.__indexOfMember(c))
};
DwtTabGroup.prototype.removeMember=function(d,a,c){return this.replaceMember(d,null,a,c)
};
DwtTabGroup.prototype.removeAllMembers=function(){this.__members.removeAll()
};
DwtTabGroup.prototype.replaceMember=function(f,g,j,h,a,e){var c=this.__getTabGroupForMember(f);
if(!c){this.addMember(g);
return null
}var i=this.__getRootTabGroup();
var d;
if(a){d=a
}else{if(i.__currFocusMember===f||(f&&f.isDwtTabGroup&&f.contains(i.__currFocusMember))){if(g){d=(g.isDwtTabGroup)?g.getFirstMember():g
}else{d=this.__getPrevMember(f,j);
if(!d){d=this.__getNextMember(f,j)
}}}}if(d&&!e){i.__currFocusMember=d;
this.__showFocusedItem(this.__currFocusMember,"replaceMember");
if(!h){this.__notifyListeners(d)
}}if(g&&g.isDwtTabGroup){g.newParent(this)
}return g?this.__members.replaceObject(f,g):this.__members.remove(f)
};
DwtTabGroup.prototype.contains=function(a){return !!this.__getTabGroupForMember(a)
};
DwtTabGroup.prototype.newParent=function(a){this.__parent=a
};
DwtTabGroup.prototype.getFirstMember=function(a){return this.__getLeftMostMember(a)
};
DwtTabGroup.prototype.getLastMember=function(a){return this.__getRightMostMember(a)
};
DwtTabGroup.prototype.getFocusMember=function(){this.__checkRoot();
return this.__currFocusMember
};
DwtTabGroup.prototype.setFocusMember=function(d,a,c){if(!d){return false
}if(d.isDwtTabGroup){d=d.getFocusMember()||d.getFirstMember()
}this.__checkRoot();
if(!this.__checkEnabled(d,a)){return false
}if(this.contains(d)){this.__currFocusMember=d;
this.__showFocusedItem(this.__currFocusMember,"setFocusMember");
if(!c){this.__notifyListeners(this.__currFocusMember)
}return true
}return false
};
DwtTabGroup.prototype.getNextFocusMember=function(a,c){this.__checkRoot();
return this.__setFocusMember(true,a,c)
};
DwtTabGroup.prototype.getPrevFocusMember=function(a,c){this.__checkRoot();
return this.__setFocusMember(false,a,c)
};
DwtTabGroup.prototype.resetFocusMember=function(c,d){this.__checkRoot();
var a=this.__getLeftMostMember(c);
if((a!=this.__currFocusMember)&&!d){this.__notifyListeners(this.__currFocusMember)
}this.__showFocusedItem(this.__currFocusMember,"resetFocusMember");
this.__currFocusMember=a;
return this.__currFocusMember
};
DwtTabGroup.prototype.dump=function(a){if(a){if(!window.AjxDebug||!window.DBG){return
}var c=function(e){var e=AjxStringUtil.convertToHtml(e)
};
DwtTabGroup.__dump(this,c,0)
}else{if(window.console&&window.console.log){var d=[];
DwtTabGroup.__dump(this,d.push.bind(d),0);
console.log(d.join("\n"))
}}};
DwtTabGroup.prototype.size=function(){return this.__members.size()
};
DwtTabGroup.prototype.__getPrevMember=function(g,d){var c=this.__members.getArray();
for(var e=this.__lastIndexOfMember(g)-1;
e>-1;
e--){var f=c[e];
if(!f.isDwtTabGroup){if(this.__checkEnabled(f,d)){return f
}}else{f=f.__getRightMostMember(d);
if(this.__checkEnabled(f,d)){return f
}}}return this.__parent?this.__parent.__getPrevMember(this,d):null
};
DwtTabGroup.prototype.__checkEnabled=function(e,a){if(!a){return true
}if(!e||e.noTab){return false
}if(e.isDwtControl?!e.getEnabled():e.disabled){return false
}if(e.isDwtControl){e=e.getHtmlElement()
}var d=Dwt.getLocation(e);
if(d.x===null||d.y===null||d.x===Dwt.LOC_NOWHERE||d.y===Dwt.LOC_NOWHERE){return false
}var c=Dwt.getSize(e);
if(!c||c.x===0||c.y===0){return false
}if(e.nodeName&&e.nodeName.toLowerCase()==="body"){return true
}return(Dwt.getZIndex(e,true)>Dwt.Z_HIDDEN&&Dwt.getVisible(e)&&Dwt.getVisibility(e))
};
DwtTabGroup.prototype.__indexOfMember=function(a){return this.__members.indexOf(a)
};
DwtTabGroup.prototype.__lastIndexOfMember=function(a){return this.__members.lastIndexOf(a)
};
DwtTabGroup.prototype.__getNextMember=function(h,d){var c=this.__members.getArray();
var g=this.__members.size();
for(var f=this.__indexOfMember(h)+1;
f<g;
f++){var e=c[f];
if(!e.isDwtTabGroup){if(this.__checkEnabled(e,d)){return e
}}else{e=e.__getLeftMostMember(d);
if(this.__checkEnabled(e,d)){return e
}}}return this.__parent?this.__parent.__getNextMember(this,d):null
};
DwtTabGroup.prototype.__getRightMostMember=function(d){var c=this.__members.getArray();
var f=null;
for(var e=this.__members.size()-1;
e>=0;
e--){f=c[e];
if(!f.isDwtTabGroup){if(this.__checkEnabled(f,d)){break
}}else{f=f.__getRightMostMember(d);
if(this.__checkEnabled(f,d)){break
}}}return this.__checkEnabled(f,d)?f:null
};
DwtTabGroup.prototype.__getLeftMostMember=function(d){var f=this.__members.size();
var c=this.__members.getArray();
var g=null;
for(var e=0;
e<f;
e++){g=c[e];
if(!g.isDwtTabGroup){if(this.__checkEnabled(g,d)){break
}}else{g=g.__getLeftMostMember(d);
if(this.__checkEnabled(g,d)){break
}}}return this.__checkEnabled(g,d)?g:null
};
DwtTabGroup.prototype.__notifyListeners=function(c){var d=this.__getRootTabGroup();
if(d.__evtMgr){var a=DwtTabGroup.__changeEvt;
a.reset();
a.tabGroup=this;
a.newFocusMember=c;
d.__evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,a)
}};
DwtTabGroup.prototype.__getRootTabGroup=function(){var a=this;
while(a.__parent){a=a.__parent
}return a
};
DwtTabGroup.DUMP_INDENT="|\t";
DwtTabGroup.__dump=function(d,l,c){var g=AjxStringUtil.repeat(DwtTabGroup.DUMP_INDENT,c);
l(g+"TABGROUP: "+d.__name);
g+=DwtTabGroup.DUMP_INDENT;
var j=d.__members.size();
var k=d.__members.getArray();
for(var f=0;
f<j;
f++){var e=k[f];
if(e.isDwtTabGroup){DwtTabGroup.__dump(e,l,c+1)
}else{var h=e.nodeName?[e.nodeName,e.id,e.className].join(" "):[String(e),e._htmlElId].join(" ");
if(e.noTab){h+=" - no tab!"
}l(g+h)
}}};
DwtTabGroup.prototype.__setFocusMember=function(f,c,d){if(!this.__currFocusMember){return this.resetFocusMember(c,d)
}var e=this.__getTabGroupForMember(this.__currFocusMember);
if(!e){return null
}var a=f?e.__getNextMember(this.__currFocusMember,c):e.__getPrevMember(this.__currFocusMember,c);
if(!a){a=f?this.__getLeftMostMember(c):this.__getRightMostMember(c);
if(a==this.__currFocusMember){return null
}}this.__currFocusMember=a;
this.__showFocusedItem(this.__currFocusMember,"__setFocusMember");
if(!d){this.__notifyListeners(this.__currFocusMember)
}return this.__currFocusMember
};
DwtTabGroup.prototype.__getTabGroupForMember=function(g){if(!g){return null
}var d=this.__members.getArray(),f=d.length,e,c;
for(e=0;
e<f;
e++){c=d[e];
if(c===g){return this
}else{if(c.isDwtTabGroup&&(c=c.__getTabGroupForMember(g))){return c
}}}return null
};
DwtTabGroup.prototype.__checkRoot=function(){if(this.__parent){}};
DwtTabGroup.prototype.__showFocusedItem=function(f,d){if(f&&window.AjxDebug&&window.DBG){var a=d?"DwtTabGroup."+d+": ":"",h=" ["+(f.isDwtControl?f._htmlElId:f.id)+"] ",c=(f.nodeName||f)+" "+h,g=(f.getTitle&&f.getTitle())||(f.getText&&f.getText())||"",e=c+g
}}
}if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyboardMgr")){DwtKeyboardMgr=function(a){DwtKeyboardMgr.__shell=a;
this.__kbEventStatus=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
this.__keyTimeout=DwtKeyboardMgr.SHORTCUT_TIMEOUT;
this.__tabGrpStack=[];
this.__currTabGroup=null;
this.__tabGroupChangeListenerObj=this.__tabGrpChangeListener.bind(this);
this.__shortcutsEnabled=false;
this.__defaultHandlerStack=[];
this.__currDefaultHandler=null;
this.__killKeySeqTimedAction=new AjxTimedAction(this,this.__killKeySequenceAction);
this.__killKeySeqTimedActionId=-1;
this.__keySequence=[];
this._evtMgr=new AjxEventMgr();
Dwt.setHandler(document,DwtEvent.ONKEYDOWN,DwtKeyboardMgr.__keyDownHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYUP,DwtKeyboardMgr.__keyUpHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYPRESS,DwtKeyboardMgr.__keyPressHdlr)
};
DwtKeyboardMgr.prototype.isDwtKeyboardMgr=true;
DwtKeyboardMgr.prototype.toString=function(){return"DwtKeyboardMgr"
};
DwtKeyboardMgr.SHORTCUT_TIMEOUT=750;
DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED="NOT HANDLED";
DwtKeyboardMgr.__KEYSEQ_HANDLED="HANDLED";
DwtKeyboardMgr.__KEYSEQ_PENDING="PENDING";
DwtKeyboardMgr.IS_INPUT_SHORTCUT_KEY=AjxUtil.arrayAsHash([DwtKeyEvent.KEY_END_OF_TEXT,DwtKeyEvent.KEY_RETURN,DwtKeyEvent.KEY_ARROW_LEFT,DwtKeyEvent.KEY_ARROW_UP,DwtKeyEvent.KEY_ARROW_RIGHT,DwtKeyEvent.KEY_ARROW_DOWN]);
DwtKeyboardMgr.isPossibleInputShortcut=function(a){var c=DwtUiEvent.getTarget(a);
return !DwtKeyMap.IS_MODIFIER[a.keyCode]&&(a.keyCode===DwtKeyEvent.KEY_ESCAPE||DwtKeyMapMgr.hasModifier(a)||(c&&c.nodeName.toLowerCase()=="input"&&DwtKeyboardMgr.IS_INPUT_SHORTCUT_KEY[a.keyCode]))
};
DwtKeyboardMgr.prototype.pushTabGroup=function(c,d){if(!(c&&c.isDwtTabGroup)){return
}this.__tabGrpStack.push(c);
this.__currTabGroup=c;
var a=c.getFocusMember();
if(!a){a=c.resetFocusMember(true)
}if(!a){return
}c.addFocusChangeListener(this.__tabGroupChangeListenerObj);
if(!d){this.grabFocus(a)
}};
DwtKeyboardMgr.prototype.popTabGroup=function(h){if(!(h&&h.isDwtTabGroup)){return null
}if(this.__tabGrpStack.length<=1){return null
}if(h&&this.__tabGrpStack[this.__tabGrpStack.length-1]!=h){var d=this.__tabGrpStack;
var c=d.length;
for(var g=c-1;
g>=0;
g--){if(h==d[g]){d[g].dump(AjxDebug.DBG1);
break
}}if(g<0){return null
}else{if(g!=c-1){d.splice(g,1);
return h
}}}var h=this.__tabGrpStack.pop();
h.removeFocusChangeListener(this.__tabGroupChangeListenerObj);
var f=null;
if(this.__tabGrpStack.length>0){f=this.__tabGrpStack[this.__tabGrpStack.length-1];
var e=f.getFocusMember();
if(!e){e=f.resetFocusMember(true)
}if(e){this.grabFocus(e)
}}this.__currTabGroup=f;
return h
};
DwtKeyboardMgr.prototype.setTabGroup=function(c){var a=this.popTabGroup();
this.pushTabGroup(c);
return a
};
DwtKeyboardMgr.prototype.getCurrentTabGroup=function(){return this.__currTabGroup
};
DwtKeyboardMgr.prototype.pushDefaultHandler=function(a){if(!this.isEnabled()||!a){return
}this.__defaultHandlerStack.push(a);
this.__currDefaultHandler=a
};
DwtKeyboardMgr.prototype.popDefaultHandler=function(){if(this.__defaultHandlerStack.length<=1){return null
}var a=this.__defaultHandlerStack.pop();
this.__currDefaultHandler=this.__defaultHandlerStack[this.__defaultHandlerStack.length-1];
return a
};
DwtKeyboardMgr.prototype.grabFocus=function(a){if(typeof a==="string"){a=document.getElementById(a)
}else{if(a&&a.isDwtTabGroup){a=a.getFocusMember()||a.getFirstMember()
}}if(!a){return
}if(this.__currTabGroup){this.__currTabGroup.setFocusMember(a,false,true)
}this.__doGrabFocus(a)
};
DwtKeyboardMgr.prototype.updateFocus=function(a,d){if(!a){return
}var e=this.__currTabGroup;
if(e){this.__currTabGroup.__showFocusedItem(a,"updateFocus")
}var f=a.isDwtControl?a:DwtControl.findControl(a);
if(f){this.__focusObj=f
}var c=this._findTabGroupMember(d||a);
if(c&&e){e.setFocusMember(c,false,true)
}};
DwtKeyboardMgr.prototype._findTabGroupMember=function(h){var d=this.__currTabGroup;
if(!h||!d){return
}var c=(h.isDwtControl&&h.getHtmlElement())||DwtUiEvent.getTarget(h,false)||h;
try{while(c){if(d.contains(c)){return c
}else{var g=DwtControl.ALL_BY_ID[c.id];
if(g&&d.contains(g)){return g
}else{var a=g&&g.getTabGroupMember&&g.getTabGroupMember();
if(a&&d.contains(a)){return a
}}}c=c.parentNode
}}catch(f){}return null
};
DwtKeyboardMgr.prototype.getFocusObj=function(a){return this.__focusObj
};
DwtKeyboardMgr.prototype.registerDefaultKeyActionHandler=function(a){if(this.isEnabled()){this.__defaultKeyActionHdlr=a
}};
DwtKeyboardMgr.prototype.registerKeyMap=function(a){if(this.isEnabled()){this.__keyMapMgr=new DwtKeyMapMgr(a)
}};
DwtKeyboardMgr.prototype.setKeyTimeout=function(a){this.__keyTimeout=a
};
DwtKeyboardMgr.prototype.clearKeySeq=function(){this.__killKeySeqTimedActionId=-1;
this.__keySequence=[]
};
DwtKeyboardMgr.prototype.enable=function(a){this.__shortcutsEnabled=a
};
DwtKeyboardMgr.prototype.isEnabled=function(){return this.__shortcutsEnabled
};
DwtKeyboardMgr.prototype.addListener=function(a,c){this._evtMgr.addListener(a,c)
};
DwtKeyboardMgr.prototype.removeListener=function(a,c){this._evtMgr.removeListener(a,c)
};
DwtKeyboardMgr.prototype.__doGrabFocus=function(a){if(!a){return
}var c=this.getFocusObj();
if(c&&c.blur){c.blur()
}if(a.focus){this.updateFocus(a.focus()||a)
}};
DwtKeyboardMgr.__keyUpHdlr=function(a){a=DwtUiEvent.getEvent(a);
var c=DwtKeyboardMgr.__shell.getKeyboardMgr();
if(c._evtMgr.notifyListeners(DwtEvent.ONKEYUP,a)===false){return false
}if(AjxEnv.isMac&&AjxEnv.isGeckoBased&&a.keyCode===0){return DwtKeyboardMgr.__keyDownHdlr(a)
}else{return DwtKeyboardMgr.__handleKeyEvent(a)
}};
DwtKeyboardMgr.__keyPressHdlr=function(a){a=DwtUiEvent.getEvent(a);
var c=DwtKeyboardMgr.__shell.getKeyboardMgr();
if(c._evtMgr.notifyListeners(DwtEvent.ONKEYPRESS,a)===false){return false
}DwtKeyEvent.geckoCheck(a);
return DwtKeyboardMgr.__handleKeyEvent(a)
};
DwtKeyboardMgr.__handleKeyEvent=function(a){if(DwtKeyboardMgr.__shell._blockInput){return false
}a=DwtUiEvent.getEvent(a,this);
var d=DwtKeyboardMgr.__shell.getKeyboardMgr();
var c=DwtShell.keyEvent;
c.setFromDhtmlEvent(a);
if(d.__kbEventStatus!=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED){return d.__processKeyEvent(a,c,false)
}};
DwtKeyboardMgr.__keyDownHdlr=function(k){try{k=DwtUiEvent.getEvent(k,this);
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
k.focusObj=null;
if(a._evtMgr.notifyListeners(DwtEvent.ONKEYDOWN,k)===false){return false
}if(DwtKeyboardMgr.__shell._blockInput){return false
}var m=DwtShell.keyEvent;
m.setFromDhtmlEvent(k);
var l=DwtKeyEvent.getCharCode(k);
DwtKeyboardMgr.__shell.getToolTip().popdown();
var j=a.__currTabGroup,f;
if(l==DwtKeyEvent.KEY_TAB){if(j&&!DwtKeyMapMgr.hasModifier(m)){if(j.getFocusMember()){f=m.shiftKey?j.getPrevFocusMember(true):j.getNextFocusMember(true)
}else{f=j.resetFocusMember(true)
}}return a.__processKeyEvent(k,m,!f,f?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}else{if(j&&AjxEnv.isGecko&&m.target instanceof HTMLHtmlElement){f=j.resetFocusMember(true)
}}if(!a.isEnabled()){return true
}if(DwtKeyMap.IS_MODIFIER[l]||(a.__killKeySeqTimedActionId===-1&&m.target&&DwtKeyMapMgr.isInputElement(m.target)&&!m.target["data-hidden"]&&!DwtKeyboardMgr.isPossibleInputShortcut(m))){return a.__processKeyEvent(k,m,true,DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}if(a.__killKeySeqTimedActionId!=-1){AjxTimedAction.cancelAction(a.__killKeySeqTimedActionId);
a.__killKeySeqTimedActionId=-1
}var d=[];
if(m.altKey){d.push(DwtKeyMap.ALT)
}if(m.ctrlKey){d.push(DwtKeyMap.CTRL)
}if(m.metaKey){d.push(DwtKeyMap.META)
}if(m.shiftKey){d.push(DwtKeyMap.SHIFT)
}d.push(l);
a.__keySequence[a.__keySequence.length]=d.join(DwtKeyMap.JOIN);
var h=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
var e=k.focusObj||a.__focusObj;
var c=e&&e.hasFocus&&e.hasFocus();
if(c&&e.handleKeyAction){h=a.__dispatchKeyEvent(e,m);
while((h===DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)&&e.parent){e=e.parent;
if(e.getKeyMapName){h=a.__dispatchKeyEvent(e,m)
}}}if(h===DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED&&a.__currDefaultHandler){h=a.__dispatchKeyEvent(a.__currDefaultHandler,m)
}if(m.forcePropagate){h=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
m.forcePropagate=false
}a.__kbEventStatus=h;
var g=(h==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED);
if(h!=DwtKeyboardMgr.__KEYSEQ_PENDING){a.clearKeySeq()
}return a.__processKeyEvent(k,m,g)
}catch(i){AjxException.reportScriptError(i)
}};
DwtKeyboardMgr.prototype.__dispatchKeyEvent=function(f,g,d){if(f&&f.handleKeyEvent){var h=f.handleKeyEvent(g);
return h?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}var e=(f&&f.getKeyMapName)?f.getKeyMapName():null;
if(!e){return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}var c=this.__keyMapMgr.getActionCode(this.__keySequence,e,d);
if(c===DwtKeyMapMgr.NOT_A_TERMINAL){this.__hdlr=f;
this.__mapName=e;
this.__ev=g;
this.__killKeySeqTimedActionId=AjxTimedAction.scheduleAction(this.__killKeySeqTimedAction,this.__keyTimeout);
return DwtKeyboardMgr.__KEYSEQ_PENDING
}else{if(c!=null){if(!f.handleKeyAction){return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}var a=f.handleKeyAction(c,g);
return a?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}else{return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}}};
DwtKeyboardMgr.prototype.__killKeySequenceAction=function(){this.__dispatchKeyEvent(this.__hdlr,this.__ev,true);
this.clearKeySeq()
};
DwtKeyboardMgr.prototype.__tabGrpChangeListener=function(a){this.__doGrabFocus(a.newFocusMember)
};
DwtKeyboardMgr.prototype.__processKeyEvent=function(d,e,a,c){if(c){this.__kbEventStatus=c
}e._stopPropagation=!a;
e._returnValue=a;
e.setToDhtmlEvent(d);
return a
}
}if(AjxPackage.define("ajax.soap.AjxSoapDoc")){AjxSoapDoc=function(){this._soapURI=AjxSoapDoc._SOAP_URI
};
AjxSoapDoc.prototype.isAjxSoapDoc=true;
AjxSoapDoc.prototype.toString=function(){return"AjxSoapDoc"
};
AjxSoapDoc._SOAP_URI="http://www.w3.org/2003/05/soap-envelope";
AjxSoapDoc._XMLNS_URI="http://www.w3.org/2000/xmlns";
AjxSoapDoc.create=function(a,e,j,i){var h=new AjxSoapDoc();
h._xmlDoc=AjxXmlDoc.create();
var g=h._xmlDoc.getDoc();
if(!i){i=AjxSoapDoc._SOAP_URI
}h._soapURI=i;
var c=g.createElementNS&&!AjxEnv.isSafari;
var f=c?g.createElementNS(i,"soap:Envelope"):g.createElement("soap:Envelope");
if(!c){f.setAttribute("xmlns:soap",i)
}g.appendChild(f);
var k=c?g.createElementNS(i,"soap:Body"):g.createElement("soap:Body");
f.appendChild(k);
h._methodEl=e&&c?g.createElementNS(e,a):g.createElement(a);
if(e!=null&&!c){if(j==null){h._methodEl.setAttribute("xmlns",e)
}else{h._methodEl.setAttribute("xmlns:"+j,e)
}}k.appendChild(h._methodEl);
return h
};
AjxSoapDoc.createFromDom=function(c){var a=new AjxSoapDoc();
a._xmlDoc=AjxXmlDoc.createFromDom(c);
a._methodEl=a._check(a._xmlDoc);
return a
};
AjxSoapDoc.createFromXml=function(a){var c=new AjxSoapDoc();
c._xmlDoc=AjxXmlDoc.createFromXml(a);
c._methodEl=c._check(c._xmlDoc);
return c
};
AjxSoapDoc.element2FaultObj=function(c){var a=c.firstChild;
if(!AjxEnv.isSafari){if(a!=null&&a.namespaceURI!=AjxSoapDoc._SOAP_URI||a.nodeName!=(c.prefix+":Fault")){return null
}}else{if(a!=null&&a.nodeName!=(c.prefix+":Fault")){return null
}}return new AjxSoapFault(a)
};
AjxSoapDoc.prototype.setMethodAttribute=function(a,c){this._methodEl.setAttribute(a,c)
};
AjxSoapDoc.prototype.set=function(c,l,m,f){var k=this.getDoc();
var a=k.createElementNS&&!AjxEnv.isSafari;
var d=c?(f&&a?k.createElementNS(f,c):k.createElement(c)):k.createDocumentFragment();
if((f!==undefined)&&(f!==null)&&!a){d.setAttribute("xmlns",f)
}if(l!=null){if(typeof l=="object"){for(var h in l){var e=l[h];
if(h.charAt(0)=="!"){d.setAttribute(h.substr(1),e)
}else{if(e instanceof Array){for(var g=0;
g<e.length;
++g){this.set(h,e[g],d)
}}else{this.set(h,e,d)
}}}}else{d.appendChild(k.createTextNode(l))
}}if(!m){m=this._methodEl
}return m.appendChild(d)
};
AjxSoapDoc.prototype.getMethod=function(){return this._methodEl
};
AjxSoapDoc.prototype.createHeaderElement=function(){var e=this._xmlDoc.getDoc();
var c=e.firstChild;
var f=this.getHeader();
if(f!=null){throw new AjxSoapException("SOAP header already exists",AjxSoapException.ELEMENT_EXISTS,"AjxSoapDoc.prototype.createHeaderElement")
}var a=e.createElementNS&&!AjxEnv.isSafari;
f=a?e.createElementNS(this._soapURI,"soap:Header"):e.createElement("soap:Header");
c.insertBefore(f,c.firstChild);
return f
};
AjxSoapDoc.prototype.getHeader=function(){var c=this._xmlDoc.getDoc();
var a=!c.getElementsByTagNameNS?(c.getElementsByTagName(c.firstChild.prefix+":Header")):(c.getElementsByTagNameNS(this._soapURI,"Header"));
return a?a[0]:null
};
AjxSoapDoc.prototype.getBody=function(){var c=this._xmlDoc.getDoc();
var a=!c.getElementsByTagNameNS?(c.getElementsByTagName(c.firstChild.prefix+":Body")):(c.getElementsByTagNameNS(this._soapURI,"Body"));
return a?a[0]:null
};
AjxSoapDoc.prototype.getByTagName=function(d){if(d.indexOf(":")==-1){d="soap:"+d
}var c=this.getDoc().getElementsByTagName(d);
if(c.length==1){return c[0]
}else{if(c.length>0){return c
}else{return null
}}};
AjxSoapDoc.prototype.ensureHeader=function(){return(this.getHeader()||this.createHeaderElement())
};
AjxSoapDoc.prototype.getDoc=function(){return this._xmlDoc.getDoc()
};
AjxSoapDoc.prototype.adoptNode=function(c){if(AjxEnv.isFirefox3up||!AjxEnv.isFirefox){try{var d=this.getDoc();
if(d.adoptNode){return d.adoptNode(c,true)
}}catch(a){}}return c.parentNode.removeChild(c)
};
AjxSoapDoc.prototype.getXml=function(){return this._xmlDoc.getXml()
};
AjxSoapDoc.prototype._check=function(c){var d=c.getDoc();
if(d.childNodes.length!=1){throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:1")
}var a=d.firstChild;
if(!AjxEnv.isSafari){if(a.namespaceURI!=AjxSoapDoc._SOAP_URI||a.nodeName!=(a.prefix+":Envelope")||(a.childNodes.length<1||a.childNodes.length>2)){throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}else{if(a.nodeName!=(a.prefix+":Envelope")){throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}}
}if(AjxPackage.define("ajax.soap.AjxSoapException")){AjxSoapException=function(d,c,e,a){AjxException.call(this,d,c,e,a)
};
AjxSoapException.prototype.toString=function(){return"AjxSoapException"
};
AjxSoapException.prototype=new AjxException;
AjxSoapException.prototype.constructor=AjxSoapException;
AjxSoapException.INTERNAL_ERROR="INTERNAL_ERROR";
AjxSoapException.INVALID_PDU="INVALID_PDU";
AjxSoapException.ELEMENT_EXISTS="ELEMENT_EXISTS"
}if(AjxPackage.define("ajax.net.AjxRpc")){AjxRpc=function(){};
AjxRpc.__rpcCache=[];
AjxRpc.__rpcOutstanding={};
AjxRpc.__RPC_CACHE_MAX=50;
AjxRpc.__RPC_ID=0;
AjxRpc.__RPC_IN_USE=0;
AjxRpc.__RPC_HIGH_WATER=0;
AjxRpc.__RPC_REAP_AGE=300000;
AjxRpc.__RPC_REAP_INTERVAL=1800000;
AjxRpc.invoke=function(e,d,h,l,a,k){var c=(l!=null);
var g=AjxRpc.__getFreeRpcCtxt();
try{var f=g.invoke(e,d,h,l,a,k)
}catch(i){var j=new AjxException();
j.method="AjxRpc.prototype._invoke";
if(i instanceof Error){j.detail=i.message;
j.code=AjxException.NETWORK_ERROR;
j.msg="Network error"
}else{if(i.code==101){j.detail=i.message;
j.code=AjxException.NETWORK_ERROR;
j.msg="Network error"
}else{j.detail=i.toString();
j.code=AjxException.UNKNOWN_ERROR;
j.msg="Unknown Error"
}}AjxRpc.freeRpcCtxt(g);
throw j
}if(!c){AjxRpc.freeRpcCtxt(g)
}return f
};
AjxRpc.freeRpcCtxt=function(a){if(AjxRpc.__rpcOutstanding[a.id]){AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" --- freeing rpcCtxt "+a.id);
AjxRpc.__rpcCache.push(a);
delete AjxRpc.__rpcOutstanding[a.id];
AjxRpc.__RPC_IN_USE--
}};
AjxRpc.removeRpcCtxt=function(a){AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" REMOVE rpcCtxt "+a.id);
if(AjxRpc.__rpcOutstanding[a.id]){delete AjxRpc.__rpcOutstanding[a.id];
AjxRpc.__RPC_IN_USE--
}AjxUtil.arrayRemove(AjxRpc.__rpcCache,a)
};
AjxRpc.getRpcRequestById=function(a){return(AjxRpc.__rpcOutstanding[a])
};
AjxRpc.__getFreeRpcCtxt=function(){var a;
if(AjxRpc.__rpcCache.length>0){a=AjxRpc.__rpcCache.pop();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" reusing RPC ID "+a.id)
}else{if(AjxRpc.__RPC_IN_USE<AjxRpc.__RPC_CACHE_MAX){var f="__RpcCtxt_"+AjxRpc.__RPC_ID;
a=new AjxRpcRequest(f);
AjxRpc.__RPC_ID++;
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Created RPC "+f)
}else{a=AjxRpc.__reap();
if(!a){var e=[];
for(var c in AjxRpc.__rpcOutstanding){var a=AjxRpc.__rpcOutstanding[c];
e.push(a.methodName)
}var d=e.join("<br>")+"<br>";
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Out of RPC cache!!! Outstanding requests: "+d);
throw new AjxException("Out of RPC cache",AjxException.OUT_OF_RPC_CACHE,"AjxRpc.__getFreeRpcCtxt",d)
}}}AjxRpc.__rpcOutstanding[a.id]=a;
AjxRpc.__RPC_IN_USE++;
if(AjxRpc.__RPC_IN_USE>AjxRpc.__RPC_HIGH_WATER){AjxRpc.__RPC_HIGH_WATER=AjxRpc.__RPC_IN_USE;
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" High water mark: "+AjxRpc.__RPC_HIGH_WATER)
}a.timestamp=(new Date()).getTime();
return a
};
AjxRpc.__reap=function(d){var a;
var e=(new Date()).getTime();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Running RPC context reaper");
for(var c in AjxRpc.__rpcOutstanding){a=AjxRpc.__rpcOutstanding[c];
if((a.timestamp+AjxRpc.__RPC_REAP_AGE)<e){AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" AjxRpc.__reap: cleared RPC context "+a.id);
a.cancel();
delete AjxRpc.__rpcOutstanding[c];
AjxRpc.__RPC_IN_USE--;
if(!d){return a
}}}return null
};
window.setInterval(AjxRpc.__reap.bind(null,true),AjxRpc.__RPC_REAP_INTERVAL)
}if(AjxPackage.define("ajax.net.AjxRpcRequest")){AjxRpcRequest=function(a){if(!AjxRpcRequest.__inited){AjxRpcRequest.__init()
}this.id=a;
this.__httpReq=AjxRpcRequest.__msxmlVers?(new ActiveXObject(AjxRpcRequest.__msxmlVers)):(new XMLHttpRequest())
};
AjxRpcRequest.prototype.isAjxRpcRequest=true;
AjxRpcRequest.prototype.toString=function(){return"AjxRpcRequest"
};
AjxRpcRequest.TIMEDOUT=-1000;
AjxRpcRequest.HTTP_GET="get";
AjxRpcRequest.HTTP_POST="post";
AjxRpcRequest.HTTP_PUT="put";
AjxRpcRequest.HTTP_DELETE="delete";
AjxRpcRequest.__inited=false;
AjxRpcRequest.__msxmlVers=null;
AjxRpcRequest.prototype.invoke=function(f,e,j,m,a,k){var c=(m!=null);
this.methodName=e||"";
var d=AjxRpcRequest.HTTP_POST;
if(a){d=a===true?AjxRpcRequest.HTTP_GET:a
}if(window.csrfToken&&(d===AjxRpcRequest.HTTP_POST||d===AjxRpcRequest.HTTP_PUT||d===AjxRpcRequest.HTTP_DELETE)){j=j||{};
j["X-Zimbra-Csrf-Token"]=window.csrfToken
}this.__httpReq.open(d,e,c);
if(c){if(k){var g=new AjxTimedAction(this,this.__handleTimeout,[m]);
m._timedActionId=AjxTimedAction.scheduleAction(g,k)
}var l=this;
this.__httpReq.onreadystatechange=function(i){if(window.AjxRpcRequest){AjxRpcRequest.__handleResponse(l,m)
}}
}else{this.__httpReq.onreadystatechange=function(i){}
}if(j){for(var h in j){if(j.hasOwnProperty(h)){this.__httpReq.setRequestHeader(h,j[h])
}}}AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" RPC send: "+this.id);
this.__httpReq.send(f);
if(c){return this.id
}else{if(this.__httpReq.status==200||this.__httpReq.status==201){return{text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:true}
}else{return{text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:false,status:this.__httpReq.status}
}}};
AjxRpcRequest.prototype.cancel=function(){AjxRpc.freeRpcCtxt(this);
if(AjxEnv.isFirefox3_5up){this.__httpReq.onreadystatechange=function(){}
}this.__httpReq.abort()
};
AjxRpcRequest.prototype.__handleTimeout=function(a){this.cancel();
a.run({text:null,xml:null,success:false,status:AjxRpcRequest.TIMEDOUT})
};
AjxRpcRequest.__handleResponse=function(d,e){try{if(!d||!d.__httpReq){d.cancel();
AjxDebug.println(AjxDebug.RPC,AjxDebug._getTimeStamp()+" Async RPC request: Lost request object!!!");
e.run({text:null,xml:null,success:false,status:500});
AjxRpc.freeRpcCtxt(d);
return
}if(d.__httpReq.readyState==4){if(e._timedActionId!==null){AjxTimedAction.cancelAction(e._timedActionId)
}var a=500;
try{a=d.__httpReq.status
}catch(c){}if(a==200||a==201){e.run({text:d.__httpReq.responseText,xml:d.__httpReq.responseXML,success:true,reqId:d.id})
}else{e.run({text:d.__httpReq.responseText,xml:d.__httpReq.responseXML,success:false,status:a,reqId:d.id})
}AjxRpc.freeRpcCtxt(d)
}}catch(c){if(window.AjxException){AjxException.reportScriptError(c)
}}};
AjxRpcRequest.__init=function(){if(!window.XMLHttpRequest&&window.ActiveXObject){var c=["MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];
for(var e=0;
e<c.length;
e++){try{var a=new ActiveXObject(c[e]);
AjxRpcRequest.__msxmlVers=c[e];
break
}catch(d){}}if(!AjxRpcRequest.__msxmlVers){throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxRpc._init")
}}AjxRpcRequest.__inited=true
}
}if(AjxPackage.define("ajax.debug.AjxDebug")){AjxDebug=function(a){if(arguments.length==0){a={}
}else{if(typeof arguments[0]=="number"){a={level:arguments[0],name:arguments[1],showTime:arguments[2]}
}}this._showTime=a.showTime;
this._target=a.target||AjxDebug.TGT_WINDOW;
this._showTiming=false;
this._startTimePt=this._lastTimePt=0;
this._dbgWindowInited=false;
this._msgQueue=[];
this._isPrevWinOpen=false;
this.setDebugLevel(a.level)
};
AjxDebug.prototype.toString=function(){return"AjxDebug"
};
AjxDebug.prototype.isAjxDebug=true;
AjxDebug.NONE=0;
AjxDebug.DBG1=1;
AjxDebug.DBG2=2;
AjxDebug.DBG3=3;
AjxDebug.TGT_WINDOW="window";
AjxDebug.TGT_CONSOLE="console";
AjxDebug.BUFFER={};
AjxDebug.BUFFER_MAX={};
AjxDebug.DEFAULT_TYPE="debug";
AjxDebug.RPC="rpc";
AjxDebug.NOTIFY="notify";
AjxDebug.EXCEPTION="exception";
AjxDebug.CALENDAR="calendar";
AjxDebug.REPLY="reply";
AjxDebug.SCROLL="scroll";
AjxDebug.BAD_JSON="bad_json";
AjxDebug.PREFS="prefs";
AjxDebug.PROGRESS="progress";
AjxDebug.REMINDER="reminder";
AjxDebug.OFFLINE="offline";
AjxDebug.TAG_ICON="tagIcon";
AjxDebug.DATA_URI="dataUri";
AjxDebug.MSG_DISPLAY="msgDisplay";
AjxDebug.ZIMLET="zimlet";
AjxDebug.KEYBOARD="kbnav";
AjxDebug.FOCUS="focus";
AjxDebug.FOCUS1="focus1";
AjxDebug.ACCESSIBILITY="a11y";
AjxDebug.DRAFT="draft";
AjxDebug.BUFFER_MAX[AjxDebug.DEFAULT_TYPE]=0;
AjxDebug.BUFFER_MAX[AjxDebug.RPC]=200;
AjxDebug.BUFFER_MAX[AjxDebug.NOTIFY]=400;
AjxDebug.BUFFER_MAX[AjxDebug.EXCEPTION]=100;
AjxDebug.BUFFER_MAX[AjxDebug.CALENDAR]=400;
AjxDebug.BUFFER_MAX[AjxDebug.REPLY]=400;
AjxDebug.BUFFER_MAX[AjxDebug.SCROLL]=100;
AjxDebug.BUFFER_MAX[AjxDebug.BAD_JSON]=200;
AjxDebug.BUFFER_MAX[AjxDebug.PREFS]=200;
AjxDebug.BUFFER_MAX[AjxDebug.REMINDER]=200;
AjxDebug.BUFFER_MAX[AjxDebug.OFFLINE]=400;
AjxDebug.BUFFER_MAX[AjxDebug.TAG_ICON]=200;
AjxDebug.BUFFER_MAX[AjxDebug.PROGRESS]=200;
AjxDebug.BUFFER_MAX[AjxDebug.DATA_URI]=200;
AjxDebug.BUFFER_MAX[AjxDebug.MSG_DISPLAY]=200;
AjxDebug.BUFFER_MAX[AjxDebug.ZIMLET]=200;
AjxDebug.BUFFER_MAX[AjxDebug.KEYBOARD]=null;
AjxDebug.BUFFER_MAX[AjxDebug.FOCUS]=null;
AjxDebug.BUFFER_MAX[AjxDebug.ACCESSIBILITY]=null;
AjxDebug.BUFFER_MAX[AjxDebug.DRAFT]=200;
AjxDebug.MAX_OUT=25000;
AjxDebug._CONTENT_FRAME_ID="AjxDebug_CF";
AjxDebug._LINK_FRAME_ID="AjxDebug_LF";
AjxDebug._BOTTOM_FRAME_ID="AjxDebug_BFI";
AjxDebug._BOTTOM_FRAME_NAME="AjxDebug_BFN";
AjxDebug.prototype.setTitle=function(a){if(this._document&&!AjxEnv.isIE){this._document.title=a
}};
AjxDebug.prototype.setDebugLevel=function(a){this._level=parseInt(a)||a;
this._enable(this._level!=AjxDebug.NONE)
};
AjxDebug.prototype.getDebugLevel=function(){return this._level
};
AjxDebug.prototype.println=function(g,f,e){if(!this._isWriteable()){return
}try{var a=this._handleArgs(arguments);
if(!a){return
}f=a.args.join("");
var d=(this._target!=AjxDebug.TGT_CONSOLE)?"<br>":"";
this._add({msg:this._timestamp()+f+d,linkName:a.linkName,level:g})
}catch(c){}};
AjxDebug.prototype.isDisabled=function(){return !this._enabled
};
AjxDebug.prototype.dumpObj=function(f,d,c,e){if(!this._isWriteable()){return
}var a=this._handleArgs(arguments);
if(!a){return
}d=a.args[0];
if(!d){return
}c=a.args[1];
this._add({obj:d,linkName:a.linkName,showFuncs:c,level:f})
};
AjxDebug.prototype.printRaw=function(e,d,c){if(!this._isWriteable()){return
}var a=this._handleArgs(arguments);
if(!a){return
}this._add({obj:a.args[0],isRaw:true,linkName:a.linkName,level:e})
};
AjxDebug.prototype.printXML=function(e,d,c){if(!this._isWriteable()){return
}var a=this._handleArgs(arguments);
if(!a){return
}d=a.args[0];
if(!d){return
}if(d.length>AjxDebug.MAX_OUT){this.printRaw(d);
return
}this._add({obj:d,isXml:true,linkName:a.linkName,level:e})
};
AjxDebug.prototype.display=function(e,d,c){if(!this._isWriteable()){return
}var a=this._handleArgs(arguments);
if(!a){return
}d=a.args[0];
d=d.replace(/\r?\n/g,"[crlf]");
d=d.replace(/ /g,"[space]");
d=d.replace(/\t/g,"[tab]");
this.printRaw(e,d,c)
};
AjxDebug.prototype.showTiming=function(c,f){this._showTiming=c;
if(c){this._enable(true)
}var d=c?"on":"off";
var e="Turning timing info "+d;
if(f){e=e+": "+f
}var a=new DebugMessage({msg:e});
this._addMessage(a);
this._startTimePt=this._lastTimePt=new Date().getTime()
};
AjxDebug.prototype.timePt=function(i,d){if(!this._showTiming||!this._isWriteable()){return
}if(d){this._startTimePt=this._lastTimePt=new Date().getTime()
}var f=new Date().getTime();
var a=f-this._startTimePt;
var c=f-this._lastTimePt;
this._lastTimePt=f;
var e=d?"<br/>":"";
i=i?" "+i:"";
var h=[e,"[",a," / ",c,"]",i].join("");
var g="<div>"+h+"</div>";
this._addMessage(new DebugMessage({msg:g}));
return c
};
AjxDebug.prototype.getContentFrame=function(){if(this._contentFrame){return this._contentFrame
}if(this._debugWindow&&this._debugWindow.document){return this._debugWindow.document.getElementById(AjxDebug._CONTENT_FRAME_ID)
}return null
};
AjxDebug.prototype.getLinkFrame=function(a){if(this._linkFrame){return this._linkFrame
}if(this._debugWindow&&this._debugWindow.document){return this._debugWindow.document.getElementById(AjxDebug._LINK_FRAME_ID)
}if(!a){this._openDebugWindow();
return this.getLinkFrame(true)
}return null
};
AjxDebug.prototype._enable=function(a){this._enabled=a;
if(this._target==AjxDebug.TGT_WINDOW){if(a){if(!this._dbgName){this._dbgName="AjxDebugWin_"+location.hostname.replace(/\./g,"_")
}if(this._debugWindow==null||this._debugWindow.closed){this._openDebugWindow()
}}else{if(this._debugWindow){this._debugWindow.close();
this._debugWindow=null
}}}};
AjxDebug.prototype._isWriteable=function(){if(this.isDisabled()){return false
}if(this._target==AjxDebug.TGT_WINDOW){try{return(!this._isPaused&&this._debugWindow&&!this._debugWindow.closed)
}catch(a){return false
}}return true
};
AjxDebug.prototype._getHtmlForObject=function(f,g){g=g||{};
var d=[];
var c=0;
if(f===undefined){d[c++]="<span>Undefined</span>"
}else{if(f===null){d[c++]="<span>NULL</span>"
}else{if(AjxUtil.isBoolean(f)){d[c++]="<span>"+f+"</span>"
}else{if(AjxUtil.isNumber(f)){d[c++]="<span>"+f+"</span>"
}else{if(g.isRaw){d[c++]=this._timestamp();
d[c++]="<textarea rows='25' style='width:100%' readonly='true'>";
d[c++]=f;
d[c++]="</textarea><p></p>"
}else{if(g.isXml){var a=new AjxDebugXmlDocument;
var e=a.create();
if(e&&("loadXML" in e)){e.loadXML(f);
d[c++]="<div style='border-width:2px; border-style:inset; width:100%; height:300px; overflow:auto'>";
d[c++]=this._createXmlTree(e,0,{authToken:true});
d[c++]="</div>"
}else{d[c++]="<span>Unable to create XmlDocument to show XML</span>"
}}else{d[c++]="<div style='border-width:2px; border-style:inset; width:100%; height:300px; overflow:auto'><pre>";
d[c++]=this._dump(f,true,g.showFuncs,{ZmAppCtxt:true,authToken:true});
d[c++]="</div></pre>"
}}}}}}return d.join("")
};
AjxDebug.prototype._dump=function(e,d,a,c){return AjxStringUtil.prettyPrint(e,d,a,c)
};
AjxDebug.prototype._handleArgs=function(f){if(this._level==AjxDebug.NONE||this._showTiming||f.length==0){return
}var a=new Array(f.length);
for(var d=0;
d<f.length;
d++){a[d]=f[d]
}var k={args:null,linkName:null};
var h=a.length;
if(a.length>1){var j=a[a.length-1];
if(j&&j.indexOf&&(j.indexOf("DebugWarn")!=-1||((j.indexOf(" ")==-1)&&(/Request|Response$/.test(j))))){k.linkName=j;
a.pop()
}}var g=null;
var c=a[0];
var e=(typeof c=="number"||((h>1)&&c.length<=8&&/^[a-z0-9]+$/.test(c)));
if(e){g=c;
a.shift()
}if(g&&(AjxDebug.BUFFER_MAX[g]==null)){if(typeof this._level=="number"){if(typeof g!="number"||(g>this._level)){return
}}else{if(g!=this._level){return
}}}k.args=a;
return k
};
AjxDebug.prototype._openDebugWindow=function(e){var c=AjxEnv.isIE?"_blank":this._dbgName;
this._debugWindow=window.open("",c,"width=600,height=400,resizable=yes,scrollbars=yes");
if(this._debugWindow==null){this._enabled=false;
return
}this._enabled=true;
this._isPrevWinOpen=this._debugWindow.debug;
this._debugWindow.debug=true;
try{this._document=this._debugWindow.document;
this.setTitle("Debug");
if(!this._isPrevWinOpen){this._document.write("<html>","<head>","<script>","function blank() {return [","'<html><head><style type=\"text/css\">',","'P, TD, DIV, SPAN, SELECT, INPUT, TEXTAREA, BUTTON {',","'font-family: Tahoma, Arial, Helvetica, sans-serif;',","'font-size:11px;}',","'.Content {display:block;margin:0.25em 0em;}',","'.Link {cursor: pointer;color:blue;text-decoration:underline;white-space:nowrap;width:100%;}',","'.DebugWarn {color:red;font-weight:bold;}',","'.Run {color:black; background-color:red;width:100%;font-size:18px;font-weight:bold;}',","'.RunLink {display:block;color:black;background-color:red;font-weight:bold;white-space:nowrap;width:100%;}',","'</style></head><body></body></html>'].join(\"\");}","<\/script>","</head>","<frameset cols='125, *'>","<frameset rows='*,40'>","<frame name='",AjxDebug._LINK_FRAME_ID,"' id='",AjxDebug._LINK_FRAME_ID,"' src='javascript:parent.parent.blank();'>","<frame name='",AjxDebug._BOTTOM_FRAME_NAME,"' id='",AjxDebug._BOTTOM_FRAME_ID,"' src='javascript:parent.parent.blank();' scrolling=no frameborder=0>","</frameset>","<frame name='",AjxDebug._CONTENT_FRAME_ID,"' id='",AjxDebug._CONTENT_FRAME_ID,"' src='javascript:parent.blank();'>","</frameset>","</html>");
this._document.close();
var a=new AjxTimedAction(this,AjxDebug.prototype._finishInitWindow);
AjxTimedAction.scheduleAction(a,2500)
}else{this._finishInitWindow();
this._contentFrame=this._document.getElementById(AjxDebug._CONTENT_FRAME_ID);
this._linkFrame=this._document.getElementById(AjxDebug._LINK_FRAME_ID);
this._createLinkNContent("RunLink","NEW RUN","Run","NEW RUN");
this._attachHandlers();
this._dbgWindowInited=true;
this._showMessages()
}}catch(d){if(this._debugWindow){this._debugWindow.close()
}this._openDebugWindow(true)
}};
AjxDebug.prototype._finishInitWindow=function(){try{this._contentFrame=this._debugWindow.document.getElementById(AjxDebug._CONTENT_FRAME_ID);
this._linkFrame=this._debugWindow.document.getElementById(AjxDebug._LINK_FRAME_ID);
var f=this._debugWindow.document.getElementById(AjxDebug._BOTTOM_FRAME_ID);
var e=f.contentWindow.document;
var d=[];
var c=0;
d[c++]="<table><tr><td><button id='";
d[c++]=AjxDebug._BOTTOM_FRAME_ID;
d[c++]="_clear'>Clear</button></td><td><button id='";
d[c++]=AjxDebug._BOTTOM_FRAME_ID;
d[c++]="_pause'>Pause</button></td></tr></table>";
if(e.body){e.body.innerHTML=d.join("")
}}catch(a){}if(e){this._clearBtn=e.getElementById(AjxDebug._BOTTOM_FRAME_ID+"_clear");
this._pauseBtn=e.getElementById(AjxDebug._BOTTOM_FRAME_ID+"_pause")
}this._attachHandlers();
this._dbgWindowInited=true;
this._showMessages()
};
AjxDebug.prototype._attachHandlers=function(){var a=AjxCallback.simpleClosure(this._unloadHandler,this);
if(this._debugWindow.attachEvent){this._unloadHandler=a;
this._debugWindow.attachEvent("onunload",a)
}else{this._debugWindow.onunload=a
}if(this._clearBtn){this._clearBtn.onclick=AjxCallback.simpleClosure(this._clear,this)
}if(this._pauseBtn){this._pauseBtn.onclick=AjxCallback.simpleClosure(this._pause,this)
}};
AjxDebug.prototype._scrollToBottom=function(){var c=this.getContentFrame();
var a=c?c.contentWindow.document.body:null;
var e=this.getLinkFrame();
var d=e?e.contentWindow.document.body:null;
if(a&&d){a.scrollTop=a.scrollHeight;
d.scrollTop=d.scrollHeight
}};
AjxDebug.prototype._timestamp=function(){return this._showTime?this._getTimeStamp()+": ":""
};
AjxDebug.prototype.setShowTimestamps=function(a){this._showTime=a
};
AjxDebug.prototype._createXmlTree=function(e,d,a){if(e==null){return""
}var j="";
var h;
switch(e.nodeType){case 1:j+="<div style='color: blue; padding-left: 16px;'>&lt;<span style='color: DarkRed;'>"+e.nodeName+"</span>";
if(a&&a[e.nodeName]){return j+"/&gt;</div>"
}var k=e.attributes;
h=k.length;
for(var f=0;
f<h;
f++){j+=this._createXmlAttribute(k[f])
}if(!e.hasChildNodes()){return j+"/&gt;</div>"
}j+="&gt;<br />";
var g=e.childNodes;
h=g.length;
for(var f=0;
f<h;
f++){j+=this._createXmlTree(g[f],d+3,a)
}j+="&lt;/<span style='color: DarkRed;'>"+e.nodeName+"</span>&gt;</div>";
break;
case 9:var g=e.childNodes;
h=g.length;
for(var f=0;
f<h;
f++){j+=this._createXmlTree(g[f],d,a)
}break;
case 3:if(!/^\s*$/.test(e.nodeValue)){var c=e.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");
j+="<span style='color: WindowText; padding-left: 16px;'>"+c+"</span><br />"
}break;
case 7:j+="&lt;?"+e.nodeName;
var k=e.attributes;
h=k.length;
for(var f=0;
f<h;
f++){j+=this._createXmlAttribute(k[f])
}j+="?&gt;<br />";
break;
case 4:j="<div style=''>&lt;![CDATA[<span style='color: WindowText; font-family: \"Courier New\"; white-space: pre; display: block; border-left: 1px solid Gray; padding-left: 16px;'>"+e.nodeValue+"</span>]]></div>";
break;
case 8:j="<div style='color: blue; padding-left: 16px;'>&lt;!--<span style='white-space: pre; font-family: \"Courier New\"; color: Gray; display: block;'>"+e.nodeValue+"</span>--></div>";
break;
case 10:j="<div style='color: blue; padding-left: 16px'>&lt;!DOCTYPE "+e.name;
if(e.publicId){j+=' PUBLIC "'+e.publicId+'"';
if(e.systemId){j+=' "'+e.systemId+'"'
}}else{if(e.systemId){j+=' SYSTEM "'+e.systemId+'"'
}}j+="&gt;</div>";
break;
default:this._inspect(e)
}return j
};
AjxDebug.prototype._createXmlAttribute=function(c){return[" <span style='color: red'>",c.nodeName,"</span><span style='color: blue'>=\"",c.nodeValue,'"</span>'].join("")
};
AjxDebug.prototype._inspect=function(c){var d="";
for(var a in c){d+="obj."+a+" = "+c[a]+"\n"
}window.alert(d)
};
AjxDebug.prototype._add=function(a){a.extraHtml=a.obj&&this._getHtmlForObject(a.obj,a);
this._addMessage(new DebugMessage(a))
};
AjxDebug.prototype._addMessage=function(a){this._msgQueue.push(a);
this._showMessages()
};
AjxDebug.prototype._showMessages=function(){switch(this._target){case AjxDebug.TGT_WINDOW:this._showMessagesInWindow();
break;
case AjxDebug.TGT_CONSOLE:this._showMessagesInConsole()
}this._addMessagesToBuffer();
this._msgQueue=[]
};
AjxDebug.prototype._showMessagesInWindow=function(){if(!this._dbgWindowInited){return
}try{if(this._msgQueue.length>0){var a=this.getContentFrame();
var e=this.getLinkFrame();
if(!a||!e){return
}var l=a.contentWindow.document;
var h=e.contentWindow.document;
var c=new Date();
for(var f=0,g=this._msgQueue.length;
f<g;
++f){var d=this._msgQueue[f];
var m=d.linkName;
var k=[d.message,d.extraHtml].join("");
this._createLinkNContent("Link",m,"Content",k,c)
}}this._scrollToBottom()
}catch(j){}};
AjxDebug.prototype._addMessagesToBuffer=function(){var d=(this._target==AjxDebug.TGT_CONSOLE)?"<br>":"";
for(var c=0,a=this._msgQueue.length;
c<a;
++c){var e=this._msgQueue[c];
AjxDebug._addMessageToBuffer(e.type,e.message+e.extraHtml+d)
}};
AjxDebug._addMessageToBuffer=function(d,e){d=d||AjxDebug.DEFAULT_TYPE;
var a=AjxDebug.BUFFER_MAX[d];
if(a>0){var c=AjxDebug.BUFFER[d]=AjxDebug.BUFFER[d]||[];
while(c.length>=a){c.shift()
}c.push(e)
}};
AjxDebug.prototype._showMessagesInConsole=function(){if(!window.console){return
}var c=new Date();
for(var d=0,a=this._msgQueue.length;
d<a;
++d){var e=this._msgQueue[d];
if(window.console&&window.console.log){window.console.log(AjxStringUtil.stripTags(e.message+e.extraHtml))
}}};
AjxDebug.prototype._getTimeStamp=function(a){if(!AjxDebug._timestampFormatter){AjxDebug._timestampFormatter=new AjxDateFormat("HH:mm:ss.SSS")
}a=a||new Date();
return AjxStringUtil.htmlEncode(AjxDebug._timestampFormatter.format(a),true)
};
AjxDebug.prototype._createLinkNContent=function(h,n,e,j,d){var f=this.getLinkFrame();
if(!f){return
}d=d||new Date();
var g=["[",this._getTimeStamp(d),"]"].join("");
var c="Lnk_"+d.getTime();
if(n){var i=f.contentWindow.document;
var m=i.createElement("DIV");
m.className=h;
m.innerHTML=[n,g].join(" - ");
m._targetId=c;
m._dbg=this;
m.onclick=AjxDebug._linkClicked;
var l=i.body;
l.appendChild(m)
}var k=this.getContentFrame().contentWindow.document;
var a=k.createElement("DIV");
a.className=e;
a.id=c;
a.innerHTML=j;
k.body.appendChild(a);
this._scrollToBottom()
};
AjxDebug._linkClicked=function(){var c=this._dbg.getContentFrame();
var a=c.contentWindow.document.getElementById(this._targetId);
var d=0;
while(a){d+=a.offsetTop;
a=a.offsetParent
}c.contentWindow.scrollTo(0,d)
};
AjxDebug.prototype._clear=function(){this.getContentFrame().contentWindow.document.body.innerHTML="";
this.getLinkFrame().contentWindow.document.body.innerHTML=""
};
AjxDebug.prototype._pause=function(){this._isPaused=!this._isPaused;
this._pauseBtn.innerHTML=this._isPaused?"Resume":"Pause"
};
AjxDebug.prototype._unloadHandler=function(){if(!this._debugWindow){return
}if(this._debugWindow.detachEvent){this._debugWindow.detachEvent("onunload",this._unloadHandler)
}else{this._debugWindow.onunload=null
}};
AjxDebug.println=function(a,c){AjxDebug._addMessageToBuffer(a,c+"<br>")
};
AjxDebug.dumpObj=function(a,c){AjxDebug._addMessageToBuffer(a,"<pre>"+AjxStringUtil.prettyPrint(c,true)+"</pre>")
};
AjxDebug.logSoapMessage=function(f){if(f.methodNameStr=="NoOpRequest"||f.methodNameStr=="NoOpResponse"){return
}var c=AjxDebug._getTimeStamp();
var e=["<b>",f.methodNameStr,f.asyncMode?"":" (SYNCHRONOUS)"," - ",c,"</b>"].join("");
for(var a in AjxDebug.BUFFER){if(a==AjxDebug.DEFAULT_TYPE){continue
}AjxDebug.println(a,e)
}if(window.DBG){var d=f.methodNameStr;
if(!f.asyncMode){d="<span class='DebugWarn'>SYNCHRONOUS </span>"+d
}window.DBG.println(window.DBG._level,e,d)
}};
AjxDebug._getTimeStamp=function(a){return AjxDebug.prototype._getTimeStamp.apply(null,arguments)
};
AjxDebug.getDebugLog=function(c){c=c||AjxDebug.DEFAULT_TYPE;
var a=AjxDebug.BUFFER[c];
return a?a.join(""):""
};
DebugMessage=function(a){a=a||{};
this.message=a.msg||"";
this.type=a.type||null;
this.category=a.category||"";
this.time=a.time||(new Date().getTime());
this.extraHtml=a.extraHtml||"";
this.linkName=a.linkName;
this.type=(a.level&&typeof(a.level)=="string")?a.level:AjxDebug.DEFAULT_TYPE
}
}if(AjxPackage.define("ajax.xml.AjxXmlDoc")){AjxXmlDoc=function(){if(!AjxXmlDoc._inited){AjxXmlDoc._init()
}};
AjxXmlDoc.prototype.isAjxXmlDoc=true;
AjxXmlDoc.prototype.toString=function(){return"AjxXmlDoc"
};
AjxXmlDoc.INVALID_CHARS_RE=/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/g;
AjxXmlDoc.REC_AVOID_CHARS_RE=/[\u007F-\u0084\u0086-\u009F\uFDD0-\uFDDF]/g;
AjxXmlDoc._inited=false;
AjxXmlDoc._msxmlVers=null;
AjxXmlDoc._useDOM=Boolean(document.implementation&&document.implementation.createDocument);
AjxXmlDoc._useActiveX=!AjxXmlDoc._useDOM&&Boolean(window.ActiveXObject);
AjxXmlDoc.create=function(){var c=new AjxXmlDoc();
var a=null;
if(AjxXmlDoc._useActiveX){a=new ActiveXObject(AjxXmlDoc._msxmlVers);
a.async=true;
if(AjxXmlDoc._msxmlVers=="MSXML2.DOMDocument.4.0"){a.setProperty("SelectionLanguage","XPath");
a.setProperty("SelectionNamespaces","xmlns:zimbra='urn:zimbra' xmlns:mail='urn:zimbraMail' xmlns:account='urn:zimbraAccount'")
}}else{if(AjxXmlDoc._useDOM){a=document.implementation.createDocument("","",null)
}else{throw new AjxException("Unable to create new Doc",AjxException.INTERNAL_ERROR,"AjxXmlDoc.create")
}}c._doc=a;
return c
};
AjxXmlDoc.createFromDom=function(c){var a=new AjxXmlDoc();
a._doc=c;
return a
};
AjxXmlDoc.createFromXml=function(a){var c=AjxXmlDoc.create();
c.loadFromString(a);
return c
};
AjxXmlDoc.replaceInvalidChars=function(a){AjxXmlDoc.INVALID_CHARS_RE.lastIndex=0;
return a.replace(AjxXmlDoc.INVALID_CHARS_RE,"?")
};
AjxXmlDoc.getXml=function(d){if(!d){return""
}var c=d.xml;
if(!c){var a=new XMLSerializer();
c=a.serializeToString(d)
}return AjxXmlDoc.replaceInvalidChars(c)
};
AjxXmlDoc.prototype.getDoc=function(){return this._doc
};
AjxXmlDoc.prototype.loadFromString=function(c){var a=this._doc;
a.loadXML(c);
if(AjxXmlDoc._useActiveX){if(a.parseError.errorCode!=0){throw new AjxException(a.parseError.reason,AjxException.INVALID_PARAM,"AjxXmlDoc.loadFromString")
}}};
AjxXmlDoc.prototype.loadFromUrl=function(a){if(AjxEnv.isChrome||AjxEnv.isSafari){var c=new window.XMLHttpRequest();
c.open("GET",a,false);
c.send(null);
var d=c.responseXML;
this._doc=d
}else{this._doc.load(a)
}};
AjxXmlDoc.prototype.toJSObject=function(d,c,a){_node=function(){this.__msh_content=""
};
_node.prototype.toString=function(){return this.__msh_content
};
rec=function(j,k){var g={},h,l;
for(j=j.firstChild;
j;
j=j.nextSibling){if(j.nodeType==1){h=j.tagName;
if(d){h=h.replace(/^.*?:/,"")
}if(c){h=h.toLowerCase()
}l=new _node();
if(g[h]){if(g[h]==1){k[h]=[k[h]];
g[h]=2
}k[h].push(l)
}else{k[h]=l;
g[h]=1
}if(a){if(j.attributes&&j.attributes.length){for(var f=0;
f<j.attributes.length;
f++){attr=j.attributes[f];
l[attr.name]=AjxUtil.isNumeric(attr.value)?attr.value:String(attr.value)
}}}rec(j,l)
}else{if(j.nodeType==3){k.__msh_content+=j.nodeValue
}}}};
var e=new _node();
rec(this._doc.documentElement,e);
return e
};
AjxXmlDoc.prototype.getElementsByTagNameNS=function(c,a){var d=this.getDoc();
return !d.getElementsByTagNameNS?d.getElementsByTagName(c+":"+a):d.getElementsByTagNameNS(c,a)
};
AjxXmlDoc.prototype.getFirstElementByTagNameNS=function(c,a){return this.getElementsByTagNameNS(c,a)[0]
};
AjxXmlDoc.prototype.getElementsByTagName=function(a){var c=this.getDoc();
return c.getElementsByTagName(a)
};
AjxXmlDoc._init=function(){if(AjxXmlDoc._useActiveX){var a=["MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XmlDom"];
for(var d=0;
d<a.length;
d++){try{new ActiveXObject(a[d]);
AjxXmlDoc._msxmlVers=a[d];
break
}catch(c){}}if(!AjxXmlDoc._msxmlVers){throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxXmlDoc._init")
}}else{if(!Document.prototype.loadXML){Document.prototype.loadXML=function(k){var j=new DOMParser();
var f=j.parseFromString(k,"text/xml");
while(this.hasChildNodes()){this.removeChild(this.lastChild)
}var e=f.childNodes.length;
for(var g=0;
g<e;
g++){var h=this.importNode(f.childNodes[g],true);
this.appendChild(h)
}};
if(AjxEnv.isNav){_NodeGetXml=function(){var e=new XMLSerializer();
return e.serializeToString(this)
};
Node.prototype.__defineGetter__("xml",_NodeGetXml)
}}}AjxXmlDoc._inited=true
};
AjxXmlDoc.prototype.set=function(a,e,c){var f=this._doc.createElement(a);
if(e!=null){var d=this._doc.createTextNode("");
f.appendChild(d);
d.nodeValue=e
}if(c==null){this.root.appendChild(f)
}else{c.appendChild(f)
}return f
};
AjxXmlDoc.prototype.getXml=function(){return AjxXmlDoc.getXml(this.getDoc())
};
AjxXmlDoc.prototype.getDocXml=AjxXmlDoc.prototype.getXml;
AjxXmlDoc.createRoot=function(e){var a=AjxXmlDoc.create();
var c=a.getDoc();
a.root=c.createElement(e);
c.appendChild(a.root);
return a
};
AjxXmlDoc.createElement=function(c,f){var a=AjxXmlDoc.create();
var g=a.getDoc();
a.root=g.createElement(c);
if(f!=null){var e=g.createTextNode("");
a.root.appendChild(e);
e.nodeValue=f
}g.appendChild(a.root);
return a
};
AjxXmlDoc.prototype.appendChild=function(a){if(this._doc!=a._doc&&(AjxEnv.isChrome||AjxEnv.isSafari)){this.root.appendChild(this.getDoc().importNode(a.root,true))
}else{this.root.appendChild(a.root)
}}
}if(AjxPackage.define("zimbra.csfe.ZmCsfeCommand")){ZmCsfeCommand=function(){};
ZmCsfeCommand.prototype.isZmCsfeCommand=true;
ZmCsfeCommand.prototype.toString=function(){return"ZmCsfeCommand"
};
ZmCsfeCommand._COOKIE_NAME="ZM_AUTH_TOKEN";
ZmCsfeCommand.serverUri=null;
ZmCsfeCommand._sessionId=null;
ZmCsfeCommand._staleSession={};
ZmCsfeCommand.REAUTH="reauth";
ZmCsfeCommand.RETRY="retry";
ZmCsfeCommand.getAuthToken=function(){return AjxCookie.getCookie(document,ZmCsfeCommand._COOKIE_NAME)
};
ZmCsfeCommand.setCookieName=function(a){ZmCsfeCommand._COOKIE_NAME=a
};
ZmCsfeCommand.setServerUri=function(a){ZmCsfeCommand.serverUri=a
};
ZmCsfeCommand.setAuthToken=function(c,g,f,d){ZmCsfeCommand._curAuthToken=c;
if(g!=null){var e=null;
if(g>0){e=new Date();
var a=parseInt(g);
e.setTime(e.getTime()+a)
}AjxCookie.setCookie(document,ZmCsfeCommand._COOKIE_NAME,c,e,"/",null,d)
}else{AjxCookie.deleteCookie(document,ZmCsfeCommand._COOKIE_NAME,"/")
}if(f){ZmCsfeCommand.setSessionId(f)
}};
ZmCsfeCommand.clearAuthToken=function(){AjxCookie.deleteCookie(document,ZmCsfeCommand._COOKIE_NAME,"/")
};
ZmCsfeCommand.getSessionId=function(){return ZmCsfeCommand._sessionId
};
ZmCsfeCommand.setSessionId=function(c){var a=ZmCsfeCommand.extractSessionId(c);
if(a){if(a&&!ZmCsfeCommand._staleSession[a]){if(a!=ZmCsfeCommand._sessionId){if(ZmCsfeCommand._sessionId){ZmCsfeCommand._staleSession[ZmCsfeCommand._sessionId]=true
}ZmCsfeCommand._sessionId=a
}}}};
ZmCsfeCommand.clearSessionId=function(){ZmCsfeCommand._sessionId=null
};
ZmCsfeCommand.extractSessionId=function(a){var c;
if(a instanceof Array){a=a[0].id
}else{if(a&&a.id){a=a.id
}}c=parseInt(a,10);
if(isNaN(c)){c=null
}return c
};
ZmCsfeCommand.faultToEx=function(c,d){var e={msg:AjxStringUtil.getAsString(c.Reason.Text),code:AjxStringUtil.getAsString(c.Detail.Error.Code),method:(d?d.methodNameStr:null),detail:AjxStringUtil.getAsString(c.Code.Value),data:c.Detail.Error.a,trace:(c.Detail.Error.Trace||"")};
var a;
if(d){if(d.soapDoc){e.request=d.soapDoc.getXml()
}else{if(d.jsonRequestObj){if(d.jsonRequestObj&&d.jsonRequestObj.Header&&d.jsonRequestObj.Header.context){d.jsonRequestObj.Header.context.authToken="(removed)"
}e.request=AjxStringUtil.prettyPrint(d.jsonRequestObj,true)
}}}return new ZmCsfeException(e)
};
ZmCsfeCommand.getMethodName=function(c){var a=(c&&c._methodEl&&c._methodEl.tagName)?c._methodEl.tagName:null;
if(!a){for(var d in c){if(/Request|Response$/.test(d)){a=d;
break
}}}return(a||"[unknown]")
};
ZmCsfeCommand.prototype.invoke=function(h){this.cancelled=false;
if(!(h&&(h.soapDoc||h.jsonObj))){return
}var a=ZmCsfeCommand.getRequestStr(h);
var g;
try{var f=(h.serverUri||ZmCsfeCommand.serverUri)+h.methodNameStr;
this._st=new Date();
var e={"Content-Type":"application/soap+xml; charset=utf-8"};
if(h.asyncMode){g=new AjxCallback(this,this._runCallback,[h]);
this._rpcId=AjxRpc.invoke(a,f,e,g)
}else{var c=AjxRpc.invoke(a,f,e);
return(!h.returnXml)?(this._getResponseData(c,h)):c
}}catch(d){this._handleException(d,h,g)
}};
ZmCsfeCommand.prototype.invokeRest=function(e){if(!(e&&e.restUri)){return
}var d;
try{this._st=new Date();
if(e.asyncMode){d=new AjxCallback(this,this._runCallback,[e]);
this._rpcId=AjxRpc.invoke(null,e.restUri,null,d,true)
}else{var a=AjxRpc.invoke(null,e.restUri,null,null,true);
return a.text
}}catch(c){this._handleException(c,e,d)
}};
ZmCsfeCommand.prototype.cancel=function(){if(!this._rpcId){return
}this.cancelled=true;
var a=AjxRpc.getRpcRequestById(this._rpcId);
if(a){a.cancel();
if(AjxEnv.isFirefox3_5up){AjxRpc.removeRpcCtxt(a)
}}};
ZmCsfeCommand.getRequestStr=function(a){return a.soapDoc?ZmCsfeCommand._getSoapRequestStr(a):ZmCsfeCommand._getJsonRequestStr(a)
};
ZmCsfeCommand._getJsonRequestStr=function(h){var f={Header:{},Body:h.jsonObj};
var d=f.Header.context={_jsns:"urn:zimbra"};
var e=["ZimbraWebClient - ",AjxEnv.browser," (",AjxEnv.platform,")"].join("");
d.userAgent={name:e};
if(ZmCsfeCommand.clientVersion){d.userAgent.version=ZmCsfeCommand.clientVersion
}if(h.noSession){d.nosession={}
}else{var g=ZmCsfeCommand.getSessionId();
if(g){d.session={_content:g,id:g}
}else{d.session={}
}}if(h.targetServer){d.targetServer={_content:h.targetServer}
}if(h.highestNotifySeen){d.notify={seq:h.highestNotifySeen}
}if(h.changeToken){d.change={token:h.changeToken,type:"new"}
}if(!h.skipAuthCheck){if(h.accountId){d.account={_content:h.accountId,by:"id"}
}else{if(h.accountName){d.account={_content:h.accountName,by:"name"}
}}}if(h.useXml){d.format={type:"xml"}
}h.methodNameStr=ZmCsfeCommand.getMethodName(h.jsonObj);
if(!h.noAuthToken){var c=h.authToken||ZmCsfeCommand.getAuthToken();
if(!c){throw new ZmCsfeException(ZMsg.authTokenRequired,ZmCsfeException.NO_AUTH_TOKEN,h.methodNameStr)
}if(ZmCsfeCommand._curAuthToken&&!h.skipAuthCheck&&(h.resend!=ZmCsfeCommand.REAUTH)&&(c!=ZmCsfeCommand._curAuthToken)){throw new ZmCsfeException(ZMsg.authTokenChanged,ZmCsfeException.AUTH_TOKEN_CHANGED,h.methodNameStr)
}d.authToken=ZmCsfeCommand._curAuthToken=c
}else{if(ZmCsfeCommand.noAuth){throw new ZmCsfeException(ZMsg.authRequired,ZmCsfeException.NO_AUTH_TOKEN,h.methodNameStr)
}}if(window.csrfToken){d.csrfToken=window.csrfToken
}AjxDebug.logSoapMessage(h);
h.jsonRequestObj=f;
var a=(h.useStringify1?JSON.stringify1(f):JSON.stringify(f));
return AjxStringUtil.jsEncode(a)
};
ZmCsfeCommand._getSoapRequestStr=function(h){var m=h.soapDoc;
if(!h.resend){var o=m.createHeaderElement();
var f=m.set("context",null,o,"urn:zimbra");
var c=m.set("userAgent",null,f);
var d=["ZimbraWebClient - ",AjxEnv.browser," (",AjxEnv.platform,")"].join("");
c.setAttribute("name",d);
if(ZmCsfeCommand.clientVersion){c.setAttribute("version",ZmCsfeCommand.clientVersion)
}if(h.noSession){m.set("nosession",null,f)
}else{var i=ZmCsfeCommand.getSessionId();
var j=m.set("session",null,f);
if(i){j.setAttribute("id",i)
}}if(h.targetServer){m.set("targetServer",h.targetServer,f)
}if(h.highestNotifySeen){var p=m.set("notify",null,f);
p.setAttribute("seq",h.highestNotifySeen)
}if(h.changeToken){var l=m.set("change",null,f);
l.setAttribute("token",h.changeToken);
l.setAttribute("type","new")
}if(!h.skipAuthCheck){if(h.accountId){var g=m.set("account",h.accountId,f);
g.setAttribute("by","id")
}else{if(h.accountName){var g=m.set("account",h.accountName,f);
g.setAttribute("by","name")
}}}if(h.skipExpiredToken){var k=m.set("authTokenControl",null,f);
k.setAttribute("voidOnExpired","1")
}if(!h.useXml){var e=m.set("format",null,f);
e.setAttribute("type","js")
}}h.methodNameStr=ZmCsfeCommand.getMethodName(m);
if(!h.noAuthToken){var n=h.authToken||ZmCsfeCommand.getAuthToken();
if(!n){throw new ZmCsfeException(ZMsg.authTokenRequired,ZmCsfeException.NO_AUTH_TOKEN,h.methodNameStr)
}if(ZmCsfeCommand._curAuthToken&&!h.skipAuthCheck&&(h.resend!=ZmCsfeCommand.REAUTH)&&(n!=ZmCsfeCommand._curAuthToken)){throw new ZmCsfeException(ZMsg.authTokenChanged,ZmCsfeException.AUTH_TOKEN_CHANGED,h.methodNameStr)
}ZmCsfeCommand._curAuthToken=n;
if(h.resend==ZmCsfeCommand.REAUTH){var a=m.getDoc().getElementsByTagName("authToken");
if(a&&a.length==1){a[0].firstChild.data=n
}else{a=m.getDoc().getElementsByTagName("context");
if(a&&a.length==1){m.set("authToken",n,a[0])
}else{}}}else{if(!h.resend){m.set("authToken",n,f)
}}}else{if(ZmCsfeCommand.noAuth&&!h.ignoreAuthToken){throw new ZmCsfeException(ZMsg.authRequired,ZmCsfeException.NO_AUTH_TOKEN,h.methodNameStr)
}}if(window.csrfToken){m.set("csrfToken",window.csrfToken,f)
}AjxDebug.logSoapMessage(h);
return m.getXml()
};
ZmCsfeCommand.prototype._runCallback=function(d,a){if(!a){return
}if(this.cancelled&&d.skipCallbackIfCancelled){return
}var c;
if(a instanceof ZmCsfeResult){c=a
}else{c=this._getResponseData(a,d)
}this._en=new Date();
if(d.callback&&c){d.callback.run(c)
}else{if(!d.emptyResponseOkay){}}};
ZmCsfeCommand.prototype._getResponseData=function(e,d){this._en=new Date();
var k=new ZmCsfeResult();
var c=false;
var a=Boolean(d.restUri);
var g=null;
if(!e.success&&!e.xml&&(/<html/i.test(e.text))){var i=new ZmCsfeException(null,ZmCsfeException.CSFE_SVC_ERROR,d.methodNameStr,"HTTP response status "+e.status);
if(d.asyncMode){k.set(i,true);
return k
}else{throw i
}}if(typeof(e.text)=="string"&&e.text.indexOf("{")==0){g=e.text
}else{if(!a){try{c=true;
if(!(e.text||(e.xml&&(typeof e.xml)=="string"))){if(d.emptyResponseOkay){return null
}else{throw new ZmCsfeException(null,ZmCsfeException.EMPTY_RESPONSE,d.methodNameStr)
}}g=(AjxEnv.isIE||e.xml==null)?AjxSoapDoc.createFromXml(e.text):AjxSoapDoc.createFromDom(e.xml)
}catch(i){if(d.asyncMode){k.set(i,true);
return k
}else{throw i
}}if(!g){var i=new ZmCsfeException(null,ZmCsfeException.SOAP_ERROR,d.methodNameStr,"Bad XML response doc");
if(d.asyncMode){k.set(i,true);
return k
}else{throw i
}}}}var f=a?e.text:{};
if(c){f=g._xmlDoc.toJSObject(true,false,true)
}else{if(!a){try{f=JSON.parse(g)
}catch(i){if(i.name=="SyntaxError"){i=new ZmCsfeException(null,ZmCsfeException.BAD_JSON_RESPONSE,d.methodNameStr,g);
AjxDebug.println(AjxDebug.BAD_JSON,"bad json. respDoc="+g)
}if(d.asyncMode){k.set(i,true);
return k
}else{throw i
}}}}d.methodNameStr=ZmCsfeCommand.getMethodName(f.Body);
AjxDebug.logSoapMessage(d);
var h=f&&f.Body&&f.Body.Fault;
if(h){if(AjxUtil.isString(h)&&h.indexOf("<")==0){h=AjxXmlDoc.createFromXml(h).toJSObject(true,false,true)
}var i=ZmCsfeCommand.faultToEx(h,d);
if(d.asyncMode){k.set(i,true,f.Header);
return k
}else{throw i
}}else{if(!e.success){var i=new ZmCsfeException(null,ZmCsfeException.CSFE_SVC_ERROR,d.methodNameStr,"HTTP response status "+e.status);
if(d.asyncMode){k.set(i,true);
return k
}else{throw i
}}else{if(d.asyncMode){k.set(f)
}}}var j=f.Header&&f.Header.context&&f.Header.context.session;
ZmCsfeCommand.setSessionId(j);
return d.asyncMode?k:f
};
ZmCsfeCommand.prototype._handleException=function(a,d,e){if(!(a&&(a instanceof ZmCsfeException||a instanceof AjxSoapException||a instanceof AjxException))){var c=new ZmCsfeException();
c.method=d.methodNameStr||d.restUri;
c.detail=a?a.toString():"undefined exception";
c.code=ZmCsfeException.UNKNOWN_ERROR;
c.msg="Unknown Error";
a=c
}if(d.asyncMode){e.run(new ZmCsfeResult(a,true))
}else{throw a
}}
}if(AjxPackage.define("zimbra.csfe.ZmCsfeException")){ZmCsfeException=function(e){e=Dwt.getParams(arguments,ZmCsfeException.PARAMS);
AjxException.call(this,e.msg,e.code,e.method,e.detail);
if(e.data){this.data={};
for(var c=0;
c<e.data.length;
c++){var d=e.data[c];
var a=d.n;
if(!this.data[a]){this.data[a]=[]
}this.data[a].push(d._content)
}}this.trace=e.trace;
this.request=e.request
};
ZmCsfeException.PARAMS=["msg","code","method","detail","data","trace"];
ZmCsfeException.prototype=new AjxException;
ZmCsfeException.prototype.constructor=ZmCsfeException;
ZmCsfeException.prototype.isZmCsfeException=true;
ZmCsfeException.prototype.toString=function(){return"ZmCsfeException"
};
ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_INVALID="invalid";
ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_UNSENT="unsent";
ZmCsfeException.getErrorMsg=function(c,a){var d=ZMsg[c];
if(!d){ZmCsfeException._unknownFormat=ZmCsfeException._unknownFormat||new AjxMessageFormat(ZMsg.unknownError);
return ZmCsfeException._unknownFormat.format(c)
}this.msg=this.msg||d;
return a?AjxMessageFormat.format(d,a):d
};
ZmCsfeException.prototype.getErrorMsg=function(a){return ZmCsfeException.getErrorMsg(this.code,a)
};
ZmCsfeException.prototype.getData=function(a){return this.data&&this.data[a]
};
ZmCsfeException.AUTH_TOKEN_CHANGED="AUTH_TOKEN_CHANGED";
ZmCsfeException.BAD_JSON_RESPONSE="BAD_JSON_RESPONSE";
ZmCsfeException.CSFE_SVC_ERROR="CSFE_SVC_ERROR";
ZmCsfeException.EMPTY_RESPONSE="EMPTY_RESPONSE";
ZmCsfeException.NETWORK_ERROR="NETWORK_ERROR";
ZmCsfeException.NO_AUTH_TOKEN="NO_AUTH_TOKEN";
ZmCsfeException.SOAP_ERROR="SOAP_ERROR";
ZmCsfeException.LICENSE_ERROR="service.LICENSE_ERROR";
ZmCsfeException.SVC_ALREADY_IN_PROGRESS="service.ALREADY_IN_PROGRESS";
ZmCsfeException.SVC_AUTH_EXPIRED="service.AUTH_EXPIRED";
ZmCsfeException.SVC_AUTH_REQUIRED="service.AUTH_REQUIRED";
ZmCsfeException.SVC_FAILURE="service.FAILURE";
ZmCsfeException.SVC_INVALID_REQUEST="service.INVALID_REQUEST";
ZmCsfeException.SVC_PARSE_ERROR="service.PARSE_ERROR";
ZmCsfeException.SVC_PERM_DENIED="service.PERM_DENIED";
ZmCsfeException.SVC_RESOURCE_UNREACHABLE="service.RESOURCE_UNREACHABLE";
ZmCsfeException.SVC_UNKNOWN_DOCUMENT="service.UNKNOWN_DOCUMENT";
ZmCsfeException.SVC_TEMPORARILY_UNAVAILABLE="service.TEMPORARILY_UNAVAILABLE";
ZmCsfeException.SVC_WRONG_HOST="service.WRONG_HOST";
ZmCsfeException.ACCT_AUTH_FAILED="account.AUTH_FAILED";
ZmCsfeException.ACCT_CHANGE_PASSWORD="account.CHANGE_PASSWORD";
ZmCsfeException.ACCT_EXISTS="account.ACCOUNT_EXISTS";
ZmCsfeException.ACCT_TOO_MANY_ACCOUNTS="account.TOO_MANY_ACCOUNTS";
ZmCsfeException.ACCT_INVALID_ATTR_VALUE="account.INVALID_ATTR_VALUE";
ZmCsfeException.ACCT_INVALID_PASSWORD="account.INVALID_PASSWORD";
ZmCsfeException.ACCT_INVALID_PREF_NAME="account.INVALID_PREF_NAME";
ZmCsfeException.ACCT_INVALID_PREF_VALUE="account.INVALID_PREF_VALUE";
ZmCsfeException.ACCT_MAINTENANCE_MODE="account.MAINTENANCE_MODE";
ZmCsfeException.ACCT_NO_SUCH_ACCOUNT="account.NO_SUCH_ACCOUNT";
ZmCsfeException.ACCT_NO_SUCH_SAVED_SEARCH="account.NO_SUCH_SAVED_SEARCH";
ZmCsfeException.ACCT_NO_SUCH_TAG="account.ACCT_NO_SUCH_TAG";
ZmCsfeException.ACCT_PASS_CHANGE_TOO_SOON="account.PASSWORD_CHANGE_TOO_SOON";
ZmCsfeException.ACCT_PASS_LOCKED="account.PASSWORD_LOCKED";
ZmCsfeException.ACCT_PASS_RECENTLY_USED="account.PASSWORD_RECENTLY_USED";
ZmCsfeException.COS_EXISTS="account.COS_EXISTS";
ZmCsfeException.DISTRIBUTION_LIST_EXISTS="account.DISTRIBUTION_LIST_EXISTS";
ZmCsfeException.DOMAIN_EXISTS="account.DOMAIN_EXISTS";
ZmCsfeException.DOMAIN_NOT_EMPTY="account.DOMAIN_NOT_EMPTY";
ZmCsfeException.IDENTITY_EXISTS="account.IDENTITY_EXISTS";
ZmCsfeException.NO_SUCH_DISTRIBUTION_LIST="account.NO_SUCH_DISTRIBUTION_LIST";
ZmCsfeException.NO_SUCH_DOMAIN="account.NO_SUCH_DOMAIN";
ZmCsfeException.MAINTENANCE_MODE="account.MAINTENANCE_MODE";
ZmCsfeException.TOO_MANY_IDENTITIES="account.TOO_MANY_IDENTITIES";
ZmCsfeException.TOO_MANY_SEARCH_RESULTS="account.TOO_MANY_SEARCH_RESULTS";
ZmCsfeException.NO_SUCH_COS="account.NO_SUCH_COS";
ZmCsfeException.SIGNATURE_EXISTS="account.SIGNATURE_EXISTS";
ZmCsfeException.CANNOT_CHANGE_VOLUME="volume.CANNOT_CHANGE_TYPE_OF_CURRVOL";
ZmCsfeException.CANNOT_DELETE_VOLUME_IN_USE="volume.CANNOT_DELETE_VOLUME_IN_USE";
ZmCsfeException.NO_SUCH_VOLUME="volume.NO_SUCH_VOLUME";
ZmCsfeException.ALREADY_EXISTS="volume.ALREADY_EXISTS";
ZmCsfeException.VOLUME_NO_SUCH_PATH="volume.NO_SUCH_PATH";
ZmCsfeException.MAIL_ALREADY_EXISTS="mail.ALREADY_EXISTS";
ZmCsfeException.MAIL_IMMUTABLE="mail.IMMUTABLE_OBJECT";
ZmCsfeException.MAIL_INVALID_NAME="mail.INVALID_NAME";
ZmCsfeException.MAIL_INVITE_OUT_OF_DATE="mail.INVITE_OUT_OF_DATE";
ZmCsfeException.MAIL_MAINTENANCE_MODE="mail.MAINTENANCE";
ZmCsfeException.MAIL_MESSAGE_TOO_BIG="mail.MESSAGE_TOO_BIG";
ZmCsfeException.MAIL_MUST_RESYNC="mail.MUST_RESYNC";
ZmCsfeException.MAIL_NO_SUCH_CALITEM="mail.NO_SUCH_CALITEM";
ZmCsfeException.MAIL_NO_SUCH_CONV="mail.NO_SUCH_CONV";
ZmCsfeException.MAIL_NO_SUCH_CONTACT="mail.NO_SUCH_CONTACT";
ZmCsfeException.MAIL_NO_SUCH_FOLDER="mail.NO_SUCH_FOLDER";
ZmCsfeException.MAIL_NO_SUCH_ITEM="mail.NO_SUCH_ITEM";
ZmCsfeException.MAIL_NO_SUCH_MOUNTPOINT="mail.NO_SUCH_MOUNTPOINT";
ZmCsfeException.MAIL_NO_SUCH_MSG="mail.NO_SUCH_MSG";
ZmCsfeException.MAIL_NO_SUCH_PART="mail.NO_SUCH_PART";
ZmCsfeException.MAIL_NO_SUCH_TAG="mail.NO_SUCH_TAG";
ZmCsfeException.MAIL_QUERY_PARSE_ERROR="mail.QUERY_PARSE_ERROR";
ZmCsfeException.MAIL_QUOTA_EXCEEDED="mail.QUOTA_EXCEEDED";
ZmCsfeException.MAIL_SEND_ABORTED_ADDRESS_FAILURE="mail.SEND_ABORTED_ADDRESS_FAILURE";
ZmCsfeException.MAIL_SEND_FAILURE="mail.SEND_FAILURE";
ZmCsfeException.MAIL_TOO_MANY_CONTACTS="mail.TOO_MANY_CONTACTS";
ZmCsfeException.MAIL_TOO_MANY_TERMS="mail.TOO_MANY_QUERY_TERMS_EXPANDED";
ZmCsfeException.MAIL_UNABLE_TO_IMPORT_APPOINTMENTS="mail.MAIL_UNABLE_TO_IMPORT_APPOINTMENTS";
ZmCsfeException.MAIL_UNABLE_TO_IMPORT_CONTACTS="mail.UNABLE_TO_IMPORT_CONTACTS";
ZmCsfeException.MODIFY_CONFLICT="mail.MODIFY_CONFLICT";
ZmCsfeException.TOO_MANY_TAGS="mail.TOO_MANY_TAGS";
ZmCsfeException.CANNOT_RENAME="mail.CANNOT_RENAME";
ZmCsfeException.CANNOT_UNLOCK="mail.CANNOT_UNLOCK";
ZmCsfeException.CANNOT_LOCK="mail.CANNOT_LOCK";
ZmCsfeException.LOCKED="mail.LOCKED";
ZmCsfeException.UPLOAD_REJECTED="mail.UPLOAD_REJECTED";
ZmCsfeException.MUST_BE_ORGANIZER="mail.MUST_BE_ORGANIZER";
ZmCsfeException.OFFLINE_ONLINE_ONLY_OP="offline.ONLINE_ONLY_OP"
}if(AjxPackage.define("zimbra.csfe.ZmCsfeResult")){ZmCsfeResult=function(a,c,d){this.set(a,c,d)
};
ZmCsfeResult.prototype.isZmCsfeResult=true;
ZmCsfeResult.prototype.toString=function(){return"ZmCsfeResult"
};
ZmCsfeResult.prototype.set=function(a,c,d){this._data=a;
this._isException=(c===true);
this._header=d
};
ZmCsfeResult.prototype.getResponse=function(){if(this._isException){throw this._data
}else{return this._data
}};
ZmCsfeResult.prototype.getException=function(){return this._isException?this._data:null
};
ZmCsfeResult.prototype.isException=function(){return this._isException
};
ZmCsfeResult.prototype.getHeader=function(){return this._header
}
}if(AjxPackage.define("zimbraMail.share.view.dialog.ZmPasswordRecoveryDialog")){ZmPasswordRecoveryDialog=function(d){this.accountInput=d.accountInput||"";
var j=new DwtDialog_ButtonDescriptor(ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON,ZmMsg.passwordRecoveryButtonSubmit,DwtDialog.ALIGN_RIGHT,this._emailSubmitButtonListener.bind(this));
var g=new DwtDialog_ButtonDescriptor(ZmPasswordRecoveryDialog.REQUEST_CODE_BUTTON,ZmMsg.recoveryEmailButtonRequest,DwtDialog.ALIGN_RIGHT,this._requestCodeButtonListener.bind(this));
var f=new DwtDialog_ButtonDescriptor(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON,ZmMsg.recoveryEmailButtonValidate,DwtDialog.ALIGN_RIGHT,this._verifyCodeButtonListener.bind(this));
var a=new DwtDialog_ButtonDescriptor(ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON,ZmMsg.recoveryEmailButtonResend,DwtDialog.ALIGN_RIGHT,this._resendOptionButtonListener.bind(this));
var k=new DwtDialog_ButtonDescriptor(ZmPasswordRecoveryDialog.RESET_SUBMIT_BUTTON,ZmMsg.passwordRecoveryButtonSubmit,DwtDialog.ALIGN_RIGHT,this._resetSubmitButtonListener.bind(this));
var c=new DwtDialog_ButtonDescriptor(ZmPasswordRecoveryDialog.CANCEL_BUTTON,ZmMsg.passwordRecoveryButtonCancel,DwtDialog.ALIGN_LEFT,this._cancelButtonListener.bind(this));
var e=new DwtDialog_ButtonDescriptor(ZmPasswordRecoveryDialog.LOGIN_BUTTON,ZmMsg.passwordRecoveryButtonCancel,DwtDialog.ALIGN_RIGHT,this._finishButtonListener.bind(this));
var i=typeof appCtxt!=="undefined"?appCtxt.getShell():new DwtShell({});
var h={parent:i,title:ZmMsg.passwordRecoveryTitle,standardButtons:[DwtDialog.NO_BUTTONS],extraButtons:[c,j,g,a,f,k,e]};
DwtDialog.call(this,h);
this.setContent(this._contentHtml());
this._createControls();
this._setAllowSelection();
Dwt.hide(this._titleEl)
};
ZmPasswordRecoveryDialog.prototype=new DwtDialog;
ZmPasswordRecoveryDialog.prototype.constructor=ZmPasswordRecoveryDialog;
ZmPasswordRecoveryDialog.CANCEL_BUTTON=++DwtDialog.LAST_BUTTON;
ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON=++DwtDialog.LAST_BUTTON;
ZmPasswordRecoveryDialog.REQUEST_CODE_BUTTON=++DwtDialog.LAST_BUTTON;
ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON=++DwtDialog.LAST_BUTTON;
ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON=++DwtDialog.LAST_BUTTON;
ZmPasswordRecoveryDialog.RESET_SUBMIT_BUTTON=++DwtDialog.LAST_BUTTON;
ZmPasswordRecoveryDialog.LOGIN_BUTTON=++DwtDialog.LAST_BUTTON;
ZmPasswordRecoveryDialog.prototype.toString=function(){return"ZmPasswordRecoveryDialog"
};
ZmPasswordRecoveryDialog.prototype._contentHtml=function(){var a=this._htmlElId;
this._getRecoveryAccountDivId=a+"_get_recovery_account";
this._requestCodeDivId=a+"_request_code";
this._validateCodeDivId=a+"_validate_code";
this._codeSuccessDivId=a+"_code_success";
this._resetPasswordDivId=a+"_reset_password";
this._resetPasswordDescriptionDivId=a+"_reset_password_description";
this._passwordResetSuccessDivId=a+"_password_reset_success";
this._divIdArray=[this._getRecoveryAccountDivId,this._requestCodeDivId,this._validateCodeDivId,this._codeSuccessDivId,this._resetPasswordDivId,this._passwordResetSuccessDivId];
return AjxTemplate.expand("share.Dialogs#ZmPasswordRecovery",{id:a,accountInput:this.accountInput})
};
ZmPasswordRecoveryDialog.prototype._createRecoveryButtons=function(g,i,c,h,a,f){var d,e=document.getElementById(this._htmlElId+a);
if(e){d=new DwtButton({parent:this,id:g});
d.setText(i);
d.setEnabled(c);
d.setVisible(h);
if(f){d.addSelectionListener(new AjxListener(this,this[f]))
}d.replaceElement(e);
this[g]=d
}};
ZmPasswordRecoveryDialog.prototype._createControls=function(){var e=this._htmlElId;
var a=this.getButton(ZmPasswordRecoveryDialog.CANCEL_BUTTON);
var d=this._accountHandleKeyUp.bind(this);
var c=this._codeHandleKeyUp.bind(this);
this.getButton(ZmPasswordRecoveryDialog.CANCEL_BUTTON).setClassName("ZmPasswordRecoveryButton");
this.getButton(ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON).setClassName("ZmPasswordRecoveryButton");
this.getButton(ZmPasswordRecoveryDialog.REQUEST_CODE_BUTTON).setClassName("ZmPasswordRecoveryButton");
this.getButton(ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON).setClassName("ZmPasswordRecoveryButton");
this.getButton(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON).setClassName("ZmPasswordRecoveryButton");
this.getButton(ZmPasswordRecoveryDialog.RESET_SUBMIT_BUTTON).setClassName("ZmPasswordRecoveryButton");
this.getButton(ZmPasswordRecoveryDialog.LOGIN_BUTTON).setClassName("ZmPasswordRecoveryButton");
a.setClassName("ZmPasswordRecoveryButton");
this._createRecoveryButtons("continueSessionsRecoveryButton",ZmMsg.recoveryEmailButtonContinueSession,true,false,"_CONTINUE_BUTTON","_finishButtonListener");
this._createRecoveryButtons("resetPasswordRecoveryButton",ZmMsg.recoveryEmailButtonResetPassword,true,false,"_RESET_PASSWORD","_resetButtonListener");
this._accountInput=Dwt.getElement(e+"_account_input");
this._accountErrorDiv=Dwt.getElement(e+"_account_input_error");
this._accountErrorMessageDiv=Dwt.getElement(e+"_account_input_error_message");
this._accountErrorDivMsg=Dwt.getElement(e+"_account_input_error_message");
this._requestErrorDiv=Dwt.getElement(e+"_request_code_error");
this._requestErrorMessageDiv=Dwt.getElement(e+"_request_code_error_message");
this._validateCodeDescription=Dwt.getElement(e+"_validate_code_description");
this._validateErrorDiv=Dwt.getElement(e+"_validate_code_error");
this._validateErrorMessageDiv=Dwt.getElement(e+"_validate_code_error_message");
this._resetPasswordErrorDiv=Dwt.getElement(e+"_reset_password_error");
this._resetPasswordErrorMessageDiv=Dwt.getElement(e+"_reset_password_error_message");
this._codeInput=Dwt.getElement(e+"_code_input");
this._passwordNewInput=Dwt.getElement(e+"_password_new_input");
this._passwordConfirmInput=Dwt.getElement(e+"_password_confirm_input");
this._requestCodeDescription=Dwt.getElement(e+"_request_code_description");
Dwt.setHandler(this._accountInput,DwtEvent.ONKEYUP,d);
Dwt.setHandler(this._accountInput,DwtEvent.ONINPUT,d);
Dwt.setHandler(this._codeInput,DwtEvent.ONKEYUP,c);
Dwt.setHandler(this._codeInput,DwtEvent.ONINPUT,c)
};
ZmPasswordRecoveryDialog.prototype._getInputFields=function(){return[this._accountInput,this._codeInput,this._passwordNewInput,this._passwordConfirmInput]
};
ZmPasswordRecoveryDialog.prototype.popup=function(){this.reset();
DwtDialog.prototype.popup.call(this);
this._accountInput.value=this.accountInput;
this._accountInput.focus();
this.setButtonEnabled(ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON,false);
this.setButtonEnabled(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON,false);
if(this._accountInput.value.length>0){this.setButtonEnabled(ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON,true)
}};
ZmPasswordRecoveryDialog.prototype.preventContextMenu=function(){return false
};
ZmPasswordRecoveryDialog.prototype.reset=function(){Dwt.show(this._getRecoveryAccountDivId);
Dwt.hide(this._requestCodeDivId);
Dwt.hide(this._validateCodeErrorDivId);
Dwt.hide(this._validateCodeDivId);
Dwt.hide(this._codeSuccessDivId);
Dwt.hide(this._resetPasswordDivId);
Dwt.hide(this._resetPasswordErrorDivId);
Dwt.hide(this._passwordResetSuccessDivId);
this.setButtonVisible(ZmPasswordRecoveryDialog.CANCEL_BUTTON,true);
this.setButtonVisible(ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON,true);
this.setButtonVisible(ZmPasswordRecoveryDialog.REQUEST_CODE_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.RESET_SUBMIT_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.LOGIN_BUTTON,false);
this._divIdArrayIndex=0;
this._resendCount=0;
DwtDialog.prototype.reset.call(this)
};
ZmPasswordRecoveryDialog.prototype._emailSubmitButtonListener=function(){this._verifyEmail()
};
ZmPasswordRecoveryDialog.prototype._requestCodeButtonListener=function(){this._sendRecoveryCode()
};
ZmPasswordRecoveryDialog.prototype._verifyCodeButtonListener=function(){this._verifyRecoveryCode()
};
ZmPasswordRecoveryDialog.prototype._resendOptionButtonListener=function(){this._resendCount++;
this._sendRecoveryCode()
};
ZmPasswordRecoveryDialog.prototype._resetButtonListener=function(){this._setResetPasswordDialog()
};
ZmPasswordRecoveryDialog.prototype._resetSubmitButtonListener=function(){this._resetPassword()
};
ZmPasswordRecoveryDialog.prototype._finishButtonListener=function(){location.replace(location.origin)
};
ZmPasswordRecoveryDialog.prototype._cancelButtonListener=function(){location.replace(location.origin)
};
ZmPasswordRecoveryDialog.prototype._accountHandleKeyUp=function(c){var e=new RegExp("_account_input");
var a=e.test(c.target.id);
var d=c&&c.target&&c.target.value&&c.target.value.length;
if(a){this.setButtonEnabled(ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON,!!d)
}};
ZmPasswordRecoveryDialog.prototype._codeHandleKeyUp=function(d){var f=new RegExp("_code_input");
var c=f.test(d.target.id);
var e=d&&d.target&&d.target.value&&d.target.value.length;
var a=e&&d.target.value.length>=8;
if(c){this.setButtonEnabled(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON,!!a)
}};
ZmPasswordRecoveryDialog.prototype._verifyEmail=function(){var c=new ZmCsfeCommand(),a=AjxSoapDoc.create("RecoverAccountRequest","urn:zimbraMail"),d=this._verifyEmailCallback.bind(this);
a.setMethodAttribute("op","getRecoveryAccount");
a.setMethodAttribute("email",this._accountInput.value);
a.setMethodAttribute("channel","email");
c.invoke({soapDoc:a,noAuthToken:true,noSession:true,asyncMode:true,callback:d,serverUri:"/service/soap/"})
};
ZmPasswordRecoveryDialog.prototype._verifyEmailCallback=function(a){if(!a||a.isException()){this._handleResetPasswordError(this._accountErrorDiv,this._accountErrorMessageDiv,a.getException())
}else{var c=a.getResponse();
if(!c||!c.Body||!c.Body.RecoverAccountResponse){this._handleResetPasswordError(this._accountErrorDiv,this._accountErrorMessageDiv);
return
}Dwt.setInnerHtml(this._accountErrorDiv,"");
Dwt.hide(this._accountErrorDiv);
recoveryAccountAddress=c.Body.RecoverAccountResponse.recoveryAccount;
recoveryCodeRequestDescription=AjxMessageFormat.format(ZmMsg.passwordRecoveryCodeRequestDescription,[ZmMsg.passwordRecoveryTypeEmail,recoveryAccountAddress]);
Dwt.setInnerHtml(this._requestCodeDescription,recoveryCodeRequestDescription);
Dwt.hide(this._getRecoveryAccountDivId);
Dwt.show(this._requestCodeDivId);
this.setButtonVisible(ZmPasswordRecoveryDialog.EMAIL_SUBMIT_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.REQUEST_CODE_BUTTON,true);
this._divIdArrayIndex=1
}};
ZmPasswordRecoveryDialog.prototype._handleResetPasswordError=function(g,a,f){var i=f?f.code:"unknownError";
var e=f&&f.msg?f.msg.toLowerCase():"Unknown error.";
var h=new RegExp("email");
var d=new RegExp("username");
var c=new RegExp("password");
if(i==="service.INVALID_REQUEST"&&(d.test(e)||h.test(e))){Dwt.setInnerHtml(a,ZmMsg["service.INVALID_REQUEST_USERNAME"])
}else{if(i==="service.INVALID_REQUEST"&&c.test(e)){Dwt.setInnerHtml(a,ZmMsg["service.INVALID_REQUEST_PASSWORD"])
}else{if(i==="service.MAX_ATTEMPTS_REACHED_SUSPEND_FEATURE"){this.setButtonEnabled(ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON,false);
Dwt.setInnerHtml(a,ZmMsg["service.CONTACT_ADMIN"])
}else{if(i==="service.FEATURE_RESET_PASSWORD_SUSPENDED"||i==="service.FEATURE_RESET_PASSWORD_DISABLED"){Dwt.setInnerHtml(a,ZmMsg["service.CONTACT_ADMIN"])
}else{Dwt.setInnerHtml(a,ZmMsg[i])
}}}}Dwt.show(g)
};
ZmPasswordRecoveryDialog.prototype._sendRecoveryCode=function(){var c=new ZmCsfeCommand();
var a=AjxSoapDoc.create("RecoverAccountRequest","urn:zimbraMail");
var d=this._sendRecoveryCodeCallback.bind(this);
Dwt.hide(this._validateErrorDiv);
a.setMethodAttribute("op","sendRecoveryCode");
a.setMethodAttribute("email",this._accountInput.value);
a.setMethodAttribute("channel","email");
c.invoke({soapDoc:a,noAuthToken:true,noSession:true,asyncMode:true,callback:d,serverUri:"/service/soap/"})
};
ZmPasswordRecoveryDialog.prototype._sendRecoveryCodeCallback=function(a){if(!a||a.isException()){this._handleResetPasswordError(this._validateErrorDiv,this._validateErrorMessageDiv,a.getException())
}else{if(this._resendCount>0){Dwt.setInnerHtml(this._validateCodeDescription,ZmMsg.recoveryEmailMessageResend)
}Dwt.hide(this._requestCodeDivId);
Dwt.show(this._validateCodeDivId);
this._codeInput.focus();
this.setButtonVisible(ZmPasswordRecoveryDialog.REQUEST_CODE_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON,true);
this.setButtonVisible(ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON,true)
}};
ZmPasswordRecoveryDialog.prototype._verifyRecoveryCode=function(){var e=new ZmCsfeCommand();
var c=AjxSoapDoc.create("AuthRequest","urn:zimbraAccount");
var f=this._verifyRecoveryCodeCallback.bind(this);
var a,d;
c.setMethodAttribute("csrfTokenSecured",1);
a=c.set("account",this._accountInput.value);
a.setAttribute("by","name");
d=c.set("recoveryCode",this._codeInput.value);
e.invoke({soapDoc:c,noAuthToken:true,noSession:true,asyncMode:true,callback:f,serverUri:"/service/soap/"})
};
ZmPasswordRecoveryDialog.prototype._verifyRecoveryCodeCallback=function(a){if(!a||a.isException()){this._handleResetPasswordError(this._validateErrorDiv,this._validateErrorMessageDiv,a.getException())
}else{var c=a.getResponse();
window.csrfToken=c.Body.AuthResponse.csrfToken._content;
Dwt.hide(this._validateCodeDivId);
Dwt.show(this._codeSuccessDivId);
this.continueSessionsRecoveryButton.setVisible(true);
this.resetPasswordRecoveryButton.setVisible(true);
this.setButtonVisible(ZmPasswordRecoveryDialog.CANCEL_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON,false)
}};
ZmPasswordRecoveryDialog.prototype._setResetPasswordDialog=function(){Dwt.hide(this._codeSuccessDivId);
Dwt.show(this._resetPasswordDivId);
this.continueSessionsRecoveryButton.setVisible(false);
this.resetPasswordRecoveryButton.setVisible(false);
this.getButton(ZmPasswordRecoveryDialog.CANCEL_BUTTON).setText(ZmMsg.recoveryEmailButtonContinueSession);
this.setButtonVisible(ZmPasswordRecoveryDialog.CANCEL_BUTTON,true);
this.setButtonVisible(ZmPasswordRecoveryDialog.VERIFY_CODE_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.RESEND_OPTION_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.RESET_SUBMIT_BUTTON,true)
};
ZmPasswordRecoveryDialog.prototype._resetPassword=function(){var f=new ZmCsfeCommand();
var e=AjxSoapDoc.create("ResetPasswordRequest","urn:zimbraAccount");
var g=this._resetPasswordCallback.bind(this);
var d=this._passwordNewInput.value;
var c=this._passwordConfirmInput.value;
var a={};
if(d!==c){a.code="service.FEATURE_RESET_PASSWORD_MISMATCH";
this._handleResetPasswordError(this._resetPasswordErrorDiv,this._resetPasswordErrorMessageDiv,a);
return
}e.set("password",this._passwordNewInput.value);
f.invoke({soapDoc:e,noAuthToken:true,noSession:true,asyncMode:true,callback:g,serverUri:"/service/soap/"})
};
ZmPasswordRecoveryDialog.prototype._resetPasswordCallback=function(a){if(!a||a.isException()){this._handleResetPasswordError(this._resetPasswordErrorDiv,this._resetPasswordErrorMessageDiv,a.getException())
}else{Dwt.hide(this._resetPasswordDivId);
Dwt.show(this._passwordResetSuccessDivId);
this.setButtonVisible(ZmPasswordRecoveryDialog.CANCEL_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.RESET_SUBMIT_BUTTON,false);
this.setButtonVisible(ZmPasswordRecoveryDialog.LOGIN_BUTTON,true)
}}
}};
